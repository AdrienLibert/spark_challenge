{"Event":"SparkListenerLogStart","Spark Version":"3.5.2"}
{"Event":"SparkListenerResourceProfileAdded","Resource Profile Id":0,"Executor Resource Requests":{"cores":{"Resource Name":"cores","Amount":1,"Discovery Script":"","Vendor":""},"memory":{"Resource Name":"memory","Amount":1024,"Discovery Script":"","Vendor":""},"offHeap":{"Resource Name":"offHeap","Amount":0,"Discovery Script":"","Vendor":""}},"Task Resource Requests":{"cpus":{"Resource Name":"cpus","Amount":1.0}}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1747830507115,"Executor ID":"driver","Executor Info":{"Host":"172.27.136.101","Total Cores":8,"Log Urls":{},"Attributes":{},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"driver","Host":"172.27.136.101","Port":39587},"Maximum Memory":455501414,"Timestamp":1747830507135,"Maximum Onheap Memory":455501414,"Maximum Offheap Memory":0}
{"Event":"SparkListenerEnvironmentUpdate","JVM Information":{"Java Home":"/usr/lib/jvm/java-17-openjdk-amd64","Java Version":"17.0.15 (Ubuntu)","Scala Version":"version 2.12.18"},"Spark Properties":{"spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.driver.host":"172.27.136.101","spark.serializer.objectStreamReset":"100","spark.eventLog.enabled":"true","spark.driver.port":"36709","spark.rdd.compress":"True","spark.app.name":"appMetrics","spark.scheduler.mode":"FIFO","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.app.submitTime":"1747830505830","spark.app.startTime":"1747830506050","spark.executor.id":"driver","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.submit.deployMode":"client","spark.master":"local[*]","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.app.id":"local-1747830507045"},"Hadoop Properties":{"hadoop.service.shutdown.timeout":"30s","yarn.resourcemanager.amlauncher.thread-count":"50","yarn.sharedcache.enabled":"false","fs.s3a.connection.maximum":"96","yarn.nodemanager.numa-awareness.numactl.cmd":"/usr/bin/numactl","fs.viewfs.overload.scheme.target.o3fs.impl":"org.apache.hadoop.fs.ozone.OzoneFileSystem","fs.s3a.impl":"org.apache.hadoop.fs.s3a.S3AFileSystem","yarn.app.mapreduce.am.scheduler.heartbeat.interval-ms":"1000","yarn.timeline-service.timeline-client.number-of-async-entities-to-merge":"10","hadoop.security.kms.client.timeout":"60","hadoop.http.authentication.kerberos.principal":"HTTP/_HOST@LOCALHOST","mapreduce.jobhistory.loadedjob.tasks.max":"-1","yarn.resourcemanager.application-tag-based-placement.enable":"false","mapreduce.framework.name":"local","yarn.sharedcache.uploader.server.thread-count":"50","yarn.nodemanager.log-aggregation.roll-monitoring-interval-seconds.min":"3600","yarn.nodemanager.linux-container-executor.nonsecure-mode.user-pattern":"^[_.A-Za-z0-9][-@_.A-Za-z0-9]{0,255}?[$]?$","tfile.fs.output.buffer.size":"262144","yarn.app.mapreduce.am.job.task.listener.thread-count":"30","yarn.nodemanager.node-attributes.resync-interval-ms":"120000","yarn.nodemanager.container-log-monitor.interval-ms":"60000","hadoop.security.groups.cache.background.reload.threads":"3","yarn.resourcemanager.webapp.cross-origin.enabled":"false","fs.AbstractFileSystem.ftp.impl":"org.apache.hadoop.fs.ftp.FtpFs","fs.viewfs.overload.scheme.target.gs.impl":"com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS","hadoop.registry.secure":"false","hadoop.shell.safely.delete.limit.num.files":"100","mapreduce.job.acl-view-job":" ","fs.s3a.s3guard.ddb.background.sleep":"25ms","fs.s3a.retry.limit":"7","mapreduce.jobhistory.loadedjobs.cache.size":"5","fs.s3a.s3guard.ddb.table.create":"false","fs.viewfs.overload.scheme.target.s3a.impl":"org.apache.hadoop.fs.s3a.S3AFileSystem","yarn.nodemanager.amrmproxy.enabled":"false","yarn.timeline-service.entity-group-fs-store.with-user-dir":"false","mapreduce.shuffle.pathcache.expire-after-access-minutes":"5","mapreduce.input.fileinputformat.split.minsize":"0","yarn.resourcemanager.container.liveness-monitor.interval-ms":"600000","yarn.resourcemanager.client.thread-count":"50","io.seqfile.compress.blocksize":"1000000","yarn.nodemanager.runtime.linux.docker.allowed-container-runtimes":"runc","fs.viewfs.overload.scheme.target.http.impl":"org.apache.hadoop.fs.http.HttpFileSystem","yarn.resourcemanager.nodemanagers.heartbeat-interval-slowdown-factor":"1.0","yarn.sharedcache.checksum.algo.impl":"org.apache.hadoop.yarn.sharedcache.ChecksumSHA256Impl","yarn.nodemanager.amrmproxy.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.nodemanager.amrmproxy.DefaultRequestInterceptor","yarn.timeline-service.entity-group-fs-store.leveldb-cache-read-cache-size":"10485760","mapreduce.reduce.shuffle.fetch.retry.interval-ms":"1000","mapreduce.task.profile.maps":"0-2","yarn.scheduler.include-port-in-node-name":"false","yarn.nodemanager.admin-env":"MALLOC_ARENA_MAX=$MALLOC_ARENA_MAX","yarn.resourcemanager.node-removal-untracked.timeout-ms":"60000","mapreduce.am.max-attempts":"2","hadoop.security.kms.client.failover.sleep.base.millis":"100","mapreduce.jobhistory.webapp.https.address":"0.0.0.0:19890","yarn.node-labels.fs-store.impl.class":"org.apache.hadoop.yarn.nodelabels.FileSystemNodeLabelsStore","yarn.nodemanager.collector-service.address":"${yarn.nodemanager.hostname}:8048","fs.trash.checkpoint.interval":"0","mapreduce.job.map.output.collector.class":"org.apache.hadoop.mapred.MapTask$MapOutputBuffer","yarn.resourcemanager.node-ip-cache.expiry-interval-secs":"-1","hadoop.http.authentication.signature.secret.file":"*********(redacted)","hadoop.jetty.logs.serve.aliases":"true","yarn.resourcemanager.placement-constraints.handler":"disabled","yarn.timeline-service.handler-thread-count":"10","yarn.resourcemanager.max-completed-applications":"1000","yarn.nodemanager.aux-services.manifest.enabled":"false","yarn.resourcemanager.system-metrics-publisher.enabled":"false","yarn.resourcemanager.placement-constraints.algorithm.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.constraint.algorithm.DefaultPlacementAlgorithm","yarn.sharedcache.webapp.address":"0.0.0.0:8788","fs.s3a.select.input.csv.quote.escape.character":"\\\\","yarn.resourcemanager.delegation.token.renew-interval":"*********(redacted)","yarn.sharedcache.nm.uploader.replication.factor":"10","hadoop.security.groups.negative-cache.secs":"30","yarn.app.mapreduce.task.container.log.backups":"0","mapreduce.reduce.skip.proc-count.auto-incr":"true","fs.viewfs.overload.scheme.target.swift.impl":"org.apache.hadoop.fs.swift.snative.SwiftNativeFileSystem","hadoop.security.group.mapping.ldap.posix.attr.gid.name":"gidNumber","ipc.client.fallback-to-simple-auth-allowed":"false","yarn.nodemanager.resource.memory.enforced":"true","yarn.resourcemanager.system-metrics-publisher.timeline-server-v1.enable-batch":"false","yarn.client.failover-proxy-provider":"org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider","yarn.timeline-service.http-authentication.simple.anonymous.allowed":"true","ha.health-monitor.check-interval.ms":"1000","yarn.nodemanager.runtime.linux.runc.host-pid-namespace.allowed":"false","hadoop.metrics.jvm.use-thread-mxbean":"false","ipc.[port_number].faircallqueue.multiplexer.weights":"8,4,2,1","yarn.acl.reservation-enable":"false","yarn.resourcemanager.store.class":"org.apache.hadoop.yarn.server.resourcemanager.recovery.FileSystemRMStateStore","yarn.app.mapreduce.am.hard-kill-timeout-ms":"10000","fs.s3a.etag.checksum.enabled":"false","yarn.nodemanager.container-metrics.enable":"true","ha.health-monitor.rpc.connect.max.retries":"1","yarn.timeline-service.client.fd-clean-interval-secs":"60","yarn.resourcemanager.nodemanagers.heartbeat-interval-scaling-enable":"false","yarn.resourcemanager.nodemanagers.heartbeat-interval-ms":"1000","hadoop.common.configuration.version":"3.0.0","fs.s3a.s3guard.ddb.table.capacity.read":"0","yarn.nodemanager.remote-app-log-dir-suffix":"logs","yarn.nodemanager.container-log-monitor.dir-size-limit-bytes":"1000000000","yarn.nodemanager.windows-container.cpu-limit.enabled":"false","yarn.nodemanager.runtime.linux.docker.privileged-containers.allowed":"false","file.blocksize":"67108864","hadoop.http.idle_timeout.ms":"60000","hadoop.registry.zk.retry.ceiling.ms":"60000","yarn.scheduler.configuration.leveldb-store.path":"${hadoop.tmp.dir}/yarn/system/confstore","yarn.sharedcache.store.in-memory.initial-delay-mins":"10","mapreduce.jobhistory.principal":"jhs/_HOST@REALM.TLD","mapreduce.map.skip.proc-count.auto-incr":"true","fs.s3a.committer.name":"file","mapreduce.task.profile.reduces":"0-2","hadoop.zk.num-retries":"1000","yarn.webapp.xfs-filter.enabled":"true","fs.viewfs.overload.scheme.target.hdfs.impl":"org.apache.hadoop.hdfs.DistributedFileSystem","seq.io.sort.mb":"100","yarn.scheduler.configuration.max.version":"100","yarn.timeline-service.webapp.https.address":"${yarn.timeline-service.hostname}:8190","yarn.resourcemanager.scheduler.address":"${yarn.resourcemanager.hostname}:8030","yarn.node-labels.enabled":"false","yarn.resourcemanager.webapp.ui-actions.enabled":"true","mapreduce.task.timeout":"600000","yarn.sharedcache.client-server.thread-count":"50","hadoop.security.groups.shell.command.timeout":"0s","hadoop.security.crypto.cipher.suite":"AES/CTR/NoPadding","yarn.nodemanager.elastic-memory-control.oom-handler":"org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.resources.DefaultOOMHandler","yarn.resourcemanager.connect.max-wait.ms":"900000","fs.defaultFS":"file:///","yarn.minicluster.use-rpc":"false","ipc.[port_number].decay-scheduler.decay-factor":"0.5","fs.har.impl.disable.cache":"true","yarn.webapp.ui2.enable":"false","io.compression.codec.bzip2.library":"system-native","yarn.webapp.filter-invalid-xml-chars":"false","yarn.nodemanager.runtime.linux.runc.layer-mounts-interval-secs":"600","fs.s3a.select.input.csv.record.delimiter":"\\n","fs.s3a.change.detection.source":"etag","ipc.[port_number].backoff.enable":"false","yarn.nodemanager.distributed-scheduling.enabled":"false","mapreduce.shuffle.connection-keep-alive.timeout":"5","yarn.resourcemanager.webapp.https.address":"${yarn.resourcemanager.hostname}:8090","yarn.webapp.enable-rest-app-submissions":"true","mapreduce.jobhistory.address":"0.0.0.0:10020","yarn.resourcemanager.nm-tokens.master-key-rolling-interval-secs":"*********(redacted)","yarn.is.minicluster":"false","yarn.nodemanager.address":"${yarn.nodemanager.hostname}:0","fs.abfss.impl":"org.apache.hadoop.fs.azurebfs.SecureAzureBlobFileSystem","fs.AbstractFileSystem.s3a.impl":"org.apache.hadoop.fs.s3a.S3A","mapreduce.task.combine.progress.records":"10000","yarn.resourcemanager.epoch.range":"0","yarn.resourcemanager.am.max-attempts":"2","yarn.nodemanager.runtime.linux.runc.image-toplevel-dir":"/runc-root","yarn.nodemanager.linux-container-executor.cgroups.hierarchy":"/hadoop-yarn","fs.AbstractFileSystem.wasbs.impl":"org.apache.hadoop.fs.azure.Wasbs","yarn.timeline-service.entity-group-fs-store.cache-store-class":"org.apache.hadoop.yarn.server.timeline.MemoryTimelineStore","yarn.nodemanager.runtime.linux.runc.allowed-container-networks":"host,none,bridge","fs.ftp.transfer.mode":"BLOCK_TRANSFER_MODE","ipc.server.log.slow.rpc":"false","ipc.server.reuseaddr":"true","fs.ftp.timeout":"0","yarn.resourcemanager.node-labels.provider.fetch-interval-ms":"1800000","yarn.router.webapp.https.address":"0.0.0.0:8091","yarn.nodemanager.webapp.cross-origin.enabled":"false","fs.wasb.impl":"org.apache.hadoop.fs.azure.NativeAzureFileSystem","yarn.resourcemanager.auto-update.containers":"false","yarn.app.mapreduce.am.job.committer.cancel-timeout":"60000","yarn.scheduler.configuration.zk-store.parent-path":"/confstore","yarn.nodemanager.default-container-executor.log-dirs.permissions":"710","yarn.app.attempt.diagnostics.limit.kc":"64","fs.viewfs.overload.scheme.target.swebhdfs.impl":"org.apache.hadoop.hdfs.web.SWebHdfsFileSystem","yarn.client.failover-no-ha-proxy-provider":"org.apache.hadoop.yarn.client.DefaultNoHARMFailoverProxyProvider","fs.s3a.change.detection.mode":"server","ftp.bytes-per-checksum":"512","yarn.nodemanager.resource.memory-mb":"-1","fs.AbstractFileSystem.abfs.impl":"org.apache.hadoop.fs.azurebfs.Abfs","yarn.timeline-service.writer.flush-interval-seconds":"60","fs.s3a.fast.upload.active.blocks":"4","yarn.resourcemanager.submission-preprocessor.enabled":"false","hadoop.security.credential.clear-text-fallback":"true","yarn.nodemanager.collector-service.thread-count":"5","ipc.[port_number].scheduler.impl":"org.apache.hadoop.ipc.DefaultRpcScheduler","fs.azure.secure.mode":"false","mapreduce.jobhistory.joblist.cache.size":"20000","fs.ftp.host":"0.0.0.0","yarn.timeline-service.writer.async.queue.capacity":"100","yarn.resourcemanager.fs.state-store.num-retries":"0","yarn.resourcemanager.nodemanager-connect-retries":"10","yarn.nodemanager.log-aggregation.num-log-files-per-app":"30","hadoop.security.kms.client.encrypted.key.cache.low-watermark":"0.3f","fs.s3a.committer.magic.enabled":"true","yarn.timeline-service.client.max-retries":"30","dfs.ha.fencing.ssh.connect-timeout":"30000","yarn.log-aggregation-enable":"false","yarn.system-metrics-publisher.enabled":"false","mapreduce.reduce.markreset.buffer.percent":"0.0","fs.AbstractFileSystem.viewfs.impl":"org.apache.hadoop.fs.viewfs.ViewFs","yarn.resourcemanager.nodemanagers.heartbeat-interval-speedup-factor":"1.0","mapreduce.task.io.sort.factor":"10","yarn.nodemanager.amrmproxy.client.thread-count":"25","ha.failover-controller.new-active.rpc-timeout.ms":"60000","yarn.nodemanager.container-localizer.java.opts":"-Xmx256m","mapreduce.jobhistory.datestring.cache.size":"200000","mapreduce.job.acl-modify-job":" ","yarn.nodemanager.windows-container.memory-limit.enabled":"false","yarn.timeline-service.webapp.address":"${yarn.timeline-service.hostname}:8188","yarn.app.mapreduce.am.job.committer.commit-window":"10000","yarn.nodemanager.container-manager.thread-count":"20","yarn.minicluster.fixed.ports":"false","hadoop.tags.system":"YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL","yarn.cluster.max-application-priority":"0","yarn.timeline-service.ttl-enable":"true","mapreduce.jobhistory.recovery.store.fs.uri":"${hadoop.tmp.dir}/mapred/history/recoverystore","hadoop.caller.context.signature.max.size":"40","ipc.[port_number].decay-scheduler.backoff.responsetime.enable":"false","yarn.client.load.resource-types.from-server":"false","ha.zookeeper.session-timeout.ms":"10000","ipc.[port_number].decay-scheduler.metrics.top.user.count":"10","tfile.io.chunk.size":"1048576","fs.s3a.s3guard.ddb.table.capacity.write":"0","yarn.dispatcher.print-events-info.threshold":"5000","mapreduce.job.speculative.slowtaskthreshold":"1.0","io.serializations":"org.apache.hadoop.io.serializer.WritableSerialization, org.apache.hadoop.io.serializer.avro.AvroSpecificSerialization, org.apache.hadoop.io.serializer.avro.AvroReflectSerialization","hadoop.security.kms.client.failover.sleep.max.millis":"2000","hadoop.security.group.mapping.ldap.directory.search.timeout":"10000","yarn.scheduler.configuration.store.max-logs":"1000","yarn.nodemanager.node-attributes.provider.fetch-interval-ms":"600000","fs.swift.impl":"org.apache.hadoop.fs.swift.snative.SwiftNativeFileSystem","yarn.nodemanager.local-cache.max-files-per-directory":"8192","hadoop.http.cross-origin.enabled":"false","hadoop.zk.acl":"world:anyone:rwcda","yarn.nodemanager.runtime.linux.runc.image-tag-to-manifest-plugin.num-manifests-to-cache":"10","mapreduce.map.sort.spill.percent":"0.80","yarn.timeline-service.entity-group-fs-store.scan-interval-seconds":"60","yarn.node-attribute.fs-store.impl.class":"org.apache.hadoop.yarn.server.resourcemanager.nodelabels.FileSystemNodeAttributeStore","fs.s3a.retry.interval":"500ms","yarn.timeline-service.client.best-effort":"false","yarn.resourcemanager.webapp.delegation-token-auth-filter.enabled":"*********(redacted)","hadoop.security.group.mapping.ldap.posix.attr.uid.name":"uidNumber","fs.AbstractFileSystem.swebhdfs.impl":"org.apache.hadoop.fs.SWebHdfs","yarn.nodemanager.elastic-memory-control.timeout-sec":"5","fs.s3a.select.enabled":"true","mapreduce.ifile.readahead":"true","yarn.timeline-service.leveldb-timeline-store.ttl-interval-ms":"300000","yarn.timeline-service.reader.webapp.address":"${yarn.timeline-service.webapp.address}","yarn.resourcemanager.placement-constraints.algorithm.pool-size":"1","yarn.timeline-service.hbase.coprocessor.jar.hdfs.location":"/hbase/coprocessor/hadoop-yarn-server-timelineservice.jar","hadoop.security.kms.client.encrypted.key.cache.num.refill.threads":"2","yarn.resourcemanager.scheduler.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler","yarn.app.mapreduce.am.command-opts":"-Xmx1024m","fs.s3a.metadatastore.fail.on.write.error":"true","hadoop.http.sni.host.check.enabled":"false","mapreduce.cluster.local.dir":"${hadoop.tmp.dir}/mapred/local","io.mapfile.bloom.error.rate":"0.005","fs.client.resolve.topology.enabled":"false","yarn.nodemanager.runtime.linux.allowed-runtimes":"default","yarn.sharedcache.store.class":"org.apache.hadoop.yarn.server.sharedcachemanager.store.InMemorySCMStore","ha.failover-controller.graceful-fence.rpc-timeout.ms":"5000","ftp.replication":"3","fs.getspaceused.jitterMillis":"60000","hadoop.security.uid.cache.secs":"14400","mapreduce.job.maxtaskfailures.per.tracker":"3","fs.s3a.metadatastore.impl":"org.apache.hadoop.fs.s3a.s3guard.NullMetadataStore","io.skip.checksum.errors":"false","yarn.app.mapreduce.client-am.ipc.max-retries-on-timeouts":"3","yarn.timeline-service.webapp.xfs-filter.xframe-options":"SAMEORIGIN","fs.s3a.connection.timeout":"200000","yarn.app.mapreduce.am.webapp.https.enabled":"false","mapreduce.job.max.split.locations":"15","yarn.resourcemanager.nm-container-queuing.max-queue-length":"15","yarn.resourcemanager.delegation-token.always-cancel":"*********(redacted)","hadoop.registry.zk.session.timeout.ms":"60000","yarn.federation.cache-ttl.secs":"300","mapreduce.jvm.system-properties-to-log":"os.name,os.version,java.home,java.runtime.version,java.vendor,java.version,java.vm.name,java.class.path,java.io.tmpdir,user.dir,user.name","yarn.resourcemanager.opportunistic-container-allocation.nodes-used":"10","yarn.timeline-service.entity-group-fs-store.active-dir":"/tmp/entity-file-history/active","mapreduce.shuffle.transfer.buffer.size":"131072","yarn.timeline-service.client.retry-interval-ms":"1000","yarn.timeline-service.flowname.max-size":"0","yarn.http.policy":"HTTP_ONLY","fs.s3a.socket.send.buffer":"8192","fs.AbstractFileSystem.abfss.impl":"org.apache.hadoop.fs.azurebfs.Abfss","yarn.sharedcache.uploader.server.address":"0.0.0.0:8046","yarn.resourcemanager.delegation-token.max-conf-size-bytes":"*********(redacted)","hadoop.http.authentication.token.validity":"*********(redacted)","mapreduce.shuffle.max.connections":"0","yarn.minicluster.yarn.nodemanager.resource.memory-mb":"4096","mapreduce.job.emit-timeline-data":"false","yarn.nodemanager.resource.system-reserved-memory-mb":"-1","hadoop.kerberos.min.seconds.before.relogin":"60","mapreduce.jobhistory.move.thread-count":"3","yarn.resourcemanager.admin.client.thread-count":"1","yarn.dispatcher.drain-events.timeout":"300000","ipc.[port_number].decay-scheduler.backoff.responsetime.thresholds":"10s,20s,30s,40s","fs.s3a.buffer.dir":"${hadoop.tmp.dir}/s3a","hadoop.ssl.enabled.protocols":"TLSv1.2","mapreduce.jobhistory.admin.address":"0.0.0.0:10033","yarn.log-aggregation-status.time-out.ms":"600000","fs.s3a.accesspoint.required":"false","mapreduce.shuffle.port":"13562","yarn.resourcemanager.max-log-aggregation-diagnostics-in-memory":"10","yarn.nodemanager.health-checker.interval-ms":"600000","yarn.resourcemanager.proxy.connection.timeout":"60000","yarn.router.clientrm.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.clientrm.DefaultClientRequestInterceptor","yarn.resourcemanager.zk-appid-node.split-index":"0","ftp.blocksize":"67108864","yarn.nodemanager.runtime.linux.sandbox-mode.local-dirs.permissions":"read","yarn.router.rmadmin.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.rmadmin.DefaultRMAdminRequestInterceptor","yarn.nodemanager.log-container-debug-info.enabled":"true","yarn.resourcemanager.activities-manager.app-activities.max-queue-length":"100","yarn.resourcemanager.application-https.policy":"NONE","yarn.client.max-cached-nodemanagers-proxies":"0","yarn.nodemanager.linux-container-executor.cgroups.delete-delay-ms":"20","yarn.nodemanager.delete.debug-delay-sec":"0","yarn.nodemanager.pmem-check-enabled":"true","yarn.nodemanager.disk-health-checker.max-disk-utilization-per-disk-percentage":"90.0","mapreduce.app-submission.cross-platform":"false","yarn.resourcemanager.work-preserving-recovery.scheduling-wait-ms":"10000","yarn.nodemanager.container-retry-minimum-interval-ms":"1000","hadoop.security.groups.cache.secs":"300","yarn.federation.enabled":"false","yarn.workflow-id.tag-prefix":"workflowid:","fs.azure.local.sas.key.mode":"false","ipc.maximum.data.length":"134217728","fs.s3a.endpoint":"s3.amazonaws.com","mapreduce.shuffle.max.threads":"0","yarn.router.pipeline.cache-max-size":"25","yarn.resourcemanager.nm-container-queuing.load-comparator":"QUEUE_LENGTH","yarn.resourcemanager.resource-tracker.nm.ip-hostname-check":"false","hadoop.security.authorization":"false","mapreduce.job.complete.cancel.delegation.tokens":"*********(redacted)","fs.s3a.paging.maximum":"5000","nfs.exports.allowed.hosts":"* rw","yarn.nodemanager.amrmproxy.ha.enable":"false","fs.AbstractFileSystem.gs.impl":"com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS","mapreduce.jobhistory.http.policy":"HTTP_ONLY","yarn.sharedcache.store.in-memory.check-period-mins":"720","hadoop.security.group.mapping.ldap.ssl":"false","fs.s3a.downgrade.syncable.exceptions":"true","yarn.client.application-client-protocol.poll-interval-ms":"200","yarn.scheduler.configuration.leveldb-store.compaction-interval-secs":"86400","yarn.timeline-service.writer.class":"org.apache.hadoop.yarn.server.timelineservice.storage.HBaseTimelineWriterImpl","ha.zookeeper.parent-znode":"/hadoop-ha","yarn.resourcemanager.submission-preprocessor.file-refresh-interval-ms":"60000","yarn.nodemanager.log-aggregation.policy.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.logaggregation.AllContainerLogAggregationPolicy","mapreduce.reduce.shuffle.merge.percent":"0.66","hadoop.security.group.mapping.ldap.search.filter.group":"(objectClass=group)","yarn.resourcemanager.placement-constraints.scheduler.pool-size":"1","yarn.resourcemanager.activities-manager.cleanup-interval-ms":"5000","yarn.nodemanager.resourcemanager.minimum.version":"NONE","mapreduce.job.speculative.speculative-cap-running-tasks":"0.1","yarn.admin.acl":"*","ipc.[port_number].identity-provider.impl":"org.apache.hadoop.ipc.UserIdentityProvider","yarn.nodemanager.recovery.supervised":"false","yarn.sharedcache.admin.thread-count":"1","yarn.resourcemanager.ha.automatic-failover.enabled":"true","yarn.nodemanager.container-log-monitor.total-size-limit-bytes":"10000000000","mapreduce.reduce.skip.maxgroups":"0","mapreduce.reduce.shuffle.connect.timeout":"180000","yarn.nodemanager.health-checker.scripts":"script","yarn.resourcemanager.address":"${yarn.resourcemanager.hostname}:8032","ipc.client.ping":"true","mapreduce.task.local-fs.write-limit.bytes":"-1","fs.adl.oauth2.access.token.provider.type":"*********(redacted)","mapreduce.shuffle.ssl.file.buffer.size":"65536","yarn.resourcemanager.ha.automatic-failover.embedded":"true","yarn.nodemanager.resource-plugins.gpu.docker-plugin":"nvidia-docker-v1","fs.s3a.s3guard.consistency.retry.interval":"2s","fs.s3a.multipart.purge":"false","yarn.scheduler.configuration.store.class":"file","yarn.resourcemanager.nm-container-queuing.queue-limit-stdev":"1.0f","mapreduce.job.end-notification.max.attempts":"5","mapreduce.output.fileoutputformat.compress.codec":"org.apache.hadoop.io.compress.DefaultCodec","yarn.nodemanager.container-monitor.procfs-tree.smaps-based-rss.enabled":"false","ipc.client.bind.wildcard.addr":"false","yarn.resourcemanager.webapp.rest-csrf.enabled":"false","ha.health-monitor.connect-retry-interval.ms":"1000","yarn.nodemanager.keytab":"/etc/krb5.keytab","mapreduce.jobhistory.keytab":"/etc/security/keytab/jhs.service.keytab","fs.s3a.threads.max":"64","yarn.nodemanager.runtime.linux.docker.image-update":"false","mapreduce.reduce.shuffle.input.buffer.percent":"0.70","fs.viewfs.overload.scheme.target.abfss.impl":"org.apache.hadoop.fs.azurebfs.SecureAzureBlobFileSystem","yarn.dispatcher.cpu-monitor.samples-per-min":"60","hadoop.security.token.service.use_ip":"*********(redacted)","yarn.nodemanager.runtime.linux.docker.allowed-container-networks":"host,none,bridge","yarn.nodemanager.node-labels.resync-interval-ms":"120000","hadoop.tmp.dir":"/tmp/hadoop-${user.name}","mapreduce.job.maps":"2","mapreduce.jobhistory.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.job.end-notification.max.retry.interval":"5000","yarn.log-aggregation.retain-check-interval-seconds":"-1","yarn.resourcemanager.resource-tracker.client.thread-count":"50","yarn.nodemanager.containers-launcher.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainersLauncher","yarn.rm.system-metrics-publisher.emit-container-events":"false","yarn.timeline-service.leveldb-timeline-store.start-time-read-cache-size":"10000","yarn.resourcemanager.ha.automatic-failover.zk-base-path":"/yarn-leader-election","io.seqfile.local.dir":"${hadoop.tmp.dir}/io/local","fs.s3a.s3guard.ddb.throttle.retry.interval":"100ms","fs.AbstractFileSystem.wasb.impl":"org.apache.hadoop.fs.azure.Wasb","mapreduce.client.submit.file.replication":"10","mapreduce.jobhistory.minicluster.fixed.ports":"false","fs.s3a.multipart.threshold":"128M","yarn.resourcemanager.webapp.xfs-filter.xframe-options":"SAMEORIGIN","mapreduce.jobhistory.done-dir":"${yarn.app.mapreduce.am.staging-dir}/history/done","ipc.server.purge.interval":"15","ipc.client.idlethreshold":"4000","yarn.nodemanager.linux-container-executor.cgroups.strict-resource-usage":"false","mapreduce.reduce.input.buffer.percent":"0.0","yarn.nodemanager.runtime.linux.docker.userremapping-gid-threshold":"1","yarn.nodemanager.webapp.rest-csrf.enabled":"false","fs.ftp.host.port":"21","ipc.ping.interval":"60000","yarn.resourcemanager.history-writer.multi-threaded-dispatcher.pool-size":"10","yarn.resourcemanager.admin.address":"${yarn.resourcemanager.hostname}:8033","file.client-write-packet-size":"65536","ipc.client.kill.max":"10","mapreduce.reduce.speculative":"true","hadoop.security.key.default.bitlength":"128","mapreduce.job.reducer.unconditional-preempt.delay.sec":"300","yarn.nodemanager.disk-health-checker.interval-ms":"120000","yarn.nodemanager.log.deletion-threads-count":"4","fs.s3a.committer.abort.pending.uploads":"true","yarn.webapp.filter-entity-list-by-user":"false","yarn.resourcemanager.activities-manager.app-activities.ttl-ms":"600000","ipc.client.connection.maxidletime":"10000","mapreduce.task.io.sort.mb":"100","yarn.nodemanager.localizer.client.thread-count":"5","io.erasurecode.codec.rs.rawcoders":"rs_native,rs_java","io.erasurecode.codec.rs-legacy.rawcoders":"rs-legacy_java","yarn.sharedcache.admin.address":"0.0.0.0:8047","yarn.resourcemanager.placement-constraints.algorithm.iterator":"SERIAL","yarn.nodemanager.localizer.cache.cleanup.interval-ms":"600000","hadoop.security.crypto.codec.classes.aes.ctr.nopadding":"org.apache.hadoop.crypto.OpensslAesCtrCryptoCodec, org.apache.hadoop.crypto.JceAesCtrCryptoCodec","mapreduce.job.cache.limit.max-resources-mb":"0","fs.s3a.connection.ssl.enabled":"true","yarn.nodemanager.process-kill-wait.ms":"5000","mapreduce.job.hdfs-servers":"${fs.defaultFS}","yarn.app.mapreduce.am.webapp.https.client.auth":"false","hadoop.workaround.non.threadsafe.getpwuid":"true","fs.df.interval":"60000","ipc.[port_number].decay-scheduler.thresholds":"13,25,50","fs.s3a.multiobjectdelete.enable":"true","yarn.sharedcache.cleaner.resource-sleep-ms":"0","yarn.nodemanager.disk-health-checker.min-healthy-disks":"0.25","hadoop.shell.missing.defaultFs.warning":"false","io.file.buffer.size":"65536","fs.viewfs.overload.scheme.target.wasb.impl":"org.apache.hadoop.fs.azure.NativeAzureFileSystem","hadoop.security.group.mapping.ldap.search.attr.member":"member","hadoop.security.random.device.file.path":"/dev/urandom","hadoop.security.sensitive-config-keys":"*********(redacted)","fs.s3a.s3guard.ddb.max.retries":"9","fs.viewfs.overload.scheme.target.file.impl":"org.apache.hadoop.fs.LocalFileSystem","hadoop.rpc.socket.factory.class.default":"org.apache.hadoop.net.StandardSocketFactory","yarn.intermediate-data-encryption.enable":"false","yarn.resourcemanager.connect.retry-interval.ms":"30000","yarn.nodemanager.container.stderr.pattern":"{*stderr*,*STDERR*}","yarn.scheduler.minimum-allocation-mb":"1024","yarn.app.mapreduce.am.staging-dir":"/tmp/hadoop-yarn/staging","mapreduce.reduce.shuffle.read.timeout":"180000","hadoop.http.cross-origin.max-age":"1800","io.erasurecode.codec.xor.rawcoders":"xor_native,xor_java","fs.s3a.s3guard.consistency.retry.limit":"7","fs.s3a.connection.establish.timeout":"5000","mapreduce.job.running.map.limit":"0","yarn.minicluster.control-resource-monitoring":"false","hadoop.ssl.require.client.cert":"false","hadoop.kerberos.kinit.command":"kinit","yarn.federation.state-store.class":"org.apache.hadoop.yarn.server.federation.store.impl.MemoryFederationStateStore","mapreduce.reduce.log.level":"INFO","hadoop.security.dns.log-slow-lookups.threshold.ms":"1000","mapreduce.job.ubertask.enable":"false","adl.http.timeout":"-1","yarn.resourcemanager.placement-constraints.retry-attempts":"3","hadoop.caller.context.enabled":"false","hadoop.security.group.mapping.ldap.num.attempts":"3","yarn.nodemanager.vmem-pmem-ratio":"2.1","hadoop.rpc.protection":"authentication","ha.health-monitor.rpc-timeout.ms":"45000","yarn.nodemanager.remote-app-log-dir":"/tmp/logs","hadoop.zk.timeout-ms":"10000","fs.s3a.s3guard.cli.prune.age":"86400000","yarn.nodemanager.resource.pcores-vcores-multiplier":"1.0","yarn.nodemanager.runtime.linux.sandbox-mode":"disabled","yarn.app.mapreduce.am.containerlauncher.threadpool-initial-size":"10","fs.viewfs.overload.scheme.target.webhdfs.impl":"org.apache.hadoop.hdfs.web.WebHdfsFileSystem","fs.s3a.committer.threads":"8","hadoop.zk.retry-interval-ms":"1000","hadoop.security.crypto.buffer.size":"8192","yarn.nodemanager.node-labels.provider.fetch-interval-ms":"600000","mapreduce.jobhistory.recovery.store.leveldb.path":"${hadoop.tmp.dir}/mapred/history/recoverystore","yarn.client.failover-retries-on-socket-timeouts":"0","fs.s3a.ssl.channel.mode":"default_jsse","yarn.nodemanager.resource.memory.enabled":"false","fs.azure.authorization.caching.enable":"true","hadoop.security.instrumentation.requires.admin":"false","yarn.nodemanager.delete.thread-count":"4","mapreduce.job.finish-when-all-reducers-done":"true","hadoop.registry.jaas.context":"Client","yarn.timeline-service.leveldb-timeline-store.path":"${hadoop.tmp.dir}/yarn/timeline","io.map.index.interval":"128","yarn.resourcemanager.nm-container-queuing.max-queue-wait-time-ms":"100","fs.abfs.impl":"org.apache.hadoop.fs.azurebfs.AzureBlobFileSystem","mapreduce.job.counters.max":"120","mapreduce.jobhistory.webapp.rest-csrf.enabled":"false","yarn.timeline-service.store-class":"org.apache.hadoop.yarn.server.timeline.LeveldbTimelineStore","mapreduce.jobhistory.move.interval-ms":"180000","fs.s3a.change.detection.version.required":"true","yarn.nodemanager.localizer.fetch.thread-count":"4","yarn.resourcemanager.scheduler.client.thread-count":"50","hadoop.ssl.hostname.verifier":"DEFAULT","yarn.timeline-service.leveldb-state-store.path":"${hadoop.tmp.dir}/yarn/timeline","mapreduce.job.classloader":"false","mapreduce.task.profile.map.params":"${mapreduce.task.profile.params}","ipc.client.connect.timeout":"20000","hadoop.security.auth_to_local.mechanism":"hadoop","yarn.timeline-service.app-collector.linger-period.ms":"60000","yarn.nm.liveness-monitor.expiry-interval-ms":"600000","yarn.resourcemanager.reservation-system.planfollower.time-step":"1000","yarn.resourcemanager.proxy.timeout.enabled":"true","yarn.resourcemanager.activities-manager.scheduler-activities.ttl-ms":"600000","yarn.nodemanager.runtime.linux.docker.enable-userremapping.allowed":"true","yarn.webapp.api-service.enable":"false","yarn.nodemanager.recovery.enabled":"false","mapreduce.job.end-notification.retry.interval":"1000","fs.du.interval":"600000","fs.ftp.impl":"org.apache.hadoop.fs.ftp.FTPFileSystem","yarn.nodemanager.container.stderr.tail.bytes":"4096","yarn.nodemanager.disk-health-checker.disk-free-space-threshold.enabled":"true","hadoop.security.group.mapping.ldap.read.timeout.ms":"60000","hadoop.security.groups.cache.warn.after.ms":"5000","file.bytes-per-checksum":"512","mapreduce.outputcommitter.factory.scheme.s3a":"org.apache.hadoop.fs.s3a.commit.S3ACommitterFactory","hadoop.security.groups.cache.background.reload":"false","yarn.nodemanager.container-monitor.enabled":"true","yarn.nodemanager.elastic-memory-control.enabled":"false","net.topology.script.number.args":"100","mapreduce.task.merge.progress.records":"10000","yarn.nodemanager.localizer.address":"${yarn.nodemanager.hostname}:8040","yarn.timeline-service.keytab":"/etc/krb5.keytab","mapreduce.reduce.shuffle.fetch.retry.timeout-ms":"30000","yarn.resourcemanager.rm.container-allocation.expiry-interval-ms":"600000","yarn.nodemanager.container-executor.exit-code-file.timeout-ms":"2000","mapreduce.fileoutputcommitter.algorithm.version":"1","yarn.resourcemanager.work-preserving-recovery.enabled":"true","mapreduce.map.skip.maxrecords":"0","yarn.sharedcache.root-dir":"/sharedcache","fs.s3a.retry.throttle.limit":"20","hadoop.http.authentication.type":"simple","fs.viewfs.overload.scheme.target.oss.impl":"org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem","mapreduce.job.cache.limit.max-resources":"0","mapreduce.task.userlog.limit.kb":"0","ipc.[port_number].weighted-cost.handler":"1","yarn.resourcemanager.scheduler.monitor.enable":"false","ipc.client.connect.max.retries":"10","hadoop.registry.zk.retry.times":"5","yarn.nodemanager.resource-monitor.interval-ms":"3000","yarn.nodemanager.resource-plugins.gpu.allowed-gpu-devices":"auto","mapreduce.job.sharedcache.mode":"disabled","yarn.nodemanager.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.shuffle.listen.queue.size":"128","yarn.scheduler.configuration.mutation.acl-policy.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.DefaultConfigurationMutationACLPolicy","mapreduce.map.cpu.vcores":"1","yarn.log-aggregation.file-formats":"TFile","yarn.timeline-service.client.fd-retain-secs":"300","fs.s3a.select.output.csv.field.delimiter":",","yarn.nodemanager.health-checker.timeout-ms":"1200000","hadoop.user.group.static.mapping.overrides":"dr.who=;","fs.azure.sas.expiry.period":"90d","fs.s3a.select.output.csv.record.delimiter":"\\n","mapreduce.jobhistory.recovery.store.class":"org.apache.hadoop.mapreduce.v2.hs.HistoryServerFileSystemStateStoreService","fs.viewfs.overload.scheme.target.https.impl":"org.apache.hadoop.fs.http.HttpsFileSystem","fs.s3a.s3guard.ddb.table.sse.enabled":"false","yarn.resourcemanager.fail-fast":"${yarn.fail-fast}","yarn.resourcemanager.proxy-user-privileges.enabled":"false","yarn.router.webapp.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.webapp.DefaultRequestInterceptorREST","yarn.nodemanager.resource.memory.cgroups.soft-limit-percentage":"90.0","mapreduce.job.reducer.preempt.delay.sec":"0","hadoop.util.hash.type":"murmur","yarn.nodemanager.disk-validator":"basic","yarn.app.mapreduce.client.job.max-retries":"3","fs.viewfs.overload.scheme.target.ftp.impl":"org.apache.hadoop.fs.ftp.FTPFileSystem","mapreduce.reduce.shuffle.retry-delay.max.ms":"60000","hadoop.security.group.mapping.ldap.connection.timeout.ms":"60000","mapreduce.task.profile.params":"-agentlib:hprof=cpu=samples,heap=sites,force=n,thread=y,verbose=n,file=%s","yarn.app.mapreduce.shuffle.log.backups":"0","yarn.nodemanager.container-diagnostics-maximum-size":"10000","hadoop.registry.zk.retry.interval.ms":"1000","yarn.nodemanager.linux-container-executor.cgroups.delete-timeout-ms":"1000","fs.AbstractFileSystem.file.impl":"org.apache.hadoop.fs.local.LocalFs","yarn.nodemanager.log-aggregation.roll-monitoring-interval-seconds":"-1","mapreduce.jobhistory.cleaner.interval-ms":"86400000","hadoop.registry.zk.quorum":"localhost:2181","yarn.nodemanager.runtime.linux.runc.allowed-container-runtimes":"runc","mapreduce.output.fileoutputformat.compress":"false","yarn.resourcemanager.am-rm-tokens.master-key-rolling-interval-secs":"*********(redacted)","fs.s3a.assumed.role.session.duration":"30m","hadoop.security.group.mapping.ldap.conversion.rule":"none","hadoop.ssl.server.conf":"ssl-server.xml","fs.s3a.retry.throttle.interval":"100ms","seq.io.sort.factor":"100","fs.viewfs.overload.scheme.target.ofs.impl":"org.apache.hadoop.fs.ozone.RootedOzoneFileSystem","yarn.sharedcache.cleaner.initial-delay-mins":"10","mapreduce.client.completion.pollinterval":"5000","hadoop.ssl.keystores.factory.class":"org.apache.hadoop.security.ssl.FileBasedKeyStoresFactory","yarn.app.mapreduce.am.resource.cpu-vcores":"1","yarn.timeline-service.enabled":"false","yarn.nodemanager.runtime.linux.docker.capabilities":"CHOWN,DAC_OVERRIDE,FSETID,FOWNER,MKNOD,NET_RAW,SETGID,SETUID,SETFCAP,SETPCAP,NET_BIND_SERVICE,SYS_CHROOT,KILL,AUDIT_WRITE","yarn.acl.enable":"false","yarn.timeline-service.entity-group-fs-store.done-dir":"/tmp/entity-file-history/done/","hadoop.security.group.mapping.ldap.num.attempts.before.failover":"3","mapreduce.task.profile":"false","hadoop.prometheus.endpoint.enabled":"false","yarn.resourcemanager.fs.state-store.uri":"${hadoop.tmp.dir}/yarn/system/rmstore","mapreduce.jobhistory.always-scan-user-dir":"false","fs.s3a.metadatastore.metadata.ttl":"15m","yarn.nodemanager.opportunistic-containers-use-pause-for-preemption":"false","yarn.nodemanager.linux-container-executor.nonsecure-mode.local-user":"nobody","yarn.timeline-service.reader.class":"org.apache.hadoop.yarn.server.timelineservice.storage.HBaseTimelineReaderImpl","yarn.resourcemanager.configuration.provider-class":"org.apache.hadoop.yarn.LocalConfigurationProvider","yarn.nodemanager.runtime.linux.docker.userremapping-uid-threshold":"1","yarn.resourcemanager.configuration.file-system-based-store":"/yarn/conf","mapreduce.job.cache.limit.max-single-resource-mb":"0","yarn.nodemanager.runtime.linux.docker.stop.grace-period":"10","yarn.resourcemanager.resource-profiles.source-file":"resource-profiles.json","mapreduce.job.dfs.storage.capacity.kill-limit-exceed":"false","yarn.nodemanager.resource.percentage-physical-cpu-limit":"100","mapreduce.jobhistory.client.thread-count":"10","tfile.fs.input.buffer.size":"262144","mapreduce.client.progressmonitor.pollinterval":"1000","yarn.nodemanager.log-dirs":"${yarn.log.dir}/userlogs","yarn.resourcemanager.opportunistic.max.container-allocation.per.am.heartbeat":"-1","fs.automatic.close":"true","yarn.resourcemanager.delegation-token-renewer.thread-retry-interval":"*********(redacted)","fs.s3a.select.input.csv.quote.character":"\"","yarn.nodemanager.hostname":"0.0.0.0","ipc.[port_number].cost-provider.impl":"org.apache.hadoop.ipc.DefaultCostProvider","yarn.nodemanager.runtime.linux.runc.manifest-to-resources-plugin":"org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.runtime.runc.HdfsManifestToResourcesPlugin","yarn.nodemanager.remote-app-log-dir-include-older":"true","yarn.nodemanager.resource.memory.cgroups.swappiness":"0","ftp.stream-buffer-size":"4096","yarn.fail-fast":"false","yarn.nodemanager.runtime.linux.runc.layer-mounts-to-keep":"100","yarn.timeline-service.app-aggregation-interval-secs":"15","hadoop.security.group.mapping.ldap.search.filter.user":"(&(objectClass=user)(sAMAccountName={0}))","ipc.[port_number].weighted-cost.lockshared":"10","yarn.nodemanager.container-localizer.log.level":"INFO","yarn.timeline-service.address":"${yarn.timeline-service.hostname}:10200","mapreduce.job.ubertask.maxmaps":"9","fs.s3a.threads.keepalivetime":"60","mapreduce.jobhistory.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","mapreduce.task.files.preserve.failedtasks":"false","yarn.app.mapreduce.client.job.retry-interval":"2000","ha.failover-controller.graceful-fence.connection.retries":"1","fs.s3a.select.output.csv.quote.escape.character":"\\\\","yarn.resourcemanager.delegation.token.max-lifetime":"*********(redacted)","hadoop.kerberos.keytab.login.autorenewal.enabled":"false","yarn.timeline-service.client.drain-entities.timeout.ms":"2000","yarn.nodemanager.resource-plugins.fpga.vendor-plugin.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.resourceplugin.fpga.IntelFpgaOpenclPlugin","yarn.resourcemanager.nodemanagers.heartbeat-interval-min-ms":"1000","yarn.timeline-service.entity-group-fs-store.summary-store":"org.apache.hadoop.yarn.server.timeline.LeveldbTimelineStore","mapreduce.reduce.cpu.vcores":"1","mapreduce.job.encrypted-intermediate-data.buffer.kb":"128","fs.client.resolve.remote.symlinks":"true","yarn.nodemanager.webapp.https.address":"0.0.0.0:8044","hadoop.http.cross-origin.allowed-origins":"*","mapreduce.job.encrypted-intermediate-data":"false","yarn.nodemanager.disk-health-checker.disk-utilization-threshold.enabled":"true","fs.s3a.executor.capacity":"16","yarn.timeline-service.entity-group-fs-store.retain-seconds":"604800","yarn.resourcemanager.metrics.runtime.buckets":"60,300,1440","yarn.timeline-service.generic-application-history.max-applications":"10000","yarn.nodemanager.local-dirs":"${hadoop.tmp.dir}/nm-local-dir","mapreduce.shuffle.connection-keep-alive.enable":"false","yarn.node-labels.configuration-type":"centralized","fs.s3a.path.style.access":"false","yarn.nodemanager.aux-services.mapreduce_shuffle.class":"org.apache.hadoop.mapred.ShuffleHandler","yarn.sharedcache.store.in-memory.staleness-period-mins":"10080","fs.adl.impl":"org.apache.hadoop.fs.adl.AdlFileSystem","yarn.resourcemanager.application.max-tags":"10","hadoop.domainname.resolver.impl":"org.apache.hadoop.net.DNSDomainNameResolver","yarn.resourcemanager.nodemanager.minimum.version":"NONE","mapreduce.jobhistory.webapp.xfs-filter.xframe-options":"SAMEORIGIN","yarn.app.mapreduce.am.staging-dir.erasurecoding.enabled":"false","net.topology.impl":"org.apache.hadoop.net.NetworkTopology","io.map.index.skip":"0","yarn.timeline-service.reader.webapp.https.address":"${yarn.timeline-service.webapp.https.address}","fs.ftp.data.connection.mode":"ACTIVE_LOCAL_DATA_CONNECTION_MODE","mapreduce.job.local-fs.single-disk-limit.check.kill-limit-exceed":"true","fs.azure.buffer.dir":"${hadoop.tmp.dir}/abfs","yarn.scheduler.maximum-allocation-vcores":"4","hadoop.http.cross-origin.allowed-headers":"X-Requested-With,Content-Type,Accept,Origin","yarn.nodemanager.log-aggregation.compression-type":"none","yarn.timeline-service.version":"1.0f","yarn.ipc.rpc.class":"org.apache.hadoop.yarn.ipc.HadoopYarnProtoRPC","mapreduce.reduce.maxattempts":"4","yarn.resourcemanager.system-metrics-publisher.timeline-server-v1.batch-size":"1000","hadoop.security.dns.log-slow-lookups.enabled":"false","mapreduce.job.committer.setup.cleanup.needed":"true","hadoop.security.secure.random.impl":"org.apache.hadoop.crypto.random.OpensslSecureRandom","mapreduce.job.running.reduce.limit":"0","fs.s3a.select.errors.include.sql":"false","fs.s3a.connection.request.timeout":"0","ipc.maximum.response.length":"134217728","yarn.resourcemanager.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","mapreduce.job.token.tracking.ids.enabled":"*********(redacted)","hadoop.caller.context.max.size":"128","yarn.nodemanager.runtime.linux.docker.host-pid-namespace.allowed":"false","yarn.nodemanager.runtime.linux.docker.delayed-removal.allowed":"false","hadoop.registry.system.acls":"sasl:yarn@, sasl:mapred@, sasl:hdfs@","yarn.nodemanager.recovery.dir":"${hadoop.tmp.dir}/yarn-nm-recovery","fs.s3a.fast.upload.buffer":"disk","mapreduce.jobhistory.intermediate-done-dir":"${yarn.app.mapreduce.am.staging-dir}/history/done_intermediate","yarn.app.mapreduce.shuffle.log.separate":"true","yarn.log-aggregation.debug.filesize":"104857600","fs.s3a.max.total.tasks":"32","fs.s3a.readahead.range":"64K","hadoop.http.authentication.simple.anonymous.allowed":"true","fs.s3a.attempts.maximum":"20","hadoop.registry.zk.connection.timeout.ms":"15000","yarn.resourcemanager.delegation-token-renewer.thread-count":"*********(redacted)","yarn.resourcemanager.delegation-token-renewer.thread-timeout":"*********(redacted)","yarn.timeline-service.leveldb-timeline-store.start-time-write-cache-size":"10000","yarn.nodemanager.aux-services.manifest.reload-ms":"0","yarn.nodemanager.emit-container-events":"true","yarn.resourcemanager.resource-profiles.enabled":"false","yarn.timeline-service.hbase-schema.prefix":"prod.","fs.azure.authorization":"false","mapreduce.map.log.level":"INFO","ha.failover-controller.active-standby-elector.zk.op.retries":"3","yarn.resourcemanager.decommissioning-nodes-watcher.poll-interval-secs":"20","mapreduce.output.fileoutputformat.compress.type":"RECORD","yarn.resourcemanager.leveldb-state-store.path":"${hadoop.tmp.dir}/yarn/system/rmstore","yarn.timeline-service.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.ifile.readahead.bytes":"4194304","yarn.sharedcache.app-checker.class":"org.apache.hadoop.yarn.server.sharedcachemanager.RemoteAppChecker","yarn.nodemanager.linux-container-executor.nonsecure-mode.limit-users":"true","yarn.nodemanager.resource.detect-hardware-capabilities":"false","mapreduce.cluster.acls.enabled":"false","mapreduce.job.speculative.retry-after-no-speculate":"1000","fs.viewfs.overload.scheme.target.abfs.impl":"org.apache.hadoop.fs.azurebfs.AzureBlobFileSystem","hadoop.security.group.mapping.ldap.search.group.hierarchy.levels":"0","yarn.resourcemanager.fs.state-store.retry-interval-ms":"1000","file.stream-buffer-size":"4096","yarn.resourcemanager.application-timeouts.monitor.interval-ms":"3000","mapreduce.map.output.compress.codec":"org.apache.hadoop.io.compress.DefaultCodec","mapreduce.map.speculative":"true","yarn.nodemanager.runtime.linux.runc.image-tag-to-manifest-plugin.hdfs-hash-file":"/runc-root/image-tag-to-hash","mapreduce.job.speculative.retry-after-speculate":"15000","yarn.nodemanager.linux-container-executor.cgroups.mount":"false","yarn.app.mapreduce.am.container.log.backups":"0","yarn.app.mapreduce.am.log.level":"INFO","yarn.nodemanager.runtime.linux.runc.image-tag-to-manifest-plugin":"org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.runtime.runc.ImageTagToManifestPlugin","io.bytes.per.checksum":"512","mapreduce.job.reduce.slowstart.completedmaps":"0.05","yarn.timeline-service.http-authentication.type":"simple","hadoop.security.group.mapping.ldap.search.attr.group.name":"cn","yarn.nodemanager.resource-plugins.fpga.allowed-fpga-devices":"auto","yarn.timeline-service.client.internal-timers-ttl-secs":"420","fs.s3a.select.output.csv.quote.character":"\"","hadoop.http.logs.enabled":"true","fs.s3a.block.size":"32M","yarn.sharedcache.client-server.address":"0.0.0.0:8045","yarn.nodemanager.logaggregation.threadpool-size-max":"100","yarn.resourcemanager.hostname":"0.0.0.0","yarn.resourcemanager.delegation.key.update-interval":"86400000","mapreduce.reduce.shuffle.fetch.retry.enabled":"${yarn.nodemanager.recovery.enabled}","mapreduce.map.memory.mb":"-1","mapreduce.task.skip.start.attempts":"2","fs.AbstractFileSystem.hdfs.impl":"org.apache.hadoop.fs.Hdfs","yarn.nodemanager.disk-health-checker.enable":"true","fs.s3a.select.output.csv.quote.fields":"always","ipc.client.tcpnodelay":"true","ipc.client.rpc-timeout.ms":"0","yarn.nodemanager.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","yarn.resourcemanager.delegation-token-renewer.thread-retry-max-attempts":"*********(redacted)","ipc.client.low-latency":"false","mapreduce.input.lineinputformat.linespermap":"1","yarn.router.interceptor.user.threadpool-size":"5","ipc.client.connect.max.retries.on.timeouts":"45","yarn.timeline-service.leveldb-timeline-store.read-cache-size":"104857600","fs.AbstractFileSystem.har.impl":"org.apache.hadoop.fs.HarFs","mapreduce.job.split.metainfo.maxsize":"10000000","yarn.am.liveness-monitor.expiry-interval-ms":"600000","yarn.resourcemanager.container-tokens.master-key-rolling-interval-secs":"*********(redacted)","yarn.timeline-service.entity-group-fs-store.app-cache-size":"10","yarn.nodemanager.runtime.linux.runc.hdfs-manifest-to-resources-plugin.stat-cache-timeout-interval-secs":"360","fs.s3a.socket.recv.buffer":"8192","rpc.metrics.timeunit":"MILLISECONDS","yarn.resourcemanager.resource-tracker.address":"${yarn.resourcemanager.hostname}:8031","yarn.nodemanager.node-labels.provider.fetch-timeout-ms":"1200000","mapreduce.job.heap.memory-mb.ratio":"0.8","yarn.resourcemanager.leveldb-state-store.compaction-interval-secs":"3600","yarn.resourcemanager.webapp.rest-csrf.custom-header":"X-XSRF-Header","yarn.nodemanager.pluggable-device-framework.enabled":"false","yarn.scheduler.configuration.fs.path":"file://${hadoop.tmp.dir}/yarn/system/schedconf","mapreduce.client.output.filter":"FAILED","hadoop.http.filter.initializers":"org.apache.hadoop.http.lib.StaticUserWebFilter","mapreduce.reduce.memory.mb":"-1","yarn.timeline-service.hostname":"0.0.0.0","file.replication":"1","yarn.nodemanager.container-metrics.unregister-delay-ms":"10000","yarn.nodemanager.container-metrics.period-ms":"-1","mapreduce.fileoutputcommitter.task.cleanup.enabled":"false","yarn.nodemanager.log.retain-seconds":"10800","yarn.timeline-service.entity-group-fs-store.cleaner-interval-seconds":"3600","ipc.[port_number].callqueue.impl":"java.util.concurrent.LinkedBlockingQueue","yarn.resourcemanager.keytab":"/etc/krb5.keytab","hadoop.security.group.mapping.providers.combined":"true","mapreduce.reduce.merge.inmem.threshold":"1000","yarn.timeline-service.recovery.enabled":"false","fs.azure.saskey.usecontainersaskeyforallaccess":"true","yarn.sharedcache.nm.uploader.thread-count":"20","yarn.resourcemanager.nodemanager-graceful-decommission-timeout-secs":"3600","ipc.[port_number].weighted-cost.lockfree":"1","mapreduce.shuffle.ssl.enabled":"false","yarn.timeline-service.hbase.coprocessor.app-final-value-retention-milliseconds":"259200000","yarn.nodemanager.opportunistic-containers-max-queue-length":"0","yarn.resourcemanager.state-store.max-completed-applications":"${yarn.resourcemanager.max-completed-applications}","mapreduce.job.speculative.minimum-allowed-tasks":"10","fs.s3a.aws.credentials.provider":"\n    org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider,\n    org.apache.hadoop.fs.s3a.SimpleAWSCredentialsProvider,\n    com.amazonaws.auth.EnvironmentVariableCredentialsProvider,\n    org.apache.hadoop.fs.s3a.auth.IAMInstanceCredentialsProvider\n  ","yarn.log-aggregation.retain-seconds":"-1","yarn.nodemanager.disk-health-checker.min-free-space-per-disk-mb":"0","mapreduce.jobhistory.max-age-ms":"604800000","hadoop.http.cross-origin.allowed-methods":"GET,POST,HEAD","yarn.resourcemanager.opportunistic-container-allocation.enabled":"false","mapreduce.jobhistory.webapp.address":"0.0.0.0:19888","hadoop.system.tags":"YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL","yarn.log-aggregation.file-controller.TFile.class":"org.apache.hadoop.yarn.logaggregation.filecontroller.tfile.LogAggregationTFileController","yarn.client.nodemanager-connect.max-wait-ms":"180000","yarn.resourcemanager.webapp.address":"${yarn.resourcemanager.hostname}:8088","mapreduce.jobhistory.recovery.enable":"false","mapreduce.reduce.shuffle.parallelcopies":"5","fs.AbstractFileSystem.webhdfs.impl":"org.apache.hadoop.fs.WebHdfs","fs.trash.interval":"0","yarn.app.mapreduce.client.max-retries":"3","hadoop.security.authentication":"simple","mapreduce.task.profile.reduce.params":"${mapreduce.task.profile.params}","yarn.app.mapreduce.am.resource.mb":"1536","mapreduce.input.fileinputformat.list-status.num-threads":"1","yarn.nodemanager.container-executor.class":"org.apache.hadoop.yarn.server.nodemanager.DefaultContainerExecutor","io.mapfile.bloom.size":"1048576","yarn.timeline-service.ttl-ms":"604800000","yarn.resourcemanager.nm-container-queuing.min-queue-length":"5","yarn.nodemanager.resource.cpu-vcores":"-1","mapreduce.job.reduces":"1","fs.s3a.multipart.size":"64M","fs.s3a.select.input.csv.comment.marker":"#","yarn.scheduler.minimum-allocation-vcores":"1","mapreduce.job.speculative.speculative-cap-total-tasks":"0.01","hadoop.ssl.client.conf":"ssl-client.xml","mapreduce.job.queuename":"default","mapreduce.job.encrypted-intermediate-data-key-size-bits":"128","fs.s3a.metadatastore.authoritative":"false","ipc.[port_number].weighted-cost.response":"1","yarn.nodemanager.webapp.xfs-filter.xframe-options":"SAMEORIGIN","ha.health-monitor.sleep-after-disconnect.ms":"1000","yarn.app.mapreduce.shuffle.log.limit.kb":"0","hadoop.security.group.mapping":"org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback","yarn.client.application-client-protocol.poll-timeout-ms":"-1","mapreduce.jobhistory.jhist.format":"binary","mapreduce.task.stuck.timeout-ms":"600000","yarn.resourcemanager.application.max-tag.length":"100","yarn.resourcemanager.ha.enabled":"false","dfs.client.ignore.namenode.default.kms.uri":"false","hadoop.http.staticuser.user":"dr.who","mapreduce.task.exit.timeout.check-interval-ms":"20000","mapreduce.jobhistory.intermediate-user-done-dir.permissions":"770","mapreduce.task.exit.timeout":"60000","yarn.nodemanager.linux-container-executor.resources-handler.class":"org.apache.hadoop.yarn.server.nodemanager.util.DefaultLCEResourcesHandler","mapreduce.reduce.shuffle.memory.limit.percent":"0.25","yarn.resourcemanager.reservation-system.enable":"false","mapreduce.map.output.compress":"false","ha.zookeeper.acl":"world:anyone:rwcda","ipc.server.max.connections":"0","yarn.nodemanager.runtime.linux.docker.default-container-network":"host","yarn.router.webapp.address":"0.0.0.0:8089","yarn.scheduler.maximum-allocation-mb":"8192","yarn.resourcemanager.scheduler.monitor.policies":"org.apache.hadoop.yarn.server.resourcemanager.monitor.capacity.ProportionalCapacityPreemptionPolicy","yarn.sharedcache.cleaner.period-mins":"1440","yarn.nodemanager.resource-plugins.gpu.docker-plugin.nvidia-docker-v1.endpoint":"http://localhost:3476/v1.0/docker/cli","yarn.app.mapreduce.am.container.log.limit.kb":"0","ipc.client.connect.retry.interval":"1000","yarn.timeline-service.http-cross-origin.enabled":"false","fs.wasbs.impl":"org.apache.hadoop.fs.azure.NativeAzureFileSystem$Secure","yarn.resourcemanager.nodemanagers.heartbeat-interval-max-ms":"1000","yarn.federation.subcluster-resolver.class":"org.apache.hadoop.yarn.server.federation.resolver.DefaultSubClusterResolverImpl","yarn.resourcemanager.zk-state-store.parent-path":"/rmstore","fs.s3a.select.input.csv.field.delimiter":",","mapreduce.jobhistory.cleaner.enable":"true","yarn.timeline-service.client.fd-flush-interval-secs":"10","hadoop.security.kms.client.encrypted.key.cache.expiry":"43200000","yarn.client.nodemanager-client-async.thread-pool-max-size":"500","mapreduce.map.maxattempts":"4","yarn.resourcemanager.nm-container-queuing.sorting-nodes-interval-ms":"1000","fs.s3a.committer.staging.tmp.path":"tmp/staging","yarn.nodemanager.sleep-delay-before-sigkill.ms":"250","yarn.resourcemanager.nm-container-queuing.min-queue-wait-time-ms":"10","mapreduce.job.end-notification.retry.attempts":"0","yarn.nodemanager.resource.count-logical-processors-as-cores":"false","hadoop.registry.zk.root":"/registry","adl.feature.ownerandgroup.enableupn":"false","yarn.resourcemanager.zk-max-znode-size.bytes":"1048576","mapreduce.job.reduce.shuffle.consumer.plugin.class":"org.apache.hadoop.mapreduce.task.reduce.Shuffle","yarn.resourcemanager.delayed.delegation-token.removal-interval-ms":"*********(redacted)","yarn.nodemanager.localizer.cache.target-size-mb":"10240","fs.s3a.committer.staging.conflict-mode":"append","mapreduce.client.libjars.wildcard":"true","fs.s3a.committer.staging.unique-filenames":"true","yarn.nodemanager.node-attributes.provider.fetch-timeout-ms":"1200000","fs.s3a.list.version":"2","ftp.client-write-packet-size":"65536","ipc.[port_number].weighted-cost.lockexclusive":"100","fs.AbstractFileSystem.adl.impl":"org.apache.hadoop.fs.adl.Adl","yarn.nodemanager.container-log-monitor.enable":"false","hadoop.security.key.default.cipher":"AES/CTR/NoPadding","yarn.client.failover-retries":"0","fs.s3a.multipart.purge.age":"86400","mapreduce.job.local-fs.single-disk-limit.check.interval-ms":"5000","net.topology.node.switch.mapping.impl":"org.apache.hadoop.net.ScriptBasedMapping","yarn.nodemanager.amrmproxy.address":"0.0.0.0:8049","ipc.server.listen.queue.size":"256","ipc.[port_number].decay-scheduler.period-ms":"5000","yarn.nodemanager.runtime.linux.runc.image-tag-to-manifest-plugin.cache-refresh-interval-secs":"60","map.sort.class":"org.apache.hadoop.util.QuickSort","fs.viewfs.rename.strategy":"SAME_MOUNTPOINT","hadoop.security.kms.client.authentication.retry-count":"1","fs.permissions.umask-mode":"022","fs.s3a.assumed.role.credentials.provider":"org.apache.hadoop.fs.s3a.SimpleAWSCredentialsProvider","yarn.nodemanager.runtime.linux.runc.privileged-containers.allowed":"false","yarn.nodemanager.vmem-check-enabled":"true","yarn.nodemanager.numa-awareness.enabled":"false","yarn.nodemanager.recovery.compaction-interval-secs":"3600","yarn.app.mapreduce.client-am.ipc.max-retries":"3","yarn.resourcemanager.system-metrics-publisher.timeline-server-v1.interval-seconds":"60","yarn.federation.registry.base-dir":"yarnfederation/","yarn.nodemanager.health-checker.run-before-startup":"false","mapreduce.job.max.map":"-1","mapreduce.job.local-fs.single-disk-limit.bytes":"-1","mapreduce.shuffle.pathcache.concurrency-level":"16","mapreduce.job.ubertask.maxreduces":"1","mapreduce.shuffle.pathcache.max-weight":"10485760","hadoop.security.kms.client.encrypted.key.cache.size":"500","hadoop.security.java.secure.random.algorithm":"SHA1PRNG","ha.failover-controller.cli-check.rpc-timeout.ms":"20000","mapreduce.jobhistory.jobname.limit":"50","fs.s3a.select.input.compression":"none","yarn.client.nodemanager-connect.retry-interval-ms":"10000","ipc.[port_number].scheduler.priority.levels":"4","yarn.timeline-service.state-store-class":"org.apache.hadoop.yarn.server.timeline.recovery.LeveldbTimelineStateStore","yarn.nodemanager.env-whitelist":"JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_HOME,PATH,LANG,TZ","yarn.sharedcache.nested-level":"3","yarn.timeline-service.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","fs.azure.user.agent.prefix":"unknown","yarn.resourcemanager.zk-delegation-token-node.split-index":"*********(redacted)","yarn.nodemanager.numa-awareness.read-topology":"false","yarn.nodemanager.webapp.address":"${yarn.nodemanager.hostname}:8042","rpc.metrics.quantile.enable":"false","yarn.registry.class":"org.apache.hadoop.registry.client.impl.FSRegistryOperationsService","mapreduce.jobhistory.admin.acl":"*","yarn.resourcemanager.system-metrics-publisher.dispatcher.pool-size":"10","yarn.scheduler.queue-placement-rules":"user-group","hadoop.http.authentication.kerberos.keytab":"${user.home}/hadoop.keytab","yarn.resourcemanager.recovery.enabled":"false","fs.s3a.select.input.csv.header":"none","yarn.nodemanager.runtime.linux.runc.hdfs-manifest-to-resources-plugin.stat-cache-size":"500","yarn.timeline-service.webapp.rest-csrf.enabled":"false","yarn.nodemanager.disk-health-checker.min-free-space-per-disk-watermark-high-mb":"0"},"System Properties":{"java.io.tmpdir":"/tmp","line.separator":"\n","path.separator":":","sun.management.compiler":"HotSpot 64-Bit Tiered Compilers","SPARK_SUBMIT":"true","sun.cpu.endian":"little","java.specification.maintenance.version":"1","java.specification.version":"17","java.vm.specification.name":"Java Virtual Machine Specification","java.vendor":"Ubuntu","java.vm.specification.version":"17","user.home":"/home/lol","sun.arch.data.model":"64","sun.boot.library.path":"/usr/lib/jvm/java-17-openjdk-amd64/lib","user.dir":"/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src","java.library.path":"/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib","os.arch":"amd64","java.vm.version":"17.0.15+6-Ubuntu-0ubuntu122.04","jetty.git.hash":"cef3fbd6d736a21e7d541a5db490381d95a2047d","java.runtime.version":"17.0.15+6-Ubuntu-0ubuntu122.04","java.vm.info":"mixed mode, sharing","java.runtime.name":"OpenJDK Runtime Environment","java.version.date":"2025-04-15","file.separator":"/","java.class.version":"61.0","java.specification.name":"Java Platform API Specification","file.encoding":"UTF-8","jdk.reflect.useDirectMethodHandle":"false","user.timezone":"Asia/Shanghai","java.specification.vendor":"Oracle Corporation","sun.java.launcher":"SUN_STANDARD","java.vm.compressedOopsMode":"32-bit","os.version":"5.15.153.1-microsoft-standard-WSL2","native.encoding":"UTF-8","java.vm.specification.vendor":"Oracle Corporation","sun.stderr.encoding":"UTF-8","sun.jnu.encoding":"UTF-8","user.language":"en","sun.stdout.encoding":"UTF-8","java.vendor.url":"https://ubuntu.com/","os.name":"Linux","java.vm.vendor":"Ubuntu","jdk.debug":"release","java.vendor.url.bug":"https://bugs.launchpad.net/ubuntu/+source/openjdk-17","user.name":"lol","java.vm.name":"OpenJDK 64-Bit Server VM","sun.java.command":"org.apache.spark.deploy.SparkSubmit --conf spark.master=local[*] --conf spark.eventLog.enabled=true --conf spark.eventLog.dir=file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events --conf spark.app.name=appMetrics pyspark-shell","java.home":"/usr/lib/jvm/java-17-openjdk-amd64","java.version":"17.0.15","sun.io.unicode.encoding":"UnicodeLittle"},"Metrics Properties":{"*.sink.servlet.class":"org.apache.spark.metrics.sink.MetricsServlet","*.sink.servlet.path":"/metrics/json","applications.sink.servlet.path":"/metrics/applications/json","master.sink.servlet.path":"/metrics/master/json"},"Classpath Entries":{"/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-yarn_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/aircompressor-0.27.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-codec-1.16.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jpam-1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-repl_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/ST4-4.0.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-hive-thriftserver_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spire-platform_2.12-0.17.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-client-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-handler-proxy-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-networking-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/leveldbjni-all-1.8.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kryo-shaded-4.0.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/orc-mapreduce-1.9.4-shaded-protobuf.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-gatewayapi-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-client-api-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/json4s-jackson_2.12-3.7.0-M11.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/algebra_2.12-2.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-dataformat-yaml-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/curator-framework-2.13.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-core-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-io-2.16.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/json4s-ast_2.12-3.7.0-M11.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jcl-over-slf4j-2.0.7.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-crypto-1.1.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-all-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/cats-kernel_2.12-2.1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/pickle-1.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/metrics-graphite-4.2.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-native-kqueue-4.1.96.Final-osx-aarch_64.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-network-shuffle_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-kvstore_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/datanucleus-core-4.1.17.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-codec-http-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-classes-kqueue-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-format-structures-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jul-to-slf4j-2.0.7.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-sql_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-common-utils_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-rbac-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.inject-2.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arpack_combined_all-0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-shims-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/log4j-1.2-api-2.20.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-mapper-asl-1.9.13.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/log4j-api-2.20.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jta-1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/shims-0.9.45.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/snakeyaml-2.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/datasketches-java-3.3.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spire-macros_2.12-0.17.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-native-epoll-4.1.96.Final-linux-aarch_64.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/objenesis-3.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/transaction-api-1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-parser-combinators_2.12-2.3.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/activation-1.1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.validation-api-2.0.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-databind-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/javolution-5.5.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/datanucleus-rdbms-4.1.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/antlr4-runtime-4.9.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/datasketches-memory-2.1.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-storage-api-2.8.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-metrics-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arrow-memory-core-12.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/JLargeArrays-1.5.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/curator-recipes-2.13.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/zookeeper-jute-3.6.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/istack-commons-runtime-3.0.8.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-catalyst_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-client-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/json4s-scalap_2.12-3.7.0-M11.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/httpcore-4.4.16.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/paranamer-2.8.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-datatype-jsr310-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/json-1.8.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-collections4-4.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/javassist-3.29.2-GA.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/audience-annotations-0.5.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hadoop-client-api-3.3.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/breeze_2.12-2.1.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arrow-memory-netty-12.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-compress-1.23.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-common-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hk2-api-2.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-encoding-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-classes-epoll-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-shims-0.23-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.annotation-api-1.3.5.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/stream-2.9.6.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-exec-2.3.9-core.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-certificates-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-shims-scheduler-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/xz-1.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-mllib_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-streaming_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-mllib-local_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-dbcp-1.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/lz4-java-1.8.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-pool-1.5.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-shims-common-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jdo-api-3.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/okio-1.15.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arrow-format-12.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-logging-1.1.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-cli-1.5.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.ws.rs-api-2.1.6.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-apps-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-annotations-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/json4s-core_2.12-3.7.0-M11.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/chill-java-0.10.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/okhttp-3.12.12.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arpack-3.0.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-common-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-launcher_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/gson-2.2.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/rocksdbjni-8.3.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/HikariCP-2.5.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-codec-http2-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/mesos-1.4.3-shaded-protobuf.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-policy-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-codec-socks-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hk2-locator-2.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/py4j-0.10.9.7.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-storageclass-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-module-scala_2.12-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.xml.bind-api-2.3.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-apiextensions-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-core-asl-1.9.13.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-common-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-handler-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/orc-core-1.9.4-shaded-protobuf.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/snappy-java-1.1.10.5.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/minlog-1.3.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-native-unix-common-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-metastore-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/flatbuffers-java-1.12.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/snakeyaml-engine-2.6.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-tags_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-native-kqueue-4.1.96.Final-osx-x86_64.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/guava-14.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-container-servlet-core-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-collection-compat_2.12-2.7.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spire_2.12-0.17.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-unsafe_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-flowcontrol-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/conf":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jackson-core-2.15.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/janino-3.1.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-service-rpc-3.1.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hk2-utils-2.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-math3-3.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-mesos_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/zookeeper-3.6.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-events-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-core_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-lang-2.6.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/arrow-vector-12.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jsr305-3.0.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/opencsv-2.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-resource-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/httpclient-4.5.14.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/javax.jdo-3.2.0-m3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/datanucleus-api-jdo-4.2.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/compress-lzf-1.1.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/metrics-core-4.2.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/metrics-jmx-4.2.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/orc-shims-1.9.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-compiler-3.1.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/lapack-3.0.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-hadoop-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/univocity-parsers-2.9.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jaxb-runtime-2.3.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/zjsonpatch-0.3.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-text-1.10.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/threeten-extra-1.7.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-server-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-hk2-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-admissionregistration-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hadoop-yarn-server-web-proxy-3.3.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/libthrift-0.12.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-transport-native-epoll-4.1.96.Final-linux-x86_64.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-cli-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-node-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-collections-3.2.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/curator-client-2.13.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-xml_2.12-2.1.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/metrics-jvm-4.2.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-autoscaling-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-network-common_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/breeze-macros_2.12-2.1.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-graphx_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hadoop-client-runtime-3.3.4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/zstd-jni-1.5.5-4.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-sketch_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-httpclient-okhttp-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-reflect-2.12.18.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-common-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-column-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/super-csv-2.2.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spire-util_2.12-0.17.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/osgi-resource-locator-1.0.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-common-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/aopalliance-repackaged-2.6.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/avro-1.11.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/slf4j-api-2.0.7.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-llap-common-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-compiler-2.12.18.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-codec-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-discovery-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/scala-library-2.12.18.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-batch-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-hive_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/joda-time-2.12.5.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/chill_2.12-0.10.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-kubernetes_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-serde-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-beeline-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/avro-ipc-1.11.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/spark-sql-api_2.12-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jakarta.servlet-api-4.0.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/stax-api-1.0.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-resolver-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-coordination-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/bonecp-0.8.0.RELEASE.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/log4j-slf4j2-impl-2.20.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/netty-buffer-4.1.96.Final.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/avro-mapred-1.11.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-scheduling-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/derby-10.14.2.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/antlr-runtime-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/log4j-core-2.20.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/metrics-json-4.2.19.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/parquet-jackson-1.13.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/libfb303-0.9.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/annotations-17.0.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/RoaringBitmap-0.9.45.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hive-jdbc-2.3.9.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/hadoop-shaded-guava-1.1.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/blas-3.0.3.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/ivy-2.5.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/xbean-asm9-shaded-4.23.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/logging-interceptor-3.12.12.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/tink-1.9.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/kubernetes-model-extensions-6.7.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/commons-lang3-3.12.0.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jersey-container-servlet-2.40.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/JTransforms-3.1.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jodd-core-3.5.2.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/oro-2.0.8.jar":"System Classpath","/home/lol/miniconda3/lib/python3.12/site-packages/pyspark/jars/jline-2.14.6.jar":"System Classpath"}}
{"Event":"SparkListenerApplicationStart","App Name":"appMetrics","App ID":"local-1747830507045","Timestamp":1747830506050,"User":"lol"}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":0,"rootExecutionId":0,"description":"csv at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","physicalPlanDescription":"== Physical Plan ==\nCollectLimit (3)\n+- * Filter (2)\n   +- Scan text  (1)\n\n\n(1) Scan text \nOutput [1]: [value#0]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nReadSchema: struct<value:string>\n\n(2) Filter [codegen id : 1]\nInput [1]: [value#0]\nCondition : (length(trim(value#0, None)) > 0)\n\n(3) CollectLimit\nInput [1]: [value#0]\nArguments: 1\n\n","sparkPlanInfo":{"nodeName":"CollectLimit","simpleString":"CollectLimit 1","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (length(trim(value#0, None)) > 0)","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan text ","simpleString":"FileScan text [value#0] Batched: false, DataFilters: [(length(trim(value#0, None)) > 0)], Format: Text, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<value:string>","Format":"Text","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[(length(trim(value#0, None)) > 0)]"},"metrics":[{"name":"number of output rows","accumulatorId":23,"metricType":"sum"},{"name":"number of files read","accumulatorId":24,"metricType":"sum"},{"name":"metadata time","accumulatorId":25,"metricType":"timing"},{"name":"size of files read","accumulatorId":26,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":22,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":21,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":19,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":13,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":20,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":14,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":11,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":8,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":17,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":10,"metricType":"sum"},{"name":"records read","accumulatorId":7,"metricType":"sum"},{"name":"local bytes read","accumulatorId":5,"metricType":"size"},{"name":"fetch wait time","accumulatorId":6,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":3,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":9,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":12,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":15,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":16,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":4,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":18,"metricType":"size"}]},"time":1747830510588,"modifiedConfigs":{"spark.sql.session.timeZone":"Asia/Hong_Kong"},"jobTags":[]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":0,"accumUpdates":[[24,1],[25,7],[26,566316442]]}
{"Event":"SparkListenerJobStart","Job ID":0,"Submission Time":1747830512485,"Stage Infos":[{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[0],"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.sql.execution.id":"0","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"0","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830512501,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.sql.execution.id":"0","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"0","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":0,"Stage Attempt ID":0,"Task Info":{"Task ID":0,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830512621,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":0,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":0,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830512621,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830512904,"Failed":false,"Killed":false,"Accumulables":[{"ID":22,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":23,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":27,"Name":"internal.metrics.executorDeserializeTime","Update":78,"Value":78,"Internal":true,"Count Failed Values":true},{"ID":28,"Name":"internal.metrics.executorDeserializeCpuTime","Update":71519800,"Value":71519800,"Internal":true,"Count Failed Values":true},{"ID":29,"Name":"internal.metrics.executorRunTime","Update":148,"Value":148,"Internal":true,"Count Failed Values":true},{"ID":30,"Name":"internal.metrics.executorCpuTime","Update":120459700,"Value":120459700,"Internal":true,"Count Failed Values":true},{"ID":31,"Name":"internal.metrics.resultSize","Update":1674,"Value":1674,"Internal":true,"Count Failed Values":true},{"ID":33,"Name":"internal.metrics.resultSerializationTime","Update":5,"Value":5,"Internal":true,"Count Failed Values":true},{"ID":58,"Name":"internal.metrics.input.bytesRead","Update":65536,"Value":65536,"Internal":true,"Count Failed Values":true},{"ID":59,"Name":"internal.metrics.input.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":78,"Executor Deserialize CPU Time":71519800,"Executor Run Time":148,"Executor CPU Time":120459700,"Peak Execution Memory":0,"Result Size":1674,"JVM GC Time":0,"Result Serialization Time":5,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":65536,"Records Read":1},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830512501,"Completion Time":1747830512913,"Accumulables":[{"ID":22,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":23,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":27,"Name":"internal.metrics.executorDeserializeTime","Value":78,"Internal":true,"Count Failed Values":true},{"ID":28,"Name":"internal.metrics.executorDeserializeCpuTime","Value":71519800,"Internal":true,"Count Failed Values":true},{"ID":29,"Name":"internal.metrics.executorRunTime","Value":148,"Internal":true,"Count Failed Values":true},{"ID":30,"Name":"internal.metrics.executorCpuTime","Value":120459700,"Internal":true,"Count Failed Values":true},{"ID":31,"Name":"internal.metrics.resultSize","Value":1674,"Internal":true,"Count Failed Values":true},{"ID":33,"Name":"internal.metrics.resultSerializationTime","Value":5,"Internal":true,"Count Failed Values":true},{"ID":58,"Name":"internal.metrics.input.bytesRead","Value":65536,"Internal":true,"Count Failed Values":true},{"ID":59,"Name":"internal.metrics.input.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":0,"Completion Time":1747830512921,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":0,"time":1747830512961,"errorMessage":""}
{"Event":"SparkListenerJobStart","Job ID":1,"Submission Time":1747830513140,"Stage Infos":[{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[1],"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"13\",\"name\":\"aggregate\"}","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830513143,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"13\",\"name\":\"aggregate\"}","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":1,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830513170,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":2,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830513170,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":3,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830513171,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":4,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":5,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":6,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":7,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830513173,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":8,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830513173,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":3,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830513171,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519002,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259254","Value":"1259254","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":37,"Value":37,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":21506600,"Value":21506600,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":5775,"Value":5775,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3289561500,"Value":3289561500,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1730,"Value":1730,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":132,"Value":132,"Internal":true,"Count Failed Values":true},{"ID":72,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":71434240,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":1259254,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":37,"Executor Deserialize CPU Time":21506600,"Executor Run Time":5775,"Executor CPU Time":3289561500,"Peak Execution Memory":0,"Result Size":1730,"JVM GC Time":132,"Result Serialization Time":3,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":6,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519025,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259240","Value":"2518494","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":31,"Value":68,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12797900,"Value":34304500,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":5801,"Value":11576,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3396635300,"Value":6686196800,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1687,"Value":3417,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":132,"Value":264,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":142868480,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":2518494,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":31,"Executor Deserialize CPU Time":12797900,"Executor Run Time":5801,"Executor CPU Time":3396635300,"Peak Execution Memory":0,"Result Size":1687,"JVM GC Time":132,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":8,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830513173,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519257,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1185193","Value":"3703687","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":90,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":10055200,"Value":44359700,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6038,"Value":17614,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3204311700,"Value":9890508500,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1687,"Value":5104,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":138,"Value":402,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":3703687,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":10055200,"Executor Run Time":6038,"Executor CPU Time":3204311700,"Peak Execution Memory":0,"Result Size":1687,"JVM GC Time":138,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":7,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830513173,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519630,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259260","Value":"4962947","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":21,"Value":111,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12974300,"Value":57334000,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6408,"Value":24022,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3305627500,"Value":13196136000,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1730,"Value":6834,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":140,"Value":542,"Internal":true,"Count Failed Values":true},{"ID":72,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":4962947,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":21,"Executor Deserialize CPU Time":12974300,"Executor Run Time":6408,"Executor CPU Time":3305627500,"Peak Execution Memory":0,"Result Size":1730,"JVM GC Time":140,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":4,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519635,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259279","Value":"6222226","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":34,"Value":145,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":17001400,"Value":74335400,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6409,"Value":30431,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3305898000,"Value":16502034000,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1687,"Value":8521,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":140,"Value":682,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":6222226,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":34,"Executor Deserialize CPU Time":17001400,"Executor Run Time":6409,"Executor CPU Time":3305898000,"Peak Execution Memory":0,"Result Size":1687,"JVM GC Time":140,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":2,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830513170,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519655,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259294","Value":"7481520","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":33,"Value":178,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":15883400,"Value":90218800,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6438,"Value":36869,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3355370300,"Value":19857404300,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1687,"Value":10208,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":140,"Value":822,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":7481520,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":33,"Executor Deserialize CPU Time":15883400,"Executor Run Time":6438,"Executor CPU Time":3355370300,"Peak Execution Memory":0,"Result Size":1687,"JVM GC Time":140,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":1,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830513170,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519686,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259232","Value":"8740752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":37,"Value":215,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":16348000,"Value":106566800,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6460,"Value":43329,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3391196900,"Value":23248601200,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1687,"Value":11895,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":140,"Value":962,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259232,"Value":8740752,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":37,"Executor Deserialize CPU Time":16348000,"Executor Run Time":6460,"Executor CPU Time":3391196900,"Peak Execution Memory":0,"Result Size":1687,"JVM GC Time":140,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259232},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":5,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830513172,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830519727,"Failed":false,"Killed":false,"Accumulables":[{"ID":62,"Name":"number of output rows","Update":"1259249","Value":"10000001","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Update":33,"Value":248,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Update":24240300,"Value":130807100,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Update":6504,"Value":49833,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Update":3415624200,"Value":26664225400,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Update":1730,"Value":13625,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Update":143,"Value":1105,"Internal":true,"Count Failed Values":true},{"ID":72,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":10000001,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":33,"Executor Deserialize CPU Time":24240300,"Executor Run Time":6504,"Executor CPU Time":3415624200,"Peak Execution Memory":0,"Result Size":1730,"JVM GC Time":143,"Result Serialization Time":3,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:538)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830513143,"Completion Time":1747830519729,"Accumulables":[{"ID":62,"Name":"number of output rows","Value":"10000001","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":66,"Name":"internal.metrics.executorDeserializeTime","Value":248,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.executorDeserializeCpuTime","Value":130807100,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.executorRunTime","Value":49833,"Internal":true,"Count Failed Values":true},{"ID":69,"Name":"internal.metrics.executorCpuTime","Value":26664225400,"Internal":true,"Count Failed Values":true},{"ID":70,"Name":"internal.metrics.resultSize","Value":13625,"Internal":true,"Count Failed Values":true},{"ID":71,"Name":"internal.metrics.jvmGCTime","Value":1105,"Internal":true,"Count Failed Values":true},{"ID":72,"Name":"internal.metrics.resultSerializationTime","Value":7,"Internal":true,"Count Failed Values":true},{"ID":97,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":98,"Name":"internal.metrics.input.recordsRead","Value":10000001,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":1,"Completion Time":1747830519730,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"SparkListenerJobStart","Job ID":2,"Submission Time":1747830520522,"Stage Infos":[{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":14,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[13],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"23\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[2],"Properties":{"spark.rdd.scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":14,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[13],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"23\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830520528,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.rdd.scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":9,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830520551,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":10,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830520553,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":11,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830520554,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":12,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830520555,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":13,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830520556,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":14,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830520556,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":15,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830520557,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":16,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830520557,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":14,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830520556,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538090,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259209","Value":"1259209","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259240","Value":"1259240","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4139","Value":"4139","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18425","Value":"18425","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259240","Value":"1259240","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92678720","Value":"92678720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26416951","Value":"26416951","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259209","Value":"1259209","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"282065378","Value":"282065378","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":20,"Value":20,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12151300,"Value":12151300,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18698,"Value":18698,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11702073600,"Value":11702073600,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":2759,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":356,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":11,"Value":11,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":39845584,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11674538,"Value":11674538,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26416951,"Value":26416951,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":1259209,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":282065378,"Value":282065378,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":71434240,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":1259240,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":20,"Executor Deserialize CPU Time":12151300,"Executor Run Time":18698,"Executor CPU Time":11702073600,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":11,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11674538,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26416951,"Shuffle Write Time":282065378,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":10,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830520553,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538093,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259268","Value":"2518477","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259294","Value":"2518534","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4664","Value":"8803","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18346","Value":"36771","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259294","Value":"2518534","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92679936","Value":"185358656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26424562","Value":"52841513","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259268","Value":"2518477","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"331325151","Value":"613390529","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":33,"Value":53,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":14844900,"Value":26996200,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18691,"Value":37389,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11604751800,"Value":23306825400,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":5518,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":712,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":9,"Value":20,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11669024,"Value":23343562,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26424562,"Value":52841513,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259268,"Value":2518477,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":331325151,"Value":613390529,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":142868480,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":2518534,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":33,"Executor Deserialize CPU Time":14844900,"Executor Run Time":18691,"Executor CPU Time":11604751800,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":9,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669024,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26424562,"Shuffle Write Time":331325151,"Shuffle Records Written":1259268},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":16,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830520557,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538096,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1185174","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1185193","Value":"3703727","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4613","Value":"13416","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18499","Value":"55270","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1185193","Value":"3703727","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"87233432","Value":"272592088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"24894639","Value":"77736152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1185174","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"249904682","Value":"863295211","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":21,"Value":74,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":11096900,"Value":38093100,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18694,"Value":56083,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11458404800,"Value":34765230200,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":8277,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":1068,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":17,"Value":37,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":119536752,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11670212,"Value":35013774,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":24894639,"Value":77736152,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1185174,"Value":3703651,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":249904682,"Value":863295211,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":3703727,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":21,"Executor Deserialize CPU Time":11096900,"Executor Run Time":18694,"Executor CPU Time":11458404800,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":17,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670212,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":24894639,"Shuffle Write Time":249904682,"Shuffle Records Written":1185174},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":13,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830520556,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538096,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259223","Value":"4962874","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259249","Value":"4962976","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4839","Value":"18255","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18448","Value":"73718","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259249","Value":"4962976","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92684000","Value":"365276088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26415198","Value":"104151350","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259223","Value":"4962874","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"263479763","Value":"1126774974","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":96,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":10195800,"Value":48288900,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18693,"Value":74776,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11625423700,"Value":46390653900,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":11036,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":1424,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":32,"Value":69,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11669904,"Value":46683678,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415198,"Value":104151350,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259223,"Value":4962874,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":263479763,"Value":1126774974,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":4962976,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":10195800,"Executor Run Time":18693,"Executor CPU Time":11625423700,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":32,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669904,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415198,"Shuffle Write Time":263479763,"Shuffle Records Written":1259223},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":15,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830520557,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538097,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259237","Value":"6222111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259260","Value":"6222236","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4645","Value":"22900","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18328","Value":"92046","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259260","Value":"6222236","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92680248","Value":"457956336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26417633","Value":"130568983","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259237","Value":"6222111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"393023695","Value":"1519798669","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":24,"Value":120,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":18402700,"Value":66691600,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18692,"Value":93468,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11590821700,"Value":57981475600,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":13795,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":1780,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":17,"Value":86,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":199227920,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11669508,"Value":58353186,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26417633,"Value":130568983,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259237,"Value":6222111,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":393023695,"Value":1519798669,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":6222236,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":24,"Executor Deserialize CPU Time":18402700,"Executor Run Time":18692,"Executor CPU Time":11590821700,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":17,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669508,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26417633,"Shuffle Write Time":393023695,"Shuffle Records Written":1259237},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":12,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830520555,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538097,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259254","Value":"7481365","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259279","Value":"7481515","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4762","Value":"27662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18466","Value":"110512","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259279","Value":"7481515","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92680632","Value":"550636968","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26414963","Value":"156983946","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259254","Value":"7481365","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"283672535","Value":"1803471204","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":23,"Value":143,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":11868700,"Value":78560300,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18741,"Value":112209,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11523476800,"Value":69504952400,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2716,"Value":16511,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":2136,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11667727,"Value":70020913,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26414963,"Value":156983946,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259254,"Value":7481365,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":283672535,"Value":1803471204,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":7481515,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":23,"Executor Deserialize CPU Time":11868700,"Executor Run Time":18741,"Executor CPU Time":11523476800,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":356,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11667727,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26414963,"Shuffle Write Time":283672535,"Shuffle Records Written":1259254},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":11,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830520554,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538097,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259233","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259254","Value":"8740769","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4406","Value":"32068","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18380","Value":"128892","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259254","Value":"8740769","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92682784","Value":"643319752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26420936","Value":"183404882","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259233","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"339050370","Value":"2142521574","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":165,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":18748800,"Value":97309100,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18694,"Value":130903,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11063549200,"Value":80568501600,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":19270,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":2492,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":29,"Value":115,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":278919088,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11670787,"Value":81691700,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26420936,"Value":183404882,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259233,"Value":8740598,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":339050370,"Value":2142521574,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":8740769,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":18748800,"Executor Run Time":18694,"Executor CPU Time":11063549200,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":29,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670787,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26420936,"Shuffle Write Time":339050370,"Shuffle Records Written":1259233},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":9,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830520551,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830538098,"Failed":false,"Killed":false,"Accumulables":[{"ID":101,"Name":"number of output rows","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Update":"1259231","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Update":"4384","Value":"36452","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Update":"18295","Value":"147187","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Update":"1259231","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Update":"92680320","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Update":"26415883","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Update":"305900464","Value":"2448422038","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Update":20,"Value":185,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Update":15773300,"Value":113082400,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Update":18693,"Value":149596,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Update":11774945100,"Value":92343446700,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Update":2759,"Value":22029,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Update":356,"Value":2848,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Update":17,"Value":132,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Update":11670288,"Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415883,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Update":305900464,"Value":2448422038,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Update":1259231,"Value":10000000,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":857071184,"JVMOffHeapMemory":159490184,"OnHeapExecutionMemory":452982400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":292571,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":453274971,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421377,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":143,"MinorGCTime":551,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":551},"Task Metrics":{"Executor Deserialize Time":20,"Executor Deserialize CPU Time":15773300,"Executor Run Time":18693,"Executor CPU Time":11774945100,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":356,"Result Serialization Time":17,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670288,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415883,"Shuffle Write Time":305900464,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259231},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":14,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[13],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"23\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830520528,"Completion Time":1747830538112,"Accumulables":[{"ID":101,"Name":"number of output rows","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":102,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":103,"Name":"sort time","Value":"36452","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":104,"Name":"peak memory","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":105,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":106,"Name":"duration","Value":"147187","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":107,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":111,"Name":"data size","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":130,"Name":"shuffle bytes written","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":131,"Name":"shuffle records written","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":132,"Name":"shuffle write time","Value":"2448422038","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":133,"Name":"internal.metrics.executorDeserializeTime","Value":185,"Internal":true,"Count Failed Values":true},{"ID":134,"Name":"internal.metrics.executorDeserializeCpuTime","Value":113082400,"Internal":true,"Count Failed Values":true},{"ID":135,"Name":"internal.metrics.executorRunTime","Value":149596,"Internal":true,"Count Failed Values":true},{"ID":136,"Name":"internal.metrics.executorCpuTime","Value":92343446700,"Internal":true,"Count Failed Values":true},{"ID":137,"Name":"internal.metrics.resultSize","Value":22029,"Internal":true,"Count Failed Values":true},{"ID":138,"Name":"internal.metrics.jvmGCTime","Value":2848,"Internal":true,"Count Failed Values":true},{"ID":139,"Name":"internal.metrics.resultSerializationTime","Value":132,"Internal":true,"Count Failed Values":true},{"ID":140,"Name":"internal.metrics.memoryBytesSpilled","Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":141,"Name":"internal.metrics.diskBytesSpilled","Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":142,"Name":"internal.metrics.peakExecutionMemory","Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":161,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":162,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":163,"Name":"internal.metrics.shuffle.write.writeTime","Value":2448422038,"Internal":true,"Count Failed Values":true},{"ID":164,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":165,"Name":"internal.metrics.input.recordsRead","Value":10000000,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":2,"Completion Time":1747830538125,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"SparkListenerJobStart","Job ID":3,"Submission Time":1747830538537,"Stage Infos":[{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":3,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"ShuffledRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":3,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":14,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"Exchange\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[13],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"23\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"Scan csv \"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":4,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"DeserializeToObject\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"34\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"29\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"AQEShuffleRead\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitions\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[20],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":20,"Name":"SQLExecutionRDD","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[3],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[5,3,4],"Properties":{"spark.rdd.scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":4,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"DeserializeToObject\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"34\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"29\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"AQEShuffleRead\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitions\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[20],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":20,"Name":"SQLExecutionRDD","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[3],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830538565,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.rdd.scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":17,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830538610,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":18,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830538612,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":19,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":20,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":21,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":22,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":23,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":24,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":4,"Stage Attempt ID":0,"Task Info":{"Task ID":25,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830544994,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":23,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830544997,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25190770","Value":"25190770","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1200749","Value":"1200749","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1200576","Value":"1200576","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"3730","Value":"3730","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1200576","Value":"1200576","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1153","Value":"1153","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6069","Value":"6069","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":48,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":23298300,"Value":23298300,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6311,"Value":6311,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4289322500,"Value":4289322500,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5074,"Value":5074,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":281,"Internal":true,"Count Failed Values":true},{"ID":184,"Name":"internal.metrics.resultSerializationTime","Update":13,"Value":13,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21290127,"Value":21290127,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":56624544,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25190770,"Value":25190770,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200749,"Value":1200749,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":824,"Value":824,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":1727565,"Value":1727565,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":48,"Executor Deserialize CPU Time":23298300,"Executor Run Time":6311,"Executor CPU Time":4289322500,"Peak Execution Memory":56624544,"Result Size":5074,"JVM GC Time":281,"Result Serialization Time":13,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290127,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25190770,"Total Records Read":1200749,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":824,"Shuffle Write Time":1727565,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":19,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545009,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25206453","Value":"50397223","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1200985","Value":"2401734","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1200824","Value":"2401400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"3864","Value":"7594","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1200824","Value":"2401400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1164","Value":"2317","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6204","Value":"12273","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":49,"Value":97,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":20290400,"Value":43588700,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6311,"Value":12622,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4585764300,"Value":8875086800,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5074,"Value":10148,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":562,"Internal":true,"Count Failed Values":true},{"ID":184,"Name":"internal.metrics.resultSerializationTime","Update":13,"Value":26,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21295373,"Value":42585500,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":113249088,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25206453,"Value":50397223,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200985,"Value":2401734,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":839,"Value":1663,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":2,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":2026803,"Value":3754368,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":49,"Executor Deserialize CPU Time":20290400,"Executor Run Time":6311,"Executor CPU Time":4585764300,"Peak Execution Memory":56624544,"Result Size":5074,"JVM GC Time":281,"Result Serialization Time":13,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21295373,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25206453,"Total Records Read":1200985,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":839,"Shuffle Write Time":2026803,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":21,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545034,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25161841","Value":"75559064","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1199182","Value":"3600916","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1199024","Value":"3600424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"3879","Value":"11473","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1199024","Value":"3600424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1213","Value":"3530","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6218","Value":"18491","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":48,"Value":145,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":24087200,"Value":67675900,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6363,"Value":18985,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4589823600,"Value":13464910400,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":15179,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":843,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21288229,"Value":63873729,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624592,"Value":169873680,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25161841,"Value":75559064,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199182,"Value":3600916,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":856,"Value":2519,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":72928,"Value":3827296,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":48,"Executor Deserialize CPU Time":24087200,"Executor Run Time":6363,"Executor CPU Time":4589823600,"Peak Execution Memory":56624592,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21288229,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25161841,"Total Records Read":1199182,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":856,"Shuffle Write Time":72928,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":17,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830538610,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545171,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25164830","Value":"100723894","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1199495","Value":"4800411","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1199339","Value":"4799763","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"4041","Value":"15514","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1199339","Value":"4799763","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1154","Value":"4684","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6381","Value":"24872","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":49,"Value":194,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":21766700,"Value":89442600,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6500,"Value":25485,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4981844500,"Value":18446754900,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":20210,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":1124,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21293776,"Value":85167505,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":226498224,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25164830,"Value":100723894,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199495,"Value":4800411,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":842,"Value":3361,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":66827,"Value":3894123,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":49,"Executor Deserialize CPU Time":21766700,"Executor Run Time":6500,"Executor CPU Time":4981844500,"Peak Execution Memory":56624544,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21293776,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25164830,"Total Records Read":1199495,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":842,"Shuffle Write Time":66827,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":24,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545230,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25194724","Value":"125918618","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1200793","Value":"6001204","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1200616","Value":"6000379","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"4126","Value":"19640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1200616","Value":"6000379","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1235","Value":"5919","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"398455840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6469","Value":"31341","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":49,"Value":243,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":23665400,"Value":113108000,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6562,"Value":32047,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4869746900,"Value":23316501800,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":25241,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":1405,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":398455840,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21290320,"Value":106457825,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":283122768,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25194724,"Value":125918618,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200793,"Value":6001204,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":841,"Value":4202,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":5,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":47475,"Value":3941598,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":49,"Executor Deserialize CPU Time":23665400,"Executor Run Time":6562,"Executor CPU Time":4869746900,"Peak Execution Memory":56624544,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290320,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25194724,"Total Records Read":1200793,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":841,"Shuffle Write Time":47475,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":20,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830538613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545242,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"25169910","Value":"151088528","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1199408","Value":"7200612","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1199236","Value":"7199615","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"4095","Value":"23735","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1199236","Value":"7199615","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1120","Value":"7039","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"478147008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6437","Value":"37778","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":48,"Value":291,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":26901500,"Value":140009500,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6575,"Value":38622,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4793272400,"Value":28109774200,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":30272,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":1686,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":478147008,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21291736,"Value":127749561,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":339747312,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25169910,"Value":151088528,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199408,"Value":7200612,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":843,"Value":5045,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":46331,"Value":3987929,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":48,"Executor Deserialize CPU Time":26901500,"Executor Run Time":6575,"Executor CPU Time":4793272400,"Peak Execution Memory":56624544,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21291736,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25169910,"Total Records Read":1199408,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":843,"Shuffle Write Time":46331,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":18,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830538612,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545258,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"56","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"26207403","Value":"177295931","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1249052","Value":"8449664","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1248877","Value":"8448492","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"4131","Value":"27866","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1248877","Value":"8448492","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1244","Value":"8283","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"557838176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6471","Value":"44249","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":48,"Value":339,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":23612800,"Value":163622300,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6591,"Value":45213,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4843761300,"Value":32953535500,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":35303,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":1967,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":557838176,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21298509,"Value":149048070,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624592,"Value":396371904,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26207403,"Value":177295931,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249052,"Value":8449664,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":861,"Value":5906,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":27365,"Value":4015294,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":48,"Executor Deserialize CPU Time":23612800,"Executor Run Time":6591,"Executor CPU Time":4843761300,"Peak Execution Memory":56624592,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21298509,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26207403,"Total Records Read":1249052,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":861,"Shuffle Write Time":27365,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":22,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830538614,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545310,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"26222736","Value":"203518667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"1249666","Value":"9699330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"1249467","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"4151","Value":"32017","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"1249467","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"1239","Value":"9522","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"79691168","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"6534","Value":"50783","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":48,"Value":387,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":25987100,"Value":189609400,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":6643,"Value":51856,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":4790179300,"Value":37743714800,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":40334,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":2248,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":21297671,"Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":56624544,"Value":452996448,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":64,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26222736,"Value":203518667,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249666,"Value":9699330,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":841,"Value":6747,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":38071,"Value":4053365,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":48,"Executor Deserialize CPU Time":25987100,"Executor Run Time":6643,"Executor CPU Time":4790179300,"Peak Execution Memory":56624544,"Result Size":5031,"JVM GC Time":281,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21297671,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26222736,"Total Records Read":1249666,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":841,"Shuffle Write Time":38071,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":4,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":25,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830544994,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545601,"Failed":false,"Killed":false,"Accumulables":[{"ID":114,"Name":"local blocks read","Update":"8","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Update":"6302098","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Update":"300477","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Update":"216","Value":"32233","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Update":"147","Value":"9669","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Update":"33554240","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Update":"0","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Update":"525","Value":"51308","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Update":36,"Value":423,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Update":14008300,"Value":203617700,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Update":551,"Value":52407,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Update":482275900,"Value":38225990700,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Update":5031,"Value":45365,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Update":12,"Value":2260,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Update":0,"Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Update":0,"Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Update":33556032,"Value":486552480,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":6302098,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Update":300477,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":855,"Value":7602,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Update":20852,"Value":4074217,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":520743384,"JVMOffHeapMemory":167200120,"OnHeapExecutionMemory":106954160,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":322106,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":107276266,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":194,"MinorGCTime":905,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":905},"Task Metrics":{"Executor Deserialize Time":36,"Executor Deserialize CPU Time":14008300,"Executor Run Time":551,"Executor CPU Time":482275900,"Peak Execution Memory":33556032,"Result Size":5031,"JVM GC Time":12,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":6302098,"Total Records Read":300477,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":855,"Shuffle Write Time":20852,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":4,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"DeserializeToObject\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"34\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"29\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"AQEShuffleRead\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitions\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[20],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"SortAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":20,"Name":"SQLExecutionRDD","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[3],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830538565,"Completion Time":1747830545602,"Accumulables":[{"ID":114,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":117,"Name":"local bytes read","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":118,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":119,"Name":"records read","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":169,"Name":"duration","Value":"32233","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":170,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":171,"Name":"sort time","Value":"9669","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":172,"Name":"peak memory","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":173,"Name":"spill size","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":174,"Name":"duration","Value":"51308","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":178,"Name":"internal.metrics.executorDeserializeTime","Value":423,"Internal":true,"Count Failed Values":true},{"ID":179,"Name":"internal.metrics.executorDeserializeCpuTime","Value":203617700,"Internal":true,"Count Failed Values":true},{"ID":180,"Name":"internal.metrics.executorRunTime","Value":52407,"Internal":true,"Count Failed Values":true},{"ID":181,"Name":"internal.metrics.executorCpuTime","Value":38225990700,"Internal":true,"Count Failed Values":true},{"ID":182,"Name":"internal.metrics.resultSize","Value":45365,"Internal":true,"Count Failed Values":true},{"ID":183,"Name":"internal.metrics.jvmGCTime","Value":2260,"Internal":true,"Count Failed Values":true},{"ID":184,"Name":"internal.metrics.resultSerializationTime","Value":26,"Internal":true,"Count Failed Values":true},{"ID":185,"Name":"internal.metrics.memoryBytesSpilled","Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.diskBytesSpilled","Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.peakExecutionMemory","Value":486552480,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":191,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":192,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":193,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":194,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":195,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":196,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":197,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":198,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":199,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":204,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":206,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":7602,"Internal":true,"Count Failed Values":true},{"ID":207,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9,"Internal":true,"Count Failed Values":true},{"ID":208,"Name":"internal.metrics.shuffle.write.writeTime","Value":4074217,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":3,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"ShuffledRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830545604,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.rdd.scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.scope.noOverride":"true"}}
{"Event":"SparkListenerTaskStart","Stage ID":5,"Stage Attempt ID":0,"Task Info":{"Task ID":26,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830545613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":5,"Stage Attempt ID":0,"Task Info":{"Task ID":27,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830545616,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":5,"Stage Attempt ID":0,"Task Info":{"Task ID":28,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830545617,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":5,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":27,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830545616,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545643,"Failed":false,"Killed":false,"Accumulables":[{"ID":213,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5839300,"Value":5839300,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.executorRunTime","Update":15,"Value":15,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.executorCpuTime","Update":11795700,"Value":11795700,"Internal":true,"Count Failed Values":true},{"ID":217,"Name":"internal.metrics.resultSize","Update":6709,"Value":6709,"Internal":true,"Count Failed Values":true},{"ID":220,"Name":"internal.metrics.memoryBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":221,"Name":"internal.metrics.diskBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":222,"Name":"internal.metrics.peakExecutionMemory","Update":2392,"Value":2392,"Internal":true,"Count Failed Values":true},{"ID":224,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":225,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":226,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":227,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":228,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":2558,"Value":2558,"Internal":true,"Count Failed Values":true},{"ID":229,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":230,"Name":"internal.metrics.shuffle.read.recordsRead","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":231,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":232,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":233,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":234,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":235,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":236,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":237,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":238,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":239,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":240,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":5839300,"Executor Run Time":15,"Executor CPU Time":11795700,"Peak Execution Memory":2392,"Result Size":6709,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":3,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":2558,"Total Records Read":3,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":5,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":28,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830545617,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545644,"Failed":false,"Killed":false,"Accumulables":[{"ID":213,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5448200,"Value":11287500,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.executorRunTime","Update":15,"Value":30,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.executorCpuTime","Update":10802800,"Value":22598500,"Internal":true,"Count Failed Values":true},{"ID":217,"Name":"internal.metrics.resultSize","Update":6379,"Value":13088,"Internal":true,"Count Failed Values":true},{"ID":220,"Name":"internal.metrics.memoryBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":221,"Name":"internal.metrics.diskBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":222,"Name":"internal.metrics.peakExecutionMemory","Update":2352,"Value":4744,"Internal":true,"Count Failed Values":true},{"ID":224,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":225,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":3,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":226,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":227,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":228,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":2535,"Value":5093,"Internal":true,"Count Failed Values":true},{"ID":229,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":230,"Name":"internal.metrics.shuffle.read.recordsRead","Update":3,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":231,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":232,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":233,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":234,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":235,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":236,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":237,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":238,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":239,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":240,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":5448200,"Executor Run Time":15,"Executor CPU Time":10802800,"Peak Execution Memory":2352,"Result Size":6379,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":3,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":2535,"Total Records Read":3,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":5,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":26,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830545613,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830545644,"Failed":false,"Killed":false,"Accumulables":[{"ID":213,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":18,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5444500,"Value":16732000,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.executorRunTime","Update":15,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.executorCpuTime","Update":9287200,"Value":31885700,"Internal":true,"Count Failed Values":true},{"ID":217,"Name":"internal.metrics.resultSize","Update":6709,"Value":19797,"Internal":true,"Count Failed Values":true},{"ID":220,"Name":"internal.metrics.memoryBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":221,"Name":"internal.metrics.diskBytesSpilled","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":222,"Name":"internal.metrics.peakExecutionMemory","Update":2352,"Value":7096,"Internal":true,"Count Failed Values":true},{"ID":224,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":225,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":3,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":226,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":227,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":228,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":2509,"Value":7602,"Internal":true,"Count Failed Values":true},{"ID":229,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":230,"Name":"internal.metrics.shuffle.read.recordsRead","Update":3,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":231,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":232,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":233,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":234,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":235,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":236,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":237,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":238,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":239,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":240,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":5444500,"Executor Run Time":15,"Executor CPU Time":9287200,"Peak Execution Memory":2352,"Result Size":6709,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":3,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":2509,"Total Records Read":3,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"approxQuantile at NativeMethodAccessorImpl.java:0","Number of Tasks":3,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"ShuffledRDD","Scope":"{\"id\":\"39\",\"name\":\"treeAggregate\"}","Callsite":"approxQuantile at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":3,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.DataFrameStatFunctions.approxQuantile(DataFrameStatFunctions.scala:115)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830545604,"Completion Time":1747830545646,"Accumulables":[{"ID":213,"Name":"internal.metrics.executorDeserializeTime","Value":18,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.executorDeserializeCpuTime","Value":16732000,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.executorRunTime","Value":45,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.executorCpuTime","Value":31885700,"Internal":true,"Count Failed Values":true},{"ID":217,"Name":"internal.metrics.resultSize","Value":19797,"Internal":true,"Count Failed Values":true},{"ID":220,"Name":"internal.metrics.memoryBytesSpilled","Value":0,"Internal":true,"Count Failed Values":true},{"ID":221,"Name":"internal.metrics.diskBytesSpilled","Value":0,"Internal":true,"Count Failed Values":true},{"ID":222,"Name":"internal.metrics.peakExecutionMemory","Value":7096,"Internal":true,"Count Failed Values":true},{"ID":224,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":225,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":9,"Internal":true,"Count Failed Values":true},{"ID":226,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":227,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":228,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":7602,"Internal":true,"Count Failed Values":true},{"ID":229,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":230,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9,"Internal":true,"Count Failed Values":true},{"ID":231,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":232,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":233,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":234,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":235,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":236,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":237,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":238,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":239,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":240,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":3,"Completion Time":1747830545647,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":1,"rootExecutionId":1,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (17)\n+- TakeOrderedAndProject (16)\n   +- HashAggregate (15)\n      +- Exchange (14)\n         +- HashAggregate (13)\n            +- HashAggregate (12)\n               +- Exchange (11)\n                  +- HashAggregate (10)\n                     +- Project (9)\n                        +- Filter (8)\n                           +- SortAggregate (7)\n                              +- Sort (6)\n                                 +- Exchange (5)\n                                    +- SortAggregate (4)\n                                       +- Sort (3)\n                                          +- Filter (2)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(3) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]\n\n(6) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(7) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(8) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(9) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(10) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(11) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]\n\n(12) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(13) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(14) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]\n\n(15) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(16) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(17) AdaptiveSparkPlan\nOutput [2]: [toprettystring(date)#156, toprettystring(dau)#157]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[date#79 ASC NULLS FIRST], output=[toprettystring(date)#156,toprettystring(dau)#157])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833)]"},"metrics":[{"name":"number of output rows","accumulatorId":368,"metricType":"sum"},{"name":"number of files read","accumulatorId":369,"metricType":"sum"},{"name":"metadata time","accumulatorId":370,"metricType":"timing"},{"name":"size of files read","accumulatorId":371,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":367,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":364,"metricType":"timing"},{"name":"peak memory","accumulatorId":365,"metricType":"size"},{"name":"spill size","accumulatorId":366,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":363,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":361,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":355,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":362,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":356,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":353,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":350,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":359,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":352,"metricType":"sum"},{"name":"records read","accumulatorId":349,"metricType":"sum"},{"name":"local bytes read","accumulatorId":347,"metricType":"size"},{"name":"fetch wait time","accumulatorId":348,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":345,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":351,"metricType":"sum"},{"name":"local blocks read","accumulatorId":344,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":354,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":343,"metricType":"sum"},{"name":"data size","accumulatorId":341,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":357,"metricType":"size"},{"name":"number of partitions","accumulatorId":342,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":358,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":346,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":360,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":338,"metricType":"timing"},{"name":"peak memory","accumulatorId":339,"metricType":"size"},{"name":"spill size","accumulatorId":340,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":337,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":336,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":332,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":333,"metricType":"timing"},{"name":"peak memory","accumulatorId":331,"metricType":"size"},{"name":"number of output rows","accumulatorId":330,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":335,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":334,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":328,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":322,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":329,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":323,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":320,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":317,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":326,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":319,"metricType":"sum"},{"name":"records read","accumulatorId":316,"metricType":"sum"},{"name":"local bytes read","accumulatorId":314,"metricType":"size"},{"name":"fetch wait time","accumulatorId":315,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":312,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":318,"metricType":"sum"},{"name":"local blocks read","accumulatorId":311,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":321,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":310,"metricType":"sum"},{"name":"data size","accumulatorId":308,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":324,"metricType":"size"},{"name":"number of partitions","accumulatorId":309,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":325,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":313,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":327,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":304,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":305,"metricType":"timing"},{"name":"peak memory","accumulatorId":303,"metricType":"size"},{"name":"number of output rows","accumulatorId":302,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":307,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":306,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":298,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":299,"metricType":"timing"},{"name":"peak memory","accumulatorId":297,"metricType":"size"},{"name":"number of output rows","accumulatorId":296,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":301,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":300,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":294,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":288,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":295,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":289,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":286,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":283,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":292,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":285,"metricType":"sum"},{"name":"records read","accumulatorId":282,"metricType":"sum"},{"name":"local bytes read","accumulatorId":280,"metricType":"size"},{"name":"fetch wait time","accumulatorId":281,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":278,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":284,"metricType":"sum"},{"name":"local blocks read","accumulatorId":277,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":287,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":276,"metricType":"sum"},{"name":"data size","accumulatorId":274,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":290,"metricType":"size"},{"name":"number of partitions","accumulatorId":275,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":291,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":279,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":293,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":270,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":271,"metricType":"timing"},{"name":"peak memory","accumulatorId":269,"metricType":"size"},{"name":"number of output rows","accumulatorId":268,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":273,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":272,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":266,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":260,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":267,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":261,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":258,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":255,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":264,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":257,"metricType":"sum"},{"name":"records read","accumulatorId":254,"metricType":"sum"},{"name":"local bytes read","accumulatorId":252,"metricType":"size"},{"name":"fetch wait time","accumulatorId":253,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":250,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":256,"metricType":"sum"},{"name":"local blocks read","accumulatorId":249,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":259,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":248,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":262,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":263,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":251,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":265,"metricType":"size"}]}],"metadata":{},"metrics":[]},"time":1747830546209,"modifiedConfigs":{"spark.sql.session.timeZone":"Asia/Hong_Kong"},"jobTags":[]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":1,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (33)\n+- == Current Plan ==\n   TakeOrderedAndProject (17)\n   +- HashAggregate (16)\n      +- Exchange (15)\n         +- HashAggregate (14)\n            +- HashAggregate (13)\n               +- Exchange (12)\n                  +- HashAggregate (11)\n                     +- Project (10)\n                        +- Filter (9)\n                           +- SortAggregate (8)\n                              +- Sort (7)\n                                 +- ShuffleQueryStage (6)\n                                    +- Exchange (5)\n                                       +- SortAggregate (4)\n                                          +- * Sort (3)\n                                             +- * Filter (2)\n                                                +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (32)\n   +- HashAggregate (31)\n      +- Exchange (30)\n         +- HashAggregate (29)\n            +- HashAggregate (28)\n               +- Exchange (27)\n                  +- HashAggregate (26)\n                     +- Project (25)\n                        +- Filter (24)\n                           +- SortAggregate (23)\n                              +- Sort (22)\n                                 +- Exchange (21)\n                                    +- SortAggregate (20)\n                                       +- Sort (19)\n                                          +- Filter (18)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: 0\n\n(7) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(8) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(9) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(10) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(11) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(12) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=230]\n\n(13) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(14) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(15) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=233]\n\n(16) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(17) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(18) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(19) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(20) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(21) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]\n\n(22) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(23) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(24) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(25) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(26) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(27) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]\n\n(28) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(29) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(30) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]\n\n(31) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(32) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(33) AdaptiveSparkPlan\nOutput [2]: [toprettystring(date)#156, toprettystring(dau)#157]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[date#79 ASC NULLS FIRST], output=[toprettystring(date)#156,toprettystring(dau)#157])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=233]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=230]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833)]"},"metrics":[{"name":"number of output rows","accumulatorId":368,"metricType":"sum"},{"name":"number of files read","accumulatorId":369,"metricType":"sum"},{"name":"metadata time","accumulatorId":370,"metricType":"timing"},{"name":"size of files read","accumulatorId":371,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":492,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":489,"metricType":"timing"},{"name":"peak memory","accumulatorId":490,"metricType":"size"},{"name":"spill size","accumulatorId":491,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":488,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":487,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":485,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":479,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":486,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":480,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":477,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":474,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":483,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":476,"metricType":"sum"},{"name":"records read","accumulatorId":473,"metricType":"sum"},{"name":"local bytes read","accumulatorId":471,"metricType":"size"},{"name":"fetch wait time","accumulatorId":472,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":469,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":475,"metricType":"sum"},{"name":"local blocks read","accumulatorId":468,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":478,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":467,"metricType":"sum"},{"name":"data size","accumulatorId":465,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":481,"metricType":"size"},{"name":"number of partitions","accumulatorId":466,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":482,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":470,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":484,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":462,"metricType":"timing"},{"name":"peak memory","accumulatorId":463,"metricType":"size"},{"name":"spill size","accumulatorId":464,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":461,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":460,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":456,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":457,"metricType":"timing"},{"name":"peak memory","accumulatorId":455,"metricType":"size"},{"name":"number of output rows","accumulatorId":454,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":459,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":458,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":452,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":446,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":453,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":447,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":444,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":441,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":450,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":443,"metricType":"sum"},{"name":"records read","accumulatorId":440,"metricType":"sum"},{"name":"local bytes read","accumulatorId":438,"metricType":"size"},{"name":"fetch wait time","accumulatorId":439,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":436,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":442,"metricType":"sum"},{"name":"local blocks read","accumulatorId":435,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":445,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":434,"metricType":"sum"},{"name":"data size","accumulatorId":432,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":448,"metricType":"size"},{"name":"number of partitions","accumulatorId":433,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":449,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":437,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":451,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":428,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":429,"metricType":"timing"},{"name":"peak memory","accumulatorId":427,"metricType":"size"},{"name":"number of output rows","accumulatorId":426,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":431,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":430,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":422,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":423,"metricType":"timing"},{"name":"peak memory","accumulatorId":421,"metricType":"size"},{"name":"number of output rows","accumulatorId":420,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":425,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":424,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":418,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":412,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":419,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":413,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":410,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":407,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":416,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":409,"metricType":"sum"},{"name":"records read","accumulatorId":406,"metricType":"sum"},{"name":"local bytes read","accumulatorId":404,"metricType":"size"},{"name":"fetch wait time","accumulatorId":405,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":402,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":408,"metricType":"sum"},{"name":"local blocks read","accumulatorId":401,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":411,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":400,"metricType":"sum"},{"name":"data size","accumulatorId":398,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":414,"metricType":"size"},{"name":"number of partitions","accumulatorId":399,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":415,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":403,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":417,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":394,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":395,"metricType":"timing"},{"name":"peak memory","accumulatorId":393,"metricType":"size"},{"name":"number of output rows","accumulatorId":392,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":397,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":396,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":390,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":384,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":391,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":385,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":382,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":379,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":388,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":381,"metricType":"sum"},{"name":"records read","accumulatorId":378,"metricType":"sum"},{"name":"local bytes read","accumulatorId":376,"metricType":"size"},{"name":"fetch wait time","accumulatorId":377,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":374,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":380,"metricType":"sum"},{"name":"local blocks read","accumulatorId":373,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":383,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":372,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":386,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":387,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":375,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":389,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[369,1],[370,1],[371,566316442]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[466,200]]}
{"Event":"SparkListenerJobStart","Job ID":4,"Submission Time":1747830546297,"Stage Infos":[{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[6],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830546300,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":29,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830546314,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":30,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830546315,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":31,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830546316,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":32,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830546316,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":33,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":34,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":35,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":36,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830546318,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":36,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830546318,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830557651,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1185193","Value":"1185193","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"87233432","Value":"87233432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"24894639","Value":"24894639","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1185174","Value":"1185174","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"145215902","Value":"145215902","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1185174","Value":"1185174","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"11158","Value":"11158","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2483","Value":"2483","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1185193","Value":"1185193","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5129600,"Value":5129600,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":11311,"Value":11311,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":7949529500,"Value":7949529500,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2759,"Value":2759,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":270,"Internal":true,"Count Failed Values":true},{"ID":499,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":39845584,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11670212,"Value":11670212,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":24894639,"Value":24894639,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1185174,"Value":1185174,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":145215902,"Value":145215902,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":67119541,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":1185193,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":5129600,"Executor Run Time":11311,"Executor CPU Time":7949529500,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":270,"Result Serialization Time":3,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670212,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":24894639,"Shuffle Write Time":145215902,"Shuffle Records Written":1185174},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":29,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830546314,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558192,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259231","Value":"2444424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92680320","Value":"179913752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26415883","Value":"51310522","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259209","Value":"2444383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"108945470","Value":"254161372","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259209","Value":"2444383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"11774","Value":"22932","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2819","Value":"5302","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259231","Value":"2444424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":17,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4272400,"Value":9402000,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":11860,"Value":23171,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8579837700,"Value":16529367200,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2759,"Value":5518,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":281,"Value":551,"Internal":true,"Count Failed Values":true},{"ID":499,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11670288,"Value":23340500,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415883,"Value":51310522,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":2444383,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":108945470,"Value":254161372,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":138553781,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259231,"Value":2444424,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":4272400,"Executor Run Time":11860,"Executor CPU Time":8579837700,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":281,"Result Serialization Time":3,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670288,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415883,"Shuffle Write Time":108945470,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259231},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":30,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830546315,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558466,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259294","Value":"3703718","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92679936","Value":"272593688","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26424562","Value":"77735084","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259268","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"178956307","Value":"433117679","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259268","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"11965","Value":"34897","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2586","Value":"7888","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259294","Value":"3703718","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":25,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":8277400,"Value":17679400,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12134,"Value":35305,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8396533800,"Value":24925901000,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":8234,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":838,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":119536752,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11669024,"Value":35009524,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26424562,"Value":77735084,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259268,"Value":3703651,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":178956307,"Value":433117679,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":3703718,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":8277400,"Executor Run Time":12134,"Executor CPU Time":8396533800,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669024,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26424562,"Shuffle Write Time":178956307,"Shuffle Records Written":1259268},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":33,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558503,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259249","Value":"4962967","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92684000","Value":"365277688","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26415198","Value":"104150282","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259223","Value":"4962874","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"133715174","Value":"566832853","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259223","Value":"4962874","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"12063","Value":"46960","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2617","Value":"10505","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259249","Value":"4962967","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":30,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3606400,"Value":21285800,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12174,"Value":47479,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8470899600,"Value":33396800600,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":10950,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1125,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11669904,"Value":46679428,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415198,"Value":104150282,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259223,"Value":4962874,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":133715174,"Value":566832853,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":4962967,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":3606400,"Executor Run Time":12174,"Executor CPU Time":8470899600,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669904,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415198,"Shuffle Write Time":133715174,"Shuffle Records Written":1259223},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":35,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558635,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259260","Value":"6222227","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92680248","Value":"457957936","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26417633","Value":"130567915","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259237","Value":"6222111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"124927084","Value":"691759937","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259237","Value":"6222111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"12182","Value":"59142","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2564","Value":"13069","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259260","Value":"6222227","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":37,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5768400,"Value":27054200,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12304,"Value":59783,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8424890000,"Value":41821690600,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":13666,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1412,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":199227920,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11669508,"Value":58348936,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26417633,"Value":130567915,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259237,"Value":6222111,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":124927084,"Value":691759937,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":6222227,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":5768400,"Executor Run Time":12304,"Executor CPU Time":8424890000,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669508,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26417633,"Shuffle Write Time":124927084,"Shuffle Records Written":1259237},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":31,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830546316,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558711,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259254","Value":"7481481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92682784","Value":"550640720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26420936","Value":"156988851","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259233","Value":"7481344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"147575259","Value":"839335196","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259233","Value":"7481344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"12232","Value":"71374","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2878","Value":"15947","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259254","Value":"7481481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":49,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4962400,"Value":32016600,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12375,"Value":72158,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8614885200,"Value":50436575800,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":16382,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1699,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11670787,"Value":70019723,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26420936,"Value":156988851,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259233,"Value":7481344,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":147575259,"Value":839335196,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":7481481,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":4962400,"Executor Run Time":12375,"Executor CPU Time":8614885200,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670787,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26420936,"Shuffle Write Time":147575259,"Shuffle Records Written":1259233},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":32,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830546316,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558729,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259279","Value":"8740760","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92680632","Value":"643321352","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26414963","Value":"183403814","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259254","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"102732467","Value":"942067663","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259254","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"12317","Value":"83691","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2888","Value":"18835","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259279","Value":"8740760","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":61,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5431100,"Value":37447700,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12394,"Value":84552,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8549186200,"Value":58985762000,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":19098,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1986,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":278919088,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11667727,"Value":81687450,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26414963,"Value":183403814,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259254,"Value":8740598,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":102732467,"Value":942067663,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":8740760,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":5431100,"Executor Run Time":12394,"Executor CPU Time":8549186200,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11667727,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26414963,"Shuffle Write Time":102732467,"Shuffle Records Written":1259254},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":34,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830546317,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830558788,"Failed":false,"Killed":false,"Accumulables":[{"ID":368,"Name":"number of output rows","Update":"1259240","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Update":"92678720","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Update":"26416951","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Update":"82527233","Value":"1024594896","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Update":"12393","Value":"96084","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Update":"2851","Value":"21686","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Update":"1259240","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Update":18,"Value":79,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5945900,"Value":43393600,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Update":12446,"Value":96998,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Update":8368273600,"Value":67354035600,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Update":2716,"Value":21814,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":2273,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Update":11674538,"Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26416951,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Update":82527233,"Value":1024594896,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":10000000,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":882312768,"JVMOffHeapMemory":173639160,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":246,"MinorGCTime":1088,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1088},"Task Metrics":{"Executor Deserialize Time":18,"Executor Deserialize CPU Time":5945900,"Executor Run Time":12446,"Executor CPU Time":8368273600,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11674538,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26416951,"Shuffle Write Time":82527233,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830546300,"Completion Time":1747830558790,"Accumulables":[{"ID":368,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"data size","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":484,"Name":"shuffle bytes written","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":485,"Name":"shuffle records written","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":486,"Name":"shuffle write time","Value":"1024594896","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":487,"Name":"number of output rows","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":488,"Name":"duration","Value":"96084","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":489,"Name":"sort time","Value":"21686","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":490,"Name":"peak memory","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":491,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":492,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":493,"Name":"internal.metrics.executorDeserializeTime","Value":79,"Internal":true,"Count Failed Values":true},{"ID":494,"Name":"internal.metrics.executorDeserializeCpuTime","Value":43393600,"Internal":true,"Count Failed Values":true},{"ID":495,"Name":"internal.metrics.executorRunTime","Value":96998,"Internal":true,"Count Failed Values":true},{"ID":496,"Name":"internal.metrics.executorCpuTime","Value":67354035600,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.resultSize","Value":21814,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.jvmGCTime","Value":2273,"Internal":true,"Count Failed Values":true},{"ID":499,"Name":"internal.metrics.resultSerializationTime","Value":6,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.memoryBytesSpilled","Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.diskBytesSpilled","Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":502,"Name":"internal.metrics.peakExecutionMemory","Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.write.writeTime","Value":1024594896,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.input.recordsRead","Value":10000000,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":4,"Completion Time":1747830558792,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":1,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (35)\n+- == Current Plan ==\n   TakeOrderedAndProject (19)\n   +- HashAggregate (18)\n      +- Exchange (17)\n         +- HashAggregate (16)\n            +- HashAggregate (15)\n               +- ShuffleQueryStage (14)\n                  +- Exchange (13)\n                     +- * HashAggregate (12)\n                        +- * Project (11)\n                           +- * Filter (10)\n                              +- SortAggregate (9)\n                                 +- * Sort (8)\n                                    +- AQEShuffleRead (7)\n                                       +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                          +- Exchange (5)\n                                             +- SortAggregate (4)\n                                                +- * Sort (3)\n                                                   +- * Filter (2)\n                                                      +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (34)\n   +- HashAggregate (33)\n      +- Exchange (32)\n         +- HashAggregate (31)\n            +- HashAggregate (30)\n               +- Exchange (29)\n                  +- HashAggregate (28)\n                     +- Project (27)\n                        +- Filter (26)\n                           +- SortAggregate (25)\n                              +- Sort (24)\n                                 +- Exchange (23)\n                                    +- SortAggregate (22)\n                                       +- Sort (21)\n                                          +- Filter (20)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#160, user_id#17]\nArguments: 1\n\n(15) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(16) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(17) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=316]\n\n(18) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(19) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(20) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(21) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(22) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(23) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]\n\n(24) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(26) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(27) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(28) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(29) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]\n\n(30) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(31) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(32) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(34) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(35) AdaptiveSparkPlan\nOutput [2]: [toprettystring(date)#156, toprettystring(dau)#157]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[date#79 ASC NULLS FIRST], output=[toprettystring(date)#156,toprettystring(dau)#157])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=316]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833)]"},"metrics":[{"name":"number of output rows","accumulatorId":368,"metricType":"sum"},{"name":"number of files read","accumulatorId":369,"metricType":"sum"},{"name":"metadata time","accumulatorId":370,"metricType":"timing"},{"name":"size of files read","accumulatorId":371,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":492,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":489,"metricType":"timing"},{"name":"peak memory","accumulatorId":490,"metricType":"size"},{"name":"spill size","accumulatorId":491,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":488,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":487,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":485,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":479,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":486,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":480,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":477,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":474,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":483,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":476,"metricType":"sum"},{"name":"records read","accumulatorId":473,"metricType":"sum"},{"name":"local bytes read","accumulatorId":471,"metricType":"size"},{"name":"fetch wait time","accumulatorId":472,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":469,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":475,"metricType":"sum"},{"name":"local blocks read","accumulatorId":468,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":478,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":467,"metricType":"sum"},{"name":"data size","accumulatorId":465,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":481,"metricType":"size"},{"name":"number of partitions","accumulatorId":466,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":482,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":470,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":484,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":623,"metricType":"sum"},{"name":"partition data size","accumulatorId":624,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":625,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":620,"metricType":"timing"},{"name":"peak memory","accumulatorId":621,"metricType":"size"},{"name":"spill size","accumulatorId":622,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":619,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":618,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":617,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":613,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":614,"metricType":"timing"},{"name":"peak memory","accumulatorId":612,"metricType":"size"},{"name":"number of output rows","accumulatorId":611,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":616,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":615,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":610,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":608,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":602,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":609,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":603,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":600,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":597,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":606,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":599,"metricType":"sum"},{"name":"records read","accumulatorId":596,"metricType":"sum"},{"name":"local bytes read","accumulatorId":594,"metricType":"size"},{"name":"fetch wait time","accumulatorId":595,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":592,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":598,"metricType":"sum"},{"name":"local blocks read","accumulatorId":591,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":601,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":590,"metricType":"sum"},{"name":"data size","accumulatorId":588,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":604,"metricType":"size"},{"name":"number of partitions","accumulatorId":589,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":605,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":593,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":607,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":584,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":585,"metricType":"timing"},{"name":"peak memory","accumulatorId":583,"metricType":"size"},{"name":"number of output rows","accumulatorId":582,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":587,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":586,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":578,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":579,"metricType":"timing"},{"name":"peak memory","accumulatorId":577,"metricType":"size"},{"name":"number of output rows","accumulatorId":576,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":581,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":580,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":574,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":568,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":575,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":569,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":566,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":563,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":572,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":565,"metricType":"sum"},{"name":"records read","accumulatorId":562,"metricType":"sum"},{"name":"local bytes read","accumulatorId":560,"metricType":"size"},{"name":"fetch wait time","accumulatorId":561,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":558,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":564,"metricType":"sum"},{"name":"local blocks read","accumulatorId":557,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":567,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":556,"metricType":"sum"},{"name":"data size","accumulatorId":554,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":570,"metricType":"size"},{"name":"number of partitions","accumulatorId":555,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":571,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":559,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":573,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":550,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":551,"metricType":"timing"},{"name":"peak memory","accumulatorId":549,"metricType":"size"},{"name":"number of output rows","accumulatorId":548,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":553,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":552,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":546,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":540,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":547,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":541,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":538,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":535,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":544,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":537,"metricType":"sum"},{"name":"records read","accumulatorId":534,"metricType":"sum"},{"name":"local bytes read","accumulatorId":532,"metricType":"size"},{"name":"fetch wait time","accumulatorId":533,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":530,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":536,"metricType":"sum"},{"name":"local blocks read","accumulatorId":529,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":539,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":528,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":542,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":543,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":531,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":545,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[623,9],[625,9],[624,26025333],[624,27063086],[624,26026566],[624,26016692],[624,26040139],[624,27063086],[624,26040139],[624,26026566],[624,6491833]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[589,200]]}
{"Event":"SparkListenerJobStart","Job ID":5,"Submission Time":1747830558985,"Stage Infos":[{"Stage ID":7,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"64\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"69\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":31,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"73\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"70\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[7,8],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"64\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"69\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":31,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"73\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"70\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830558991,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":37,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830559001,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":38,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830559001,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":39,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":40,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":41,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":42,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":43,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":44,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":45,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830565903,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":41,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830565907,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25161841","Value":"25161841","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1199182","Value":"1199182","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16826448","Value":"16826448","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3572530","Value":"3572530","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350551","Value":"350551","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"63806977","Value":"63806977","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"4868","Value":"4868","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350551","Value":"350551","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"37748576","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"4424","Value":"4424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1199024","Value":"1199024","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1199024","Value":"1199024","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"6393","Value":"6393","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"1070","Value":"1070","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4363800,"Value":4363800,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":6857,"Value":6857,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5170334700,"Value":5170334700,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5928,"Value":5928,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":175,"Value":175,"Internal":true,"Count Failed Values":true},{"ID":632,"Name":"internal.metrics.resultSerializationTime","Update":17,"Value":17,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":96468288,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21860975,"Value":21860975,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":94371376,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25161841,"Value":25161841,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199182,"Value":1199182,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3572530,"Value":3572530,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350551,"Value":350551,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":63806977,"Value":63806977,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":4363800,"Executor Run Time":6857,"Executor CPU Time":5170334700,"Peak Execution Memory":94371376,"Result Size":5928,"JVM GC Time":175,"Result Serialization Time":17,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21860975,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25161841,"Total Records Read":1199182,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3572530,"Shuffle Write Time":63806977,"Shuffle Records Written":350551},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":38,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830559001,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566195,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"26207403","Value":"51369244","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1249052","Value":"2448234","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16911984","Value":"33738432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3587727","Value":"7160257","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"352333","Value":"702884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"73068748","Value":"136875725","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5194","Value":"10062","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"352333","Value":"702884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"75497152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"4814","Value":"9238","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1248877","Value":"2447901","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1248877","Value":"2447901","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"6793","Value":"13186","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"932","Value":"2002","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":14,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3962800,"Value":8326600,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7159,"Value":14016,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5374194200,"Value":10544528900,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5928,"Value":11856,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":205,"Value":380,"Internal":true,"Count Failed Values":true},{"ID":632,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":18,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":104856864,"Value":201325152,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":22057375,"Value":43918350,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":188742752,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26207403,"Value":51369244,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249052,"Value":2448234,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3587727,"Value":7160257,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":352333,"Value":702884,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":73068748,"Value":136875725,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":3962800,"Executor Run Time":7159,"Executor CPU Time":5374194200,"Peak Execution Memory":94371376,"Result Size":5928,"JVM GC Time":205,"Result Serialization Time":1,"Memory Bytes Spilled":104856864,"Disk Bytes Spilled":22057375,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26207403,"Total Records Read":1249052,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3587727,"Shuffle Write Time":73068748,"Shuffle Records Written":352333},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":44,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566223,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25194724","Value":"76563968","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1200793","Value":"3649027","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16833840","Value":"50572272","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3572335","Value":"10732592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350705","Value":"1053589","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"65500927","Value":"202376652","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5175","Value":"15237","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350705","Value":"1053589","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"113245728","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"4832","Value":"14070","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1200616","Value":"3648517","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1200616","Value":"3648517","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"6807","Value":"19993","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"1050","Value":"3052","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":19,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3411500,"Value":11738100,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7208,"Value":21224,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5258366000,"Value":15802894900,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5885,"Value":17741,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":216,"Value":596,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":297793440,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21872780,"Value":65791130,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":283114128,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25194724,"Value":76563968,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200793,"Value":3649027,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3572335,"Value":10732592,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350705,"Value":1053589,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":65500927,"Value":202376652,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":3411500,"Executor Run Time":7208,"Executor CPU Time":5258366000,"Peak Execution Memory":94371376,"Result Size":5885,"JVM GC Time":216,"Result Serialization Time":0,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21872780,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25194724,"Total Records Read":1200793,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3572335,"Shuffle Write Time":65500927,"Shuffle Records Written":350705},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":39,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566290,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25206453","Value":"101770421","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1200985","Value":"4850012","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16824096","Value":"67396368","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3571616","Value":"14304208","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350502","Value":"1404091","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"36222325","Value":"238598977","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5320","Value":"20557","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350502","Value":"1404091","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"150994304","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"5008","Value":"19078","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1200824","Value":"4849341","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1200824","Value":"4849341","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"6979","Value":"26972","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"987","Value":"4039","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":13,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7169700,"Value":18907800,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7269,"Value":28493,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5608886200,"Value":21411781100,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5885,"Value":23626,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":216,"Value":812,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":394261728,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21866721,"Value":87657851,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":377485504,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25206453,"Value":101770421,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200985,"Value":4850012,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3571616,"Value":14304208,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350502,"Value":1404091,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":36222325,"Value":238598977,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":13,"Executor Deserialize CPU Time":7169700,"Executor Run Time":7269,"Executor CPU Time":5608886200,"Peak Execution Memory":94371376,"Result Size":5885,"JVM GC Time":216,"Result Serialization Time":0,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21866721,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25206453,"Total Records Read":1200985,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3571616,"Shuffle Write Time":36222325,"Shuffle Records Written":350502},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":40,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830559002,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566299,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25169910","Value":"126940331","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1199408","Value":"6049420","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16818960","Value":"84215328","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3571402","Value":"17875610","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350395","Value":"1754486","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"30641874","Value":"269240851","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5330","Value":"25887","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350395","Value":"1754486","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"188742880","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"5057","Value":"24135","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"80","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1199236","Value":"6048577","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1199236","Value":"6048577","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"7034","Value":"34006","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"899","Value":"4938","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"398455840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":38,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4503400,"Value":23411200,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7284,"Value":35777,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5547860300,"Value":26959641400,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5928,"Value":29554,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":216,"Value":1028,"Internal":true,"Count Failed Values":true},{"ID":632,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":19,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":490730016,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21869065,"Value":109526916,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":471856880,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25169910,"Value":126940331,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199408,"Value":6049420,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3571402,"Value":17875610,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350395,"Value":1754486,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":30641874,"Value":269240851,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":4503400,"Executor Run Time":7284,"Executor CPU Time":5547860300,"Peak Execution Memory":94371376,"Result Size":5928,"JVM GC Time":216,"Result Serialization Time":1,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21869065,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25169910,"Total Records Read":1199408,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3571402,"Shuffle Write Time":30641874,"Shuffle Records Written":350395},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":42,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566327,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"26222736","Value":"153163067","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1249666","Value":"7299086","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16906992","Value":"101122320","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3585294","Value":"21460904","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"352229","Value":"2106715","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"23113688","Value":"292354539","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5262","Value":"31149","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"352229","Value":"2106715","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"226491456","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"5038","Value":"29173","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"96","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1249467","Value":"7298044","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1249467","Value":"7298044","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"7070","Value":"41076","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"997","Value":"5935","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"478147008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3927400,"Value":27338600,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7312,"Value":43089,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5379265600,"Value":32338907000,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5885,"Value":35439,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":216,"Value":1244,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":104856864,"Value":595586880,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":22050037,"Value":131576953,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":566228256,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26222736,"Value":153163067,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249666,"Value":7299086,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3585294,"Value":21460904,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":352229,"Value":2106715,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":23113688,"Value":292354539,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":3927400,"Executor Run Time":7312,"Executor CPU Time":5379265600,"Peak Execution Memory":94371376,"Result Size":5885,"JVM GC Time":216,"Result Serialization Time":0,"Memory Bytes Spilled":104856864,"Disk Bytes Spilled":22050037,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26222736,"Total Records Read":1249666,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3585294,"Shuffle Write Time":23113688,"Shuffle Records Written":352229},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":43,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830559003,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566364,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"56","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25190770","Value":"178353837","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1200749","Value":"8499835","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16831536","Value":"117953856","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3572158","Value":"25033062","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350657","Value":"2457372","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"24914508","Value":"317269047","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5397","Value":"36546","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350657","Value":"2457372","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"264240032","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"5137","Value":"34310","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"112","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1200576","Value":"8498620","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1200576","Value":"8498620","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"7113","Value":"48189","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"1020","Value":"6955","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"557838176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":50,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4681100,"Value":32019700,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7350,"Value":50439,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5561481800,"Value":37900388800,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5885,"Value":41324,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":216,"Value":1460,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":692055168,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21868265,"Value":153445218,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":660599632,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25190770,"Value":178353837,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200749,"Value":8499835,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3572158,"Value":25033062,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350657,"Value":2457372,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":24914508,"Value":317269047,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":4681100,"Executor Run Time":7350,"Executor CPU Time":5561481800,"Peak Execution Memory":94371376,"Result Size":5885,"JVM GC Time":216,"Result Serialization Time":0,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21868265,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25190770,"Total Records Read":1200749,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3572158,"Shuffle Write Time":24914508,"Shuffle Records Written":350657},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":37,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830559001,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830565451,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"25164830","Value":"203518667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"1199495","Value":"9699330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"16828080","Value":"134781936","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"3571691","Value":"28604753","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"350585","Value":"2807957","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"17914804","Value":"335183851","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"5580","Value":"42126","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"350585","Value":"2807957","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"37748576","Value":"301988608","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"5348","Value":"39658","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"128","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"1199339","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"1199339","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"7326","Value":"55515","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"975","Value":"7930","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"79691168","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2981300,"Value":35001000,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":7505,"Value":57944,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":5040156600,"Value":42940545400,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5928,"Value":47252,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":228,"Value":1688,"Internal":true,"Count Failed Values":true},{"ID":632,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":22,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Update":96468288,"Value":788523456,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Update":21875267,"Value":175320485,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":94371376,"Value":754971008,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":64,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25164830,"Value":203518667,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199495,"Value":9699330,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":3571691,"Value":28604753,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":350585,"Value":2807957,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":17914804,"Value":335183851,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":856631608,"JVMOffHeapMemory":174862672,"OnHeapExecutionMemory":352319744,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":332156,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":352651900,"OffHeapUnifiedMemory":0,"DirectPoolMemory":19955785,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":318,"MinorGCTime":1349,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1349},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":2981300,"Executor Run Time":7505,"Executor CPU Time":5040156600,"Peak Execution Memory":94371376,"Result Size":5928,"JVM GC Time":228,"Result Serialization Time":3,"Memory Bytes Spilled":96468288,"Disk Bytes Spilled":21875267,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25164830,"Total Records Read":1199495,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":3571691,"Shuffle Write Time":17914804,"Shuffle Records Written":350585},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":45,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830565903,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830565674,"Failed":false,"Killed":false,"Accumulables":[{"ID":468,"Name":"local blocks read","Update":"8","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Update":"6302098","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Update":"300477","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Update":"9825840","Value":"144607776","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Update":"2137471","Value":"30742224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Update":"204705","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Update":"10670655","Value":"345854506","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Update":"460","Value":"42586","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Update":"204705","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Update":"20971424","Value":"322960032","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Update":"403","Value":"40061","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Update":"16","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Update":"755","Value":"56270","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Update":"174","Value":"8104","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Update":"33554240","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Update":"0","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":68,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Update":10916300,"Value":45917300,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Update":826,"Value":58770,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Update":699323800,"Value":43639869200,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Update":5799,"Value":53051,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Update":53,"Value":1741,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Update":54525664,"Value":809496672,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":6302098,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Update":300477,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":2137471,"Value":30742224,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":204705,"Value":3012662,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Update":10670655,"Value":345854506,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":10916300,"Executor Run Time":826,"Executor CPU Time":699323800,"Peak Execution Memory":54525664,"Result Size":5799,"JVM GC Time":53,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":6302098,"Total Records Read":300477,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":2137471,"Shuffle Write Time":10670655,"Shuffle Records Written":204705},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"64\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"69\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":31,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"73\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"70\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830558991,"Completion Time":1747830565675,"Accumulables":[{"ID":468,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":471,"Name":"local bytes read","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"records read","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"data size","Value":"144607776","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":607,"Name":"shuffle bytes written","Value":"30742224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":608,"Name":"shuffle records written","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":609,"Name":"shuffle write time","Value":"345854506","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":610,"Name":"duration","Value":"42586","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":611,"Name":"number of output rows","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":612,"Name":"peak memory","Value":"322960032","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":614,"Name":"time in aggregation build","Value":"40061","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":615,"Name":"avg hash probes per key","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":617,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":618,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":619,"Name":"duration","Value":"56270","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":620,"Name":"sort time","Value":"8104","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"peak memory","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":622,"Name":"spill size","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":626,"Name":"internal.metrics.executorDeserializeTime","Value":68,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.executorDeserializeCpuTime","Value":45917300,"Internal":true,"Count Failed Values":true},{"ID":628,"Name":"internal.metrics.executorRunTime","Value":58770,"Internal":true,"Count Failed Values":true},{"ID":629,"Name":"internal.metrics.executorCpuTime","Value":43639869200,"Internal":true,"Count Failed Values":true},{"ID":630,"Name":"internal.metrics.resultSize","Value":53051,"Internal":true,"Count Failed Values":true},{"ID":631,"Name":"internal.metrics.jvmGCTime","Value":1741,"Internal":true,"Count Failed Values":true},{"ID":632,"Name":"internal.metrics.resultSerializationTime","Value":22,"Internal":true,"Count Failed Values":true},{"ID":633,"Name":"internal.metrics.memoryBytesSpilled","Value":788523456,"Internal":true,"Count Failed Values":true},{"ID":634,"Name":"internal.metrics.diskBytesSpilled","Value":175320485,"Internal":true,"Count Failed Values":true},{"ID":635,"Name":"internal.metrics.peakExecutionMemory","Value":809496672,"Internal":true,"Count Failed Values":true},{"ID":637,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":638,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":639,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":640,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":641,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":644,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":645,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":646,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":647,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":648,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":649,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":650,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":651,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":652,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":653,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":654,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":30742224,"Internal":true,"Count Failed Values":true},{"ID":655,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":3012662,"Internal":true,"Count Failed Values":true},{"ID":656,"Name":"internal.metrics.shuffle.write.writeTime","Value":345854506,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":5,"Completion Time":1747830565676,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":1,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (37)\n+- == Current Plan ==\n   TakeOrderedAndProject (21)\n   +- HashAggregate (20)\n      +- ShuffleQueryStage (19)\n         +- Exchange (18)\n            +- * HashAggregate (17)\n               +- * HashAggregate (16)\n                  +- AQEShuffleRead (15)\n                     +- ShuffleQueryStage (14), Statistics(sizeInBytes=137.9 MiB, rowCount=3.01E+6)\n                        +- Exchange (13)\n                           +- * HashAggregate (12)\n                              +- * Project (11)\n                                 +- * Filter (10)\n                                    +- SortAggregate (9)\n                                       +- * Sort (8)\n                                          +- AQEShuffleRead (7)\n                                             +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                +- Exchange (5)\n                                                   +- SortAggregate (4)\n                                                      +- * Sort (3)\n                                                         +- * Filter (2)\n                                                            +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (36)\n   +- HashAggregate (35)\n      +- Exchange (34)\n         +- HashAggregate (33)\n            +- HashAggregate (32)\n               +- Exchange (31)\n                  +- HashAggregate (30)\n                     +- Project (29)\n                        +- Filter (28)\n                           +- SortAggregate (27)\n                              +- Sort (26)\n                                 +- Exchange (25)\n                                    +- SortAggregate (24)\n                                       +- Sort (23)\n                                          +- Filter (22)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#160, user_id#17]\nArguments: 1\n\n(15) AQEShuffleRead\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: coalesced\n\n(16) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(17) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(18) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=336]\n\n(19) ShuffleQueryStage\nOutput [2]: [_groupingexpression#160, count#171L]\nArguments: 2\n\n(20) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(21) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(22) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(23) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(24) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(25) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]\n\n(26) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(27) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(28) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(29) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(30) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(31) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]\n\n(32) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(34) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]\n\n(35) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(36) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(37) AdaptiveSparkPlan\nOutput [2]: [toprettystring(date)#156, toprettystring(dau)#157]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[date#79 ASC NULLS FIRST], output=[toprettystring(date)#156,toprettystring(dau)#157])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[count(distinct user_id#17)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=336]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833)]"},"metrics":[{"name":"number of output rows","accumulatorId":368,"metricType":"sum"},{"name":"number of files read","accumulatorId":369,"metricType":"sum"},{"name":"metadata time","accumulatorId":370,"metricType":"timing"},{"name":"size of files read","accumulatorId":371,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":492,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":489,"metricType":"timing"},{"name":"peak memory","accumulatorId":490,"metricType":"size"},{"name":"spill size","accumulatorId":491,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":488,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":487,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":485,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":479,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":486,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":480,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":477,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":474,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":483,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":476,"metricType":"sum"},{"name":"records read","accumulatorId":473,"metricType":"sum"},{"name":"local bytes read","accumulatorId":471,"metricType":"size"},{"name":"fetch wait time","accumulatorId":472,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":469,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":475,"metricType":"sum"},{"name":"local blocks read","accumulatorId":468,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":478,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":467,"metricType":"sum"},{"name":"data size","accumulatorId":465,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":481,"metricType":"size"},{"name":"number of partitions","accumulatorId":466,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":482,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":470,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":484,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":623,"metricType":"sum"},{"name":"partition data size","accumulatorId":624,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":625,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":620,"metricType":"timing"},{"name":"peak memory","accumulatorId":621,"metricType":"size"},{"name":"spill size","accumulatorId":622,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":619,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":618,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":617,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":613,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":614,"metricType":"timing"},{"name":"peak memory","accumulatorId":612,"metricType":"size"},{"name":"number of output rows","accumulatorId":611,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":616,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":615,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":610,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":608,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":602,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":609,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":603,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":600,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":597,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":606,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":599,"metricType":"sum"},{"name":"records read","accumulatorId":596,"metricType":"sum"},{"name":"local bytes read","accumulatorId":594,"metricType":"size"},{"name":"fetch wait time","accumulatorId":595,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":592,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":598,"metricType":"sum"},{"name":"local blocks read","accumulatorId":591,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":601,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":590,"metricType":"sum"},{"name":"data size","accumulatorId":588,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":604,"metricType":"size"},{"name":"number of partitions","accumulatorId":589,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":605,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":593,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":607,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":722,"metricType":"sum"},{"name":"partition data size","accumulatorId":723,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":724,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":718,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":719,"metricType":"timing"},{"name":"peak memory","accumulatorId":717,"metricType":"size"},{"name":"number of output rows","accumulatorId":716,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":721,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":720,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":712,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":713,"metricType":"timing"},{"name":"peak memory","accumulatorId":711,"metricType":"size"},{"name":"number of output rows","accumulatorId":710,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":715,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":714,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":709,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":707,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":701,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":708,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":702,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":699,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":696,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":705,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":698,"metricType":"sum"},{"name":"records read","accumulatorId":695,"metricType":"sum"},{"name":"local bytes read","accumulatorId":693,"metricType":"size"},{"name":"fetch wait time","accumulatorId":694,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":691,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":697,"metricType":"sum"},{"name":"local blocks read","accumulatorId":690,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":700,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":689,"metricType":"sum"},{"name":"data size","accumulatorId":687,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":703,"metricType":"size"},{"name":"number of partitions","accumulatorId":688,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":704,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":692,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":706,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":683,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":684,"metricType":"timing"},{"name":"peak memory","accumulatorId":682,"metricType":"size"},{"name":"number of output rows","accumulatorId":681,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":686,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":685,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":679,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":673,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":680,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":674,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":671,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":668,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":677,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":670,"metricType":"sum"},{"name":"records read","accumulatorId":667,"metricType":"sum"},{"name":"local bytes read","accumulatorId":665,"metricType":"size"},{"name":"fetch wait time","accumulatorId":666,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":663,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":669,"metricType":"sum"},{"name":"local blocks read","accumulatorId":662,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":672,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":661,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":675,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":676,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":664,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":678,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[722,8],[724,8],[723,3850399],[723,3982025],[723,3961605],[723,3841224],[723,3844659],[723,3850634],[723,3979128],[723,4670339]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[688,200]]}
{"Event":"SparkListenerJobStart","Job ID":6,"Submission Time":1747830565747,"Stage Infos":[{"Stage ID":9,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":10,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"64\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"69\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":31,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"73\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"70\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[9],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"75\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"79\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[35],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[10],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[9,10,11],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"75\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"79\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[35],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[10],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830565753,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":46,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830565763,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":47,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830565764,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":48,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":49,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":50,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":51,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830565766,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":52,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830565767,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":53,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830565767,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":46,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830565763,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566349,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3684924","Value":"3684924","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"360338","Value":"360338","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"14560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17196","Value":"17196","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"364","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"19016863","Value":"19016863","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"490","Value":"490","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"364","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"262144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"432","Value":"432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"43518","Value":"43518","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"2621424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"399","Value":"399","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":13,"Value":13,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5448200,"Value":5448200,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":562,"Value":562,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":436028300,"Value":436028300,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":7759,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":2883568,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3684924,"Value":3684924,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":360338,"Value":360338,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17196,"Value":17196,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":364,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":19016863,"Value":19016863,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":13,"Executor Deserialize CPU Time":5448200,"Executor Run Time":562,"Executor CPU Time":436028300,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3684924,"Total Records Read":360338,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17196,"Shuffle Write Time":19016863,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":48,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566366,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3832375","Value":"7517299","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"375748","Value":"736086","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"29120","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17151","Value":"34347","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"728","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"14326344","Value":"33343207","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"515","Value":"1005","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"728","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"524288","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"461","Value":"893","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"45407","Value":"88925","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"5242848","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"439","Value":"838","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":17,"Value":30,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7718100,"Value":13166300,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":577,"Value":1139,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":381904200,"Value":817932500,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":15518,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":18,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":5767136,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":18,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3832375,"Value":7517299,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":375748,"Value":736086,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17151,"Value":34347,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":728,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":14326344,"Value":33343207,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":17,"Executor Deserialize CPU Time":7718100,"Executor Run Time":577,"Executor CPU Time":381904200,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3832375,"Total Records Read":375748,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17151,"Shuffle Write Time":14326344,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":50,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566446,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"27","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3687918","Value":"11205217","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"360841","Value":"1096927","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"43680","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17206","Value":"51553","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"1092","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"29524322","Value":"62867529","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"574","Value":"1579","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"1092","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"786432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"518","Value":"1411","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"43605","Value":"132530","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"7864272","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"487","Value":"1325","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"36","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":16,"Value":46,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7573500,"Value":20739800,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":654,"Value":1793,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":445146800,"Value":1263079300,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":23277,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":8650704,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3687918,"Value":11205217,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":360841,"Value":1096927,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17206,"Value":51553,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":1092,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":29524322,"Value":62867529,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":16,"Executor Deserialize CPU Time":7573500,"Executor Run Time":654,"Executor CPU Time":445146800,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3687918,"Total Records Read":360841,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17206,"Shuffle Write Time":29524322,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":53,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830565767,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566461,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"36","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"4469522","Value":"15674739","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"438048","Value":"1534975","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"58240","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17172","Value":"68725","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"1456","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"50248497","Value":"113116026","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"583","Value":"2162","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"1456","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"1048576","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"513","Value":"1924","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"52958","Value":"185488","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"3145712","Value":"11009984","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"479","Value":"1804","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":51,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3953100,"Value":24692900,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":682,"Value":2475,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":592217700,"Value":1855297000,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":31036,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":36,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":3407856,"Value":12058560,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":36,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":4469522,"Value":15674739,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":438048,"Value":1534975,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17172,"Value":68725,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":1456,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":50248497,"Value":113116026,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":3953100,"Executor Run Time":682,"Executor CPU Time":592217700,"Peak Execution Memory":3407856,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":4469522,"Total Records Read":438048,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17172,"Shuffle Write Time":50248497,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":52,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830565767,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566462,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"45","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3831590","Value":"19506329","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"376539","Value":"1911514","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"72800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17194","Value":"85919","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"1820","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"37031758","Value":"150147784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"587","Value":"2749","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"1820","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"1310720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"521","Value":"2445","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"45520","Value":"231008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"13631408","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"509","Value":"2313","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"13","Value":"61","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4420300,"Value":29113200,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":679,"Value":3154,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":395794500,"Value":2251091500,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":38795,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":14942128,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3831590,"Value":19506329,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":376539,"Value":1911514,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17194,"Value":85919,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":1820,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":37031758,"Value":150147784,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":4420300,"Executor Run Time":679,"Executor CPU Time":395794500,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3831590,"Total Records Read":376539,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17194,"Shuffle Write Time":37031758,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":47,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830565764,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566474,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"54","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3833520","Value":"23339849","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"375468","Value":"2286982","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"87360","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17206","Value":"103125","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"2184","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"50629125","Value":"200776909","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"585","Value":"3334","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"2184","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"1572864","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"517","Value":"2962","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"45371","Value":"276379","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"16252832","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"473","Value":"2786","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"73","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":27,"Value":83,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6095300,"Value":35208500,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":674,"Value":3828,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":407812900,"Value":2658904400,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":46554,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":54,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":17825696,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":54,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3833520,"Value":23339849,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":375468,"Value":2286982,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17206,"Value":103125,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":2184,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":50629125,"Value":200776909,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":27,"Executor Deserialize CPU Time":6095300,"Executor Run Time":674,"Executor CPU Time":407812900,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3833520,"Total Records Read":375468,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17206,"Shuffle Write Time":50629125,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":51,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830565766,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566474,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"63","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3711242","Value":"27051091","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"364446","Value":"2651428","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"101920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17206","Value":"120331","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"2548","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"57694212","Value":"258471121","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"595","Value":"3929","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"2548","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"1835008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"511","Value":"3473","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"43998","Value":"320377","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"18874256","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"492","Value":"3278","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"85","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":20,"Value":103,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4760400,"Value":39968900,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":682,"Value":4510,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":370430300,"Value":3029334700,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":54313,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":63,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":20709264,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":63,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3711242,"Value":27051091,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":364446,"Value":2651428,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17206,"Value":120331,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":2548,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":57694212,"Value":258471121,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":20,"Executor Deserialize CPU Time":4760400,"Executor Run Time":682,"Executor CPU Time":370430300,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3711242,"Total Records Read":364446,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17206,"Shuffle Write Time":57694212,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":49,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830565765,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566488,"Failed":false,"Killed":false,"Accumulables":[{"ID":591,"Name":"local blocks read","Update":"9","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Update":"3691133","Value":"30742224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Update":"361234","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Update":"14560","Value":"116480","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Update":"17211","Value":"137542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Update":"364","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Update":"15084077","Value":"273555198","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Update":"637","Value":"4566","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Update":"364","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Update":"262144","Value":"2097152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Update":"583","Value":"4056","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Update":"43623","Value":"364000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Update":"2621424","Value":"21495680","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Update":"574","Value":"3852","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Update":"12","Value":"97","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":109,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5959800,"Value":45928700,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Update":711,"Value":5221,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Update":411566100,"Value":3440900800,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Update":7759,"Value":62072,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Update":2883568,"Value":23592832,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":3691133,"Value":30742224,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Update":361234,"Value":3012662,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":17211,"Value":137542,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":364,"Value":2912,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Update":15084077,"Value":273555198,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":5959800,"Executor Run Time":711,"Executor CPU Time":411566100,"Peak Execution Memory":2883568,"Result Size":7759,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":3691133,"Total Records Read":361234,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":17211,"Shuffle Write Time":15084077,"Shuffle Records Written":364},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"75\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"79\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[35],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[10],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830565753,"Completion Time":1747830566489,"Accumulables":[{"ID":591,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":594,"Name":"local bytes read","Value":"30742224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":595,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":596,"Name":"records read","Value":"3012662","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":687,"Name":"data size","Value":"116480","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":706,"Name":"shuffle bytes written","Value":"137542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":707,"Name":"shuffle records written","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":708,"Name":"shuffle write time","Value":"273555198","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":709,"Name":"duration","Value":"4566","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":710,"Name":"number of output rows","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":711,"Name":"peak memory","Value":"2097152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":713,"Name":"time in aggregation build","Value":"4056","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":716,"Name":"number of output rows","Value":"364000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":717,"Name":"peak memory","Value":"21495680","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":719,"Name":"time in aggregation build","Value":"3852","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":720,"Name":"avg hash probes per key","Value":"97","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":725,"Name":"internal.metrics.executorDeserializeTime","Value":109,"Internal":true,"Count Failed Values":true},{"ID":726,"Name":"internal.metrics.executorDeserializeCpuTime","Value":45928700,"Internal":true,"Count Failed Values":true},{"ID":727,"Name":"internal.metrics.executorRunTime","Value":5221,"Internal":true,"Count Failed Values":true},{"ID":728,"Name":"internal.metrics.executorCpuTime","Value":3440900800,"Internal":true,"Count Failed Values":true},{"ID":729,"Name":"internal.metrics.resultSize","Value":62072,"Internal":true,"Count Failed Values":true},{"ID":730,"Name":"internal.metrics.jvmGCTime","Value":72,"Internal":true,"Count Failed Values":true},{"ID":734,"Name":"internal.metrics.peakExecutionMemory","Value":23592832,"Internal":true,"Count Failed Values":true},{"ID":736,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":737,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":738,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":739,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":740,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":30742224,"Internal":true,"Count Failed Values":true},{"ID":741,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":742,"Name":"internal.metrics.shuffle.read.recordsRead","Value":3012662,"Internal":true,"Count Failed Values":true},{"ID":743,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":744,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":745,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":746,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":747,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":748,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":749,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":750,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":751,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":752,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":753,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":137542,"Internal":true,"Count Failed Values":true},{"ID":754,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":2912,"Internal":true,"Count Failed Values":true},{"ID":755,"Name":"internal.metrics.shuffle.write.writeTime","Value":273555198,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":6,"Completion Time":1747830566491,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":1,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (38)\n+- == Final Plan ==\n   TakeOrderedAndProject (22)\n   +- * HashAggregate (21)\n      +- AQEShuffleRead (20)\n         +- ShuffleQueryStage (19), Statistics(sizeInBytes=113.8 KiB, rowCount=2.91E+3)\n            +- Exchange (18)\n               +- * HashAggregate (17)\n                  +- * HashAggregate (16)\n                     +- AQEShuffleRead (15)\n                        +- ShuffleQueryStage (14), Statistics(sizeInBytes=137.9 MiB, rowCount=3.01E+6)\n                           +- Exchange (13)\n                              +- * HashAggregate (12)\n                                 +- * Project (11)\n                                    +- * Filter (10)\n                                       +- SortAggregate (9)\n                                          +- * Sort (8)\n                                             +- AQEShuffleRead (7)\n                                                +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                   +- Exchange (5)\n                                                      +- SortAggregate (4)\n                                                         +- * Sort (3)\n                                                            +- * Filter (2)\n                                                               +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (37)\n   +- HashAggregate (36)\n      +- Exchange (35)\n         +- HashAggregate (34)\n            +- HashAggregate (33)\n               +- Exchange (32)\n                  +- HashAggregate (31)\n                     +- Project (30)\n                        +- Filter (29)\n                           +- SortAggregate (28)\n                              +- Sort (27)\n                                 +- Exchange (26)\n                                    +- SortAggregate (25)\n                                       +- Sort (24)\n                                          +- Filter (23)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#160, user_id#17]\nArguments: 1\n\n(15) AQEShuffleRead\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: coalesced\n\n(16) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(17) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(18) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=336]\n\n(19) ShuffleQueryStage\nOutput [2]: [_groupingexpression#160, count#171L]\nArguments: 2\n\n(20) AQEShuffleRead\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: coalesced\n\n(21) HashAggregate [codegen id : 5]\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(22) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(23) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))\n\n(24) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#173, valueSet#174, first#175, valueSet#176]\nResults [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\n\n(26) Exchange\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=167]\n\n(27) Sort\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(28) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#177, valueSet#178, first#179, valueSet#180]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#161, first(duration_ms#21)()#165]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#161 AS action_type#162, first(duration_ms#21)()#165 AS duration_ms#166]\n\n(29) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\nCondition : (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))\n\n(30) Project\nOutput [2]: [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]\nInput [4]: [user_id#17, timestamp#30, action_type#162, duration_ms#166]\n\n(31) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#160]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(32) Exchange\nInput [2]: [_groupingexpression#160, user_id#17]\nArguments: hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=174]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [2]: [_groupingexpression#160, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#160, user_id#17]\n\n(34) HashAggregate\nInput [2]: [_groupingexpression#160, user_id#17]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160, count#171L]\n\n(35) Exchange\nInput [2]: [_groupingexpression#160, count#171L]\nArguments: hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=178]\n\n(36) HashAggregate\nInput [2]: [_groupingexpression#160, count#171L]\nKeys [1]: [_groupingexpression#160]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#85L]\nResults [2]: [_groupingexpression#160 AS date#79, count(user_id#17)#85L AS dau#84L]\n\n(37) TakeOrderedAndProject\nInput [2]: [date#79, dau#84L]\nArguments: 21, [date#79 ASC NULLS FIRST], [toprettystring(date#79, Some(Asia/Hong_Kong)) AS toprettystring(date)#156, toprettystring(dau#84L, Some(Asia/Hong_Kong)) AS toprettystring(dau)#157]\n\n(38) AdaptiveSparkPlan\nOutput [2]: [toprettystring(date)#156, toprettystring(dau)#157]\nArguments: isFinalPlan=true\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[date#79 ASC NULLS FIRST], output=[toprettystring(date)#156,toprettystring(dau)#157])","children":[{"nodeName":"WholeStageCodegen (5)","simpleString":"WholeStageCodegen (5)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[count(distinct user_id#17)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, 200), ENSURE_REQUIREMENTS, [plan_id=336]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#160, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=295]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#160, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_format(timestamp#30, yyyy-MM-dd, Some(Asia/Hong_Kong)) AS _groupingexpression#160]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#166) AND ((action_type#162 IN (create,edit,share,page_view,delete) AND (duration_ms#166 >= -127618)) AND (duration_ms#166 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=213]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:06.120833)]"},"metrics":[{"name":"number of output rows","accumulatorId":368,"metricType":"sum"},{"name":"number of files read","accumulatorId":369,"metricType":"sum"},{"name":"metadata time","accumulatorId":370,"metricType":"timing"},{"name":"size of files read","accumulatorId":371,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":492,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":489,"metricType":"timing"},{"name":"peak memory","accumulatorId":490,"metricType":"size"},{"name":"spill size","accumulatorId":491,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":488,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":487,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":485,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":479,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":486,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":480,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":477,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":474,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":483,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":476,"metricType":"sum"},{"name":"records read","accumulatorId":473,"metricType":"sum"},{"name":"local bytes read","accumulatorId":471,"metricType":"size"},{"name":"fetch wait time","accumulatorId":472,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":469,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":475,"metricType":"sum"},{"name":"local blocks read","accumulatorId":468,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":478,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":467,"metricType":"sum"},{"name":"data size","accumulatorId":465,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":481,"metricType":"size"},{"name":"number of partitions","accumulatorId":466,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":482,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":470,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":484,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":623,"metricType":"sum"},{"name":"partition data size","accumulatorId":624,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":625,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":620,"metricType":"timing"},{"name":"peak memory","accumulatorId":621,"metricType":"size"},{"name":"spill size","accumulatorId":622,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":619,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":618,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":617,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":613,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":614,"metricType":"timing"},{"name":"peak memory","accumulatorId":612,"metricType":"size"},{"name":"number of output rows","accumulatorId":611,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":616,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":615,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":610,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":608,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":602,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":609,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":603,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":600,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":597,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":606,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":599,"metricType":"sum"},{"name":"records read","accumulatorId":596,"metricType":"sum"},{"name":"local bytes read","accumulatorId":594,"metricType":"size"},{"name":"fetch wait time","accumulatorId":595,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":592,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":598,"metricType":"sum"},{"name":"local blocks read","accumulatorId":591,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":601,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":590,"metricType":"sum"},{"name":"data size","accumulatorId":588,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":604,"metricType":"size"},{"name":"number of partitions","accumulatorId":589,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":605,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":593,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":607,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":722,"metricType":"sum"},{"name":"partition data size","accumulatorId":723,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":724,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":718,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":719,"metricType":"timing"},{"name":"peak memory","accumulatorId":717,"metricType":"size"},{"name":"number of output rows","accumulatorId":716,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":721,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":720,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":712,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":713,"metricType":"timing"},{"name":"peak memory","accumulatorId":711,"metricType":"size"},{"name":"number of output rows","accumulatorId":710,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":715,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":714,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":709,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":707,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":701,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":708,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":702,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":699,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":696,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":705,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":698,"metricType":"sum"},{"name":"records read","accumulatorId":695,"metricType":"sum"},{"name":"local bytes read","accumulatorId":693,"metricType":"size"},{"name":"fetch wait time","accumulatorId":694,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":691,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":697,"metricType":"sum"},{"name":"local blocks read","accumulatorId":690,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":700,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":689,"metricType":"sum"},{"name":"data size","accumulatorId":687,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":703,"metricType":"size"},{"name":"number of partitions","accumulatorId":688,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":704,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":692,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":706,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":787,"metricType":"sum"},{"name":"partition data size","accumulatorId":788,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":789,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":783,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":784,"metricType":"timing"},{"name":"peak memory","accumulatorId":782,"metricType":"size"},{"name":"number of output rows","accumulatorId":781,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":786,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":785,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":780,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":778,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":772,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":779,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":773,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":770,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":767,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":776,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":769,"metricType":"sum"},{"name":"records read","accumulatorId":766,"metricType":"sum"},{"name":"local bytes read","accumulatorId":764,"metricType":"size"},{"name":"fetch wait time","accumulatorId":765,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":762,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":768,"metricType":"sum"},{"name":"local blocks read","accumulatorId":761,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":771,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":760,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":774,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":775,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":763,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":777,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[787,1],[789,1],[788,141367]]}
{"Event":"SparkListenerJobStart","Job ID":7,"Submission Time":1747830566570,"Stage Infos":[{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"81\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[39],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":39,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"84\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[14],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":12,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"56\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"57\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":13,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"64\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"69\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":31,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"73\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"70\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[12],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":14,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"74\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"75\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"79\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[35],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[13],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[15,12,13,14],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"81\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[39],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":39,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"84\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[14],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830566574,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"1","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"1","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":15,"Stage Attempt ID":0,"Task Info":{"Task ID":54,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830566584,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":15,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":54,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830566584,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830566639,"Failed":false,"Killed":false,"Accumulables":[{"ID":690,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":693,"Name":"local bytes read","Update":"137542","Value":"137542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":694,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":695,"Name":"records read","Update":"2912","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":780,"Name":"duration","Update":"17","Value":"17","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":781,"Name":"number of output rows","Update":"364","Value":"364","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":782,"Name":"peak memory","Update":"2359280","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":784,"Name":"time in aggregation build","Update":"5","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":785,"Name":"avg hash probes per key","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":790,"Name":"internal.metrics.executorDeserializeTime","Update":20,"Value":20,"Internal":true,"Count Failed Values":true},{"ID":791,"Name":"internal.metrics.executorDeserializeCpuTime","Update":19510600,"Value":19510600,"Internal":true,"Count Failed Values":true},{"ID":792,"Name":"internal.metrics.executorRunTime","Update":29,"Value":29,"Internal":true,"Count Failed Values":true},{"ID":793,"Name":"internal.metrics.executorCpuTime","Update":26740600,"Value":26740600,"Internal":true,"Count Failed Values":true},{"ID":794,"Name":"internal.metrics.resultSize","Update":10148,"Value":10148,"Internal":true,"Count Failed Values":true},{"ID":799,"Name":"internal.metrics.peakExecutionMemory","Update":2359280,"Value":2359280,"Internal":true,"Count Failed Values":true},{"ID":801,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":802,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":803,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":804,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":805,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":137542,"Value":137542,"Internal":true,"Count Failed Values":true},{"ID":806,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":807,"Name":"internal.metrics.shuffle.read.recordsRead","Update":2912,"Value":2912,"Internal":true,"Count Failed Values":true},{"ID":808,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":809,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":810,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":811,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":812,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":813,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":814,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":815,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":816,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":817,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":20,"Executor Deserialize CPU Time":19510600,"Executor Run Time":29,"Executor CPU Time":26740600,"Peak Execution Memory":2359280,"Result Size":10148,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":137542,"Total Records Read":2912,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"81\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[39],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":39,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"84\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[14],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830566574,"Completion Time":1747830566641,"Accumulables":[{"ID":690,"Name":"local blocks read","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":693,"Name":"local bytes read","Value":"137542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":694,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":695,"Name":"records read","Value":"2912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":780,"Name":"duration","Value":"17","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":781,"Name":"number of output rows","Value":"364","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":782,"Name":"peak memory","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":784,"Name":"time in aggregation build","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":785,"Name":"avg hash probes per key","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":790,"Name":"internal.metrics.executorDeserializeTime","Value":20,"Internal":true,"Count Failed Values":true},{"ID":791,"Name":"internal.metrics.executorDeserializeCpuTime","Value":19510600,"Internal":true,"Count Failed Values":true},{"ID":792,"Name":"internal.metrics.executorRunTime","Value":29,"Internal":true,"Count Failed Values":true},{"ID":793,"Name":"internal.metrics.executorCpuTime","Value":26740600,"Internal":true,"Count Failed Values":true},{"ID":794,"Name":"internal.metrics.resultSize","Value":10148,"Internal":true,"Count Failed Values":true},{"ID":799,"Name":"internal.metrics.peakExecutionMemory","Value":2359280,"Internal":true,"Count Failed Values":true},{"ID":801,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":802,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":8,"Internal":true,"Count Failed Values":true},{"ID":803,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":804,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":805,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":137542,"Internal":true,"Count Failed Values":true},{"ID":806,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":807,"Name":"internal.metrics.shuffle.read.recordsRead","Value":2912,"Internal":true,"Count Failed Values":true},{"ID":808,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":809,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":810,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":811,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":812,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":813,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":814,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":815,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":816,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":817,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":7,"Completion Time":1747830566642,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":1,"time":1747830566668,"errorMessage":""}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":2,"rootExecutionId":2,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (17)\n+- TakeOrderedAndProject (16)\n   +- HashAggregate (15)\n      +- Exchange (14)\n         +- HashAggregate (13)\n            +- HashAggregate (12)\n               +- Exchange (11)\n                  +- HashAggregate (10)\n                     +- Project (9)\n                        +- Filter (8)\n                           +- SortAggregate (7)\n                              +- Sort (6)\n                                 +- Exchange (5)\n                                    +- SortAggregate (4)\n                                       +- Sort (3)\n                                          +- Filter (2)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(3) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]\n\n(6) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(7) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(8) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(9) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(10) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(11) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]\n\n(12) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(13) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(14) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]\n\n(15) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(16) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(17) AdaptiveSparkPlan\nOutput [2]: [toprettystring(month)#212, toprettystring(mau)#213]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[month#88 ASC NULLS FIRST], output=[toprettystring(month)#212,toprettystring(mau)#213])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736)]"},"metrics":[{"name":"number of output rows","accumulatorId":945,"metricType":"sum"},{"name":"number of files read","accumulatorId":946,"metricType":"sum"},{"name":"metadata time","accumulatorId":947,"metricType":"timing"},{"name":"size of files read","accumulatorId":948,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":944,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":941,"metricType":"timing"},{"name":"peak memory","accumulatorId":942,"metricType":"size"},{"name":"spill size","accumulatorId":943,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":940,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":938,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":932,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":939,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":933,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":930,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":927,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":936,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":929,"metricType":"sum"},{"name":"records read","accumulatorId":926,"metricType":"sum"},{"name":"local bytes read","accumulatorId":924,"metricType":"size"},{"name":"fetch wait time","accumulatorId":925,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":922,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":928,"metricType":"sum"},{"name":"local blocks read","accumulatorId":921,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":931,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":920,"metricType":"sum"},{"name":"data size","accumulatorId":918,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":934,"metricType":"size"},{"name":"number of partitions","accumulatorId":919,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":935,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":923,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":937,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":915,"metricType":"timing"},{"name":"peak memory","accumulatorId":916,"metricType":"size"},{"name":"spill size","accumulatorId":917,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":914,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":913,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":909,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":910,"metricType":"timing"},{"name":"peak memory","accumulatorId":908,"metricType":"size"},{"name":"number of output rows","accumulatorId":907,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":912,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":911,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":905,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":899,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":906,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":900,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":897,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":894,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":903,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":896,"metricType":"sum"},{"name":"records read","accumulatorId":893,"metricType":"sum"},{"name":"local bytes read","accumulatorId":891,"metricType":"size"},{"name":"fetch wait time","accumulatorId":892,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":889,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":895,"metricType":"sum"},{"name":"local blocks read","accumulatorId":888,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":898,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":887,"metricType":"sum"},{"name":"data size","accumulatorId":885,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":901,"metricType":"size"},{"name":"number of partitions","accumulatorId":886,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":902,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":890,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":904,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":881,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":882,"metricType":"timing"},{"name":"peak memory","accumulatorId":880,"metricType":"size"},{"name":"number of output rows","accumulatorId":879,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":884,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":883,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":875,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":876,"metricType":"timing"},{"name":"peak memory","accumulatorId":874,"metricType":"size"},{"name":"number of output rows","accumulatorId":873,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":878,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":877,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":871,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":865,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":872,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":866,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":863,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":860,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":869,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":862,"metricType":"sum"},{"name":"records read","accumulatorId":859,"metricType":"sum"},{"name":"local bytes read","accumulatorId":857,"metricType":"size"},{"name":"fetch wait time","accumulatorId":858,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":855,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":861,"metricType":"sum"},{"name":"local blocks read","accumulatorId":854,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":864,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":853,"metricType":"sum"},{"name":"data size","accumulatorId":851,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":867,"metricType":"size"},{"name":"number of partitions","accumulatorId":852,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":868,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":856,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":870,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":847,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":848,"metricType":"timing"},{"name":"peak memory","accumulatorId":846,"metricType":"size"},{"name":"number of output rows","accumulatorId":845,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":850,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":849,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":843,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":837,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":844,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":838,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":835,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":832,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":841,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":834,"metricType":"sum"},{"name":"records read","accumulatorId":831,"metricType":"sum"},{"name":"local bytes read","accumulatorId":829,"metricType":"size"},{"name":"fetch wait time","accumulatorId":830,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":827,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":833,"metricType":"sum"},{"name":"local blocks read","accumulatorId":826,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":836,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":825,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":839,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":840,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":828,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":842,"metricType":"size"}]}],"metadata":{},"metrics":[]},"time":1747830566815,"modifiedConfigs":{"spark.sql.session.timeZone":"Asia/Hong_Kong"},"jobTags":[]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (33)\n+- == Current Plan ==\n   TakeOrderedAndProject (17)\n   +- HashAggregate (16)\n      +- Exchange (15)\n         +- HashAggregate (14)\n            +- HashAggregate (13)\n               +- Exchange (12)\n                  +- HashAggregate (11)\n                     +- Project (10)\n                        +- Filter (9)\n                           +- SortAggregate (8)\n                              +- Sort (7)\n                                 +- ShuffleQueryStage (6)\n                                    +- Exchange (5)\n                                       +- SortAggregate (4)\n                                          +- * Sort (3)\n                                             +- * Filter (2)\n                                                +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (32)\n   +- HashAggregate (31)\n      +- Exchange (30)\n         +- HashAggregate (29)\n            +- HashAggregate (28)\n               +- Exchange (27)\n                  +- HashAggregate (26)\n                     +- Project (25)\n                        +- Filter (24)\n                           +- SortAggregate (23)\n                              +- Sort (22)\n                                 +- Exchange (21)\n                                    +- SortAggregate (20)\n                                       +- Sort (19)\n                                          +- Filter (18)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: 0\n\n(7) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(8) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(9) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(10) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(11) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(12) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=473]\n\n(13) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(14) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(15) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=476]\n\n(16) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(17) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(18) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(19) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(20) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(21) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]\n\n(22) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(23) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(24) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(25) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(26) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(27) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]\n\n(28) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(29) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(30) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]\n\n(31) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(32) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(33) AdaptiveSparkPlan\nOutput [2]: [toprettystring(month)#212, toprettystring(mau)#213]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[month#88 ASC NULLS FIRST], output=[toprettystring(month)#212,toprettystring(mau)#213])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=476]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=473]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736)]"},"metrics":[{"name":"number of output rows","accumulatorId":945,"metricType":"sum"},{"name":"number of files read","accumulatorId":946,"metricType":"sum"},{"name":"metadata time","accumulatorId":947,"metricType":"timing"},{"name":"size of files read","accumulatorId":948,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1069,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1066,"metricType":"timing"},{"name":"peak memory","accumulatorId":1067,"metricType":"size"},{"name":"spill size","accumulatorId":1068,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1065,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1064,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1062,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1056,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1063,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1057,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1054,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1051,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1060,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1053,"metricType":"sum"},{"name":"records read","accumulatorId":1050,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1048,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1049,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1046,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1052,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1045,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1055,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1044,"metricType":"sum"},{"name":"data size","accumulatorId":1042,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1058,"metricType":"size"},{"name":"number of partitions","accumulatorId":1043,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1059,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1047,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1061,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1039,"metricType":"timing"},{"name":"peak memory","accumulatorId":1040,"metricType":"size"},{"name":"spill size","accumulatorId":1041,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1038,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1037,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1033,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1034,"metricType":"timing"},{"name":"peak memory","accumulatorId":1032,"metricType":"size"},{"name":"number of output rows","accumulatorId":1031,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1036,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1035,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1029,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1023,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1030,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1024,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1021,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1018,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1027,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1020,"metricType":"sum"},{"name":"records read","accumulatorId":1017,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1015,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1016,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1013,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1019,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1012,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1022,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1011,"metricType":"sum"},{"name":"data size","accumulatorId":1009,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1025,"metricType":"size"},{"name":"number of partitions","accumulatorId":1010,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1026,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1014,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1028,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1005,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1006,"metricType":"timing"},{"name":"peak memory","accumulatorId":1004,"metricType":"size"},{"name":"number of output rows","accumulatorId":1003,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1008,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1007,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":999,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1000,"metricType":"timing"},{"name":"peak memory","accumulatorId":998,"metricType":"size"},{"name":"number of output rows","accumulatorId":997,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1002,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1001,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":995,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":989,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":996,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":990,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":987,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":984,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":993,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":986,"metricType":"sum"},{"name":"records read","accumulatorId":983,"metricType":"sum"},{"name":"local bytes read","accumulatorId":981,"metricType":"size"},{"name":"fetch wait time","accumulatorId":982,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":979,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":985,"metricType":"sum"},{"name":"local blocks read","accumulatorId":978,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":988,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":977,"metricType":"sum"},{"name":"data size","accumulatorId":975,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":991,"metricType":"size"},{"name":"number of partitions","accumulatorId":976,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":992,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":980,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":994,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":971,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":972,"metricType":"timing"},{"name":"peak memory","accumulatorId":970,"metricType":"size"},{"name":"number of output rows","accumulatorId":969,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":974,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":973,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":967,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":961,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":968,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":962,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":959,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":956,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":965,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":958,"metricType":"sum"},{"name":"records read","accumulatorId":955,"metricType":"sum"},{"name":"local bytes read","accumulatorId":953,"metricType":"size"},{"name":"fetch wait time","accumulatorId":954,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":951,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":957,"metricType":"sum"},{"name":"local blocks read","accumulatorId":950,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":960,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":949,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":963,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":964,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":952,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":966,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[946,1],[947,0],[948,566316442]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1043,200]]}
{"Event":"SparkListenerJobStart","Job ID":8,"Submission Time":1747830566894,"Stage Infos":[{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[16],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830566896,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":55,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830566905,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":56,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830566906,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":57,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":58,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":59,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":60,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":61,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":62,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":62,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830577112,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1185193","Value":"1185193","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"87233432","Value":"87233432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"24894639","Value":"24894639","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1185174","Value":"1185174","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"207023766","Value":"207023766","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1185174","Value":"1185174","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"9997","Value":"9997","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2291","Value":"2291","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1185193","Value":"1185193","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2387400,"Value":2387400,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":10178,"Value":10178,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":7623050100,"Value":7623050100,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2759,"Value":2759,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":262,"Value":262,"Internal":true,"Count Failed Values":true},{"ID":1076,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":39845584,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11670212,"Value":11670212,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":24894639,"Value":24894639,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1185174,"Value":1185174,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":207023766,"Value":207023766,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":67119541,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":1185193,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":2387400,"Executor Run Time":10178,"Executor CPU Time":7623050100,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":262,"Result Serialization Time":3,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670212,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":24894639,"Shuffle Write Time":207023766,"Shuffle Records Written":1185174},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":58,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578485,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259279","Value":"2444472","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92680632","Value":"179914064","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26414963","Value":"51309602","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259254","Value":"2444428","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"172081822","Value":"379105588","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259254","Value":"2444428","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11438","Value":"21435","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2376","Value":"4667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259279","Value":"2444472","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":11,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2501200,"Value":4888600,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11568,"Value":21746,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8574257500,"Value":16197307600,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":5475,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":282,"Value":544,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11667727,"Value":23337939,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26414963,"Value":51309602,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259254,"Value":2444428,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":172081822,"Value":379105588,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":138553781,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":2444472,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2501200,"Executor Run Time":11568,"Executor CPU Time":8574257500,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":282,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11667727,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26414963,"Shuffle Write Time":172081822,"Shuffle Records Written":1259254},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":57,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578727,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259254","Value":"3703726","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92682784","Value":"272596848","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26420936","Value":"77730538","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259233","Value":"3703661","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"74953875","Value":"454059463","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259233","Value":"3703661","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11752","Value":"33187","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2833","Value":"7500","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259254","Value":"3703726","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3337000,"Value":8225600,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11806,"Value":33552,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8661677700,"Value":24858985300,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2759,"Value":8234,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":831,"Internal":true,"Count Failed Values":true},{"ID":1076,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":119536752,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11670787,"Value":35008726,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26420936,"Value":77730538,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259233,"Value":3703661,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":74953875,"Value":454059463,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":3703726,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":3337000,"Executor Run Time":11806,"Executor CPU Time":8661677700,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":287,"Result Serialization Time":3,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670787,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26420936,"Shuffle Write Time":74953875,"Shuffle Records Written":1259233},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":59,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830566907,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578832,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259249","Value":"4962975","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92684000","Value":"365280848","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26415198","Value":"104145736","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259223","Value":"4962884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"490698958","Value":"944758421","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259223","Value":"4962884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11477","Value":"44664","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2378","Value":"9878","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259249","Value":"4962975","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":20,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3050500,"Value":11276100,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11916,"Value":45468,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8701616400,"Value":33560601700,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":10950,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1118,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11669904,"Value":46678630,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415198,"Value":104145736,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259223,"Value":4962884,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":490698958,"Value":944758421,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":4962975,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":3050500,"Executor Run Time":11916,"Executor CPU Time":8701616400,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669904,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415198,"Shuffle Write Time":490698958,"Shuffle Records Written":1259223},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":55,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830566905,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578885,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259231","Value":"6222206","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92680320","Value":"457961168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26415883","Value":"130561619","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259209","Value":"6222093","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"531202473","Value":"1475960894","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259209","Value":"6222093","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11512","Value":"56176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2437","Value":"12315","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259231","Value":"6222206","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":28,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6305900,"Value":17582000,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11962,"Value":57430,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8771138000,"Value":42331739700,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":13666,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1405,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":199227920,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11670288,"Value":58348918,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415883,"Value":130561619,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":6222093,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":531202473,"Value":1475960894,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259231,"Value":6222206,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":6305900,"Executor Run Time":11962,"Executor CPU Time":8771138000,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670288,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415883,"Shuffle Write Time":531202473,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259231},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":56,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830566906,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578888,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259294","Value":"7481500","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92679936","Value":"550641104","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26424562","Value":"156986181","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259268","Value":"7481361","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"415626318","Value":"1891587212","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259268","Value":"7481361","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11601","Value":"67777","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2409","Value":"14724","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259294","Value":"7481500","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":11,"Value":39,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3620100,"Value":21202100,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11965,"Value":69395,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8733804300,"Value":51065544000,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":16382,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1692,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11669024,"Value":70017942,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26424562,"Value":156986181,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259268,"Value":7481361,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":415626318,"Value":1891587212,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":7481500,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":11,"Executor Deserialize CPU Time":3620100,"Executor Run Time":11965,"Executor CPU Time":8733804300,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669024,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26424562,"Shuffle Write Time":415626318,"Shuffle Records Written":1259268},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":60,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578899,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259240","Value":"8740740","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92678720","Value":"643319824","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26416951","Value":"183403132","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259209","Value":"8740570","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"336761284","Value":"2228348496","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259209","Value":"8740570","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11672","Value":"79449","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2566","Value":"17290","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259240","Value":"8740740","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":43,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1927300,"Value":23129400,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":11982,"Value":81377,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8833922300,"Value":59899466300,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":19098,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":1979,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":278919088,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11674538,"Value":81692480,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26416951,"Value":183403132,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":8740570,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":336761284,"Value":2228348496,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":8740740,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":1927300,"Executor Run Time":11982,"Executor CPU Time":8833922300,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11674538,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26416951,"Shuffle Write Time":336761284,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":61,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830566908,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830578977,"Failed":false,"Killed":false,"Accumulables":[{"ID":945,"Name":"number of output rows","Update":"1259260","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Update":"92680248","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Update":"26417633","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Update":"1259237","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Update":"928533096","Value":"3156881592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Update":"1259237","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Update":"11143","Value":"90592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Update":"2377","Value":"19667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Update":"1259260","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":50,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2799200,"Value":25928600,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Update":12055,"Value":93432,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Update":8549597800,"Value":68449064100,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Update":2716,"Value":21814,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Update":287,"Value":2266,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Update":11669508,"Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26417633,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259237,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Update":928533096,"Value":3156881592,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":10000000,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":954199584,"JVMOffHeapMemory":180342928,"OnHeapExecutionMemory":432011040,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293551,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":432304591,"OffHeapUnifiedMemory":0,"DirectPoolMemory":8421449,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":387,"MinorGCTime":1588,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1588},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":2799200,"Executor Run Time":12055,"Executor CPU Time":8549597800,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":287,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669508,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26417633,"Shuffle Write Time":928533096,"Shuffle Records Written":1259237},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830566896,"Completion Time":1747830578981,"Accumulables":[{"ID":945,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1042,"Name":"data size","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1061,"Name":"shuffle bytes written","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1062,"Name":"shuffle records written","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1063,"Name":"shuffle write time","Value":"3156881592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1064,"Name":"number of output rows","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1065,"Name":"duration","Value":"90592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1066,"Name":"sort time","Value":"19667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1067,"Name":"peak memory","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1068,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1069,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1070,"Name":"internal.metrics.executorDeserializeTime","Value":50,"Internal":true,"Count Failed Values":true},{"ID":1071,"Name":"internal.metrics.executorDeserializeCpuTime","Value":25928600,"Internal":true,"Count Failed Values":true},{"ID":1072,"Name":"internal.metrics.executorRunTime","Value":93432,"Internal":true,"Count Failed Values":true},{"ID":1073,"Name":"internal.metrics.executorCpuTime","Value":68449064100,"Internal":true,"Count Failed Values":true},{"ID":1074,"Name":"internal.metrics.resultSize","Value":21814,"Internal":true,"Count Failed Values":true},{"ID":1075,"Name":"internal.metrics.jvmGCTime","Value":2266,"Internal":true,"Count Failed Values":true},{"ID":1076,"Name":"internal.metrics.resultSerializationTime","Value":6,"Internal":true,"Count Failed Values":true},{"ID":1077,"Name":"internal.metrics.memoryBytesSpilled","Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1078,"Name":"internal.metrics.diskBytesSpilled","Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":1079,"Name":"internal.metrics.peakExecutionMemory","Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":1098,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1099,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1100,"Name":"internal.metrics.shuffle.write.writeTime","Value":3156881592,"Internal":true,"Count Failed Values":true},{"ID":1101,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":1102,"Name":"internal.metrics.input.recordsRead","Value":10000000,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":8,"Completion Time":1747830578986,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (35)\n+- == Current Plan ==\n   TakeOrderedAndProject (19)\n   +- HashAggregate (18)\n      +- Exchange (17)\n         +- HashAggregate (16)\n            +- HashAggregate (15)\n               +- ShuffleQueryStage (14)\n                  +- Exchange (13)\n                     +- * HashAggregate (12)\n                        +- * Project (11)\n                           +- * Filter (10)\n                              +- SortAggregate (9)\n                                 +- * Sort (8)\n                                    +- AQEShuffleRead (7)\n                                       +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                          +- Exchange (5)\n                                             +- SortAggregate (4)\n                                                +- * Sort (3)\n                                                   +- * Filter (2)\n                                                      +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (34)\n   +- HashAggregate (33)\n      +- Exchange (32)\n         +- HashAggregate (31)\n            +- HashAggregate (30)\n               +- Exchange (29)\n                  +- HashAggregate (28)\n                     +- Project (27)\n                        +- Filter (26)\n                           +- SortAggregate (25)\n                              +- Sort (24)\n                                 +- Exchange (23)\n                                    +- SortAggregate (22)\n                                       +- Sort (21)\n                                          +- Filter (20)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#216, user_id#17]\nArguments: 1\n\n(15) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(16) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(17) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=559]\n\n(18) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(19) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(20) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(21) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(22) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(23) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]\n\n(24) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(26) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(27) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(28) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(29) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]\n\n(30) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(31) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(32) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(34) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(35) AdaptiveSparkPlan\nOutput [2]: [toprettystring(month)#212, toprettystring(mau)#213]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[month#88 ASC NULLS FIRST], output=[toprettystring(month)#212,toprettystring(mau)#213])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[count(distinct user_id#17)])","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=559]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736)]"},"metrics":[{"name":"number of output rows","accumulatorId":945,"metricType":"sum"},{"name":"number of files read","accumulatorId":946,"metricType":"sum"},{"name":"metadata time","accumulatorId":947,"metricType":"timing"},{"name":"size of files read","accumulatorId":948,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1069,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1066,"metricType":"timing"},{"name":"peak memory","accumulatorId":1067,"metricType":"size"},{"name":"spill size","accumulatorId":1068,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1065,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1064,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1062,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1056,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1063,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1057,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1054,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1051,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1060,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1053,"metricType":"sum"},{"name":"records read","accumulatorId":1050,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1048,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1049,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1046,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1052,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1045,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1055,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1044,"metricType":"sum"},{"name":"data size","accumulatorId":1042,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1058,"metricType":"size"},{"name":"number of partitions","accumulatorId":1043,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1059,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1047,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1061,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1200,"metricType":"sum"},{"name":"partition data size","accumulatorId":1201,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1202,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1197,"metricType":"timing"},{"name":"peak memory","accumulatorId":1198,"metricType":"size"},{"name":"spill size","accumulatorId":1199,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1196,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1195,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1194,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1190,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1191,"metricType":"timing"},{"name":"peak memory","accumulatorId":1189,"metricType":"size"},{"name":"number of output rows","accumulatorId":1188,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1193,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1192,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1187,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1185,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1179,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1186,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1180,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1177,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1174,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1183,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1176,"metricType":"sum"},{"name":"records read","accumulatorId":1173,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1171,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1172,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1169,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1175,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1168,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1178,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1167,"metricType":"sum"},{"name":"data size","accumulatorId":1165,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1181,"metricType":"size"},{"name":"number of partitions","accumulatorId":1166,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1182,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1170,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1184,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1161,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1162,"metricType":"timing"},{"name":"peak memory","accumulatorId":1160,"metricType":"size"},{"name":"number of output rows","accumulatorId":1159,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1164,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1163,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1155,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1156,"metricType":"timing"},{"name":"peak memory","accumulatorId":1154,"metricType":"size"},{"name":"number of output rows","accumulatorId":1153,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1158,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1157,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1151,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1145,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1152,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1146,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1143,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1140,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1149,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1142,"metricType":"sum"},{"name":"records read","accumulatorId":1139,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1137,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1138,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1135,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1141,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1134,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1144,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1133,"metricType":"sum"},{"name":"data size","accumulatorId":1131,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1147,"metricType":"size"},{"name":"number of partitions","accumulatorId":1132,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1148,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1136,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1150,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1127,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1128,"metricType":"timing"},{"name":"peak memory","accumulatorId":1126,"metricType":"size"},{"name":"number of output rows","accumulatorId":1125,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1130,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1129,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1123,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1117,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1124,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1118,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1115,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1112,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1121,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1114,"metricType":"sum"},{"name":"records read","accumulatorId":1111,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1109,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1110,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1107,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1113,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1106,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1116,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1105,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1119,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1120,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1108,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1122,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1200,9],[1202,9],[1201,26025333],[1201,27063086],[1201,26026566],[1201,26016692],[1201,26040139],[1201,27063086],[1201,26040139],[1201,26026566],[1201,6491833]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1166,200]]}
{"Event":"SparkListenerJobStart","Job ID":9,"Submission Time":1747830579129,"Stage Infos":[{"Stage ID":17,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"116\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"115\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"110\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"119\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[17],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[17,18],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"116\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"115\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"110\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"119\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[17],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830579133,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":63,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830579146,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":64,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830579148,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":65,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830579150,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":66,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830579151,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":67,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830579152,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":68,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830579152,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":69,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830579153,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":70,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830579153,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":71,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830584423,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":63,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830579146,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584424,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25164830","Value":"25164830","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1199495","Value":"1199495","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"384000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"122487","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"12000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"53379720","Value":"53379720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3013","Value":"3013","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"12000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"2903","Value":"2903","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1199339","Value":"1199339","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1199339","Value":"1199339","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5125","Value":"5125","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1146","Value":"1146","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":15,"Value":15,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":11958800,"Value":11958800,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5235,"Value":5235,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4511716600,"Value":4511716600,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5928,"Value":5928,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":89,"Value":89,"Internal":true,"Count Failed Values":true},{"ID":1209,"Name":"internal.metrics.resultSerializationTime","Update":13,"Value":13,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21293776,"Value":21293776,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":58982080,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25164830,"Value":25164830,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199495,"Value":1199495,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":122487,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":12000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":53379720,"Value":53379720,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":15,"Executor Deserialize CPU Time":11958800,"Executor Run Time":5235,"Executor CPU Time":4511716600,"Peak Execution Memory":58982080,"Result Size":5928,"JVM GC Time":89,"Result Serialization Time":13,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21293776,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25164830,"Total Records Read":1199495,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":53379720,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":67,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830579152,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584641,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25161841","Value":"50326671","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1199182","Value":"2398677","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"768000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"244974","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"24000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"40063776","Value":"93443496","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3313","Value":"6326","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"24000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"4718560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3166","Value":"6069","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"20","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1199024","Value":"2398363","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1199024","Value":"2398363","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5384","Value":"10509","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1098","Value":"2244","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":21,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4542400,"Value":16501200,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5473,"Value":10708,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4662076000,"Value":9173792600,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":11813,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":89,"Value":178,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21288229,"Value":42582005,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":117964160,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25161841,"Value":50326671,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199182,"Value":2398677,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":244974,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":24000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":40063776,"Value":93443496,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":4542400,"Executor Run Time":5473,"Executor CPU Time":4662076000,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":89,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21288229,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25161841,"Total Records Read":1199182,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":40063776,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":69,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830579153,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584724,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25190770","Value":"75517441","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1200749","Value":"3599426","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"1152000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"367461","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"36000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"22247400","Value":"115690896","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3287","Value":"9613","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"36000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"7077840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3250","Value":"9319","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"30","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1200576","Value":"3598939","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1200576","Value":"3598939","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5497","Value":"16006","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1199","Value":"3443","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3726300,"Value":20227500,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5560,"Value":16268,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4594968500,"Value":13768761100,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":17698,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":89,"Value":267,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21290127,"Value":63872132,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":176946240,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25190770,"Value":75517441,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200749,"Value":3599426,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":367461,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":36000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":22247400,"Value":115690896,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":3726300,"Executor Run Time":5560,"Executor CPU Time":4594968500,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":89,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290127,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25190770,"Total Records Read":1200749,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":22247400,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":65,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830579150,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584781,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25206453","Value":"100723894","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1200985","Value":"4800411","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"1536000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"489948","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"48000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"20493816","Value":"136184712","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3441","Value":"13054","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"48000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"9437120","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3330","Value":"12649","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1200824","Value":"4799763","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1200824","Value":"4799763","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5558","Value":"21564","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1080","Value":"4523","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":15,"Value":42,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5404600,"Value":25632100,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5602,"Value":21870,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4632849000,"Value":18401610100,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":23583,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":89,"Value":356,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21295373,"Value":85167505,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":235928320,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25206453,"Value":100723894,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200985,"Value":4800411,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":489948,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":48000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":20493816,"Value":136184712,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":15,"Executor Deserialize CPU Time":5404600,"Executor Run Time":5602,"Executor CPU Time":4632849000,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":89,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21295373,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25206453,"Total Records Read":1200985,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":20493816,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":68,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830579152,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584792,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"26222736","Value":"126946630","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1249666","Value":"6050077","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"1920000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"612435","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"60000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"21636426","Value":"157821138","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3218","Value":"16272","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"60000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"11796400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3175","Value":"15824","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"50","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1249467","Value":"6049230","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1249467","Value":"6049230","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5517","Value":"27081","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1170","Value":"5693","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"398455840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":62,"Value":104,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":17575700,"Value":43207800,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5569,"Value":27439,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4746471600,"Value":23148081700,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":29468,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":92,"Value":448,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":398455840,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21297671,"Value":106465176,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":294910400,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26222736,"Value":126946630,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249666,"Value":6050077,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":612435,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":60000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":21636426,"Value":157821138,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":62,"Executor Deserialize CPU Time":17575700,"Executor Run Time":5569,"Executor CPU Time":4746471600,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":92,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21297671,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26222736,"Total Records Read":1249666,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":21636426,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":64,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830579148,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584861,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"26207403","Value":"153154033","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1249052","Value":"7299129","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"2304000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"734922","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"72000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"13786421","Value":"171607559","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3455","Value":"19727","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"72000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"14155680","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3436","Value":"19260","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"60","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1248877","Value":"7298107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1248877","Value":"7298107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5664","Value":"32745","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1141","Value":"6834","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"478147008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":112,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4189200,"Value":47397000,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5695,"Value":33134,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4876611000,"Value":28024692700,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":35353,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":95,"Value":543,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":478147008,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21298509,"Value":127763685,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":353892480,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26207403,"Value":153154033,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249052,"Value":7299129,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":734922,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":72000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":13786421,"Value":171607559,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":4189200,"Executor Run Time":5695,"Executor CPU Time":4876611000,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":95,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21298509,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26207403,"Total Records Read":1249052,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":13786421,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":70,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830579153,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584937,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"56","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25194724","Value":"178348757","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1200793","Value":"8499922","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"2688000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"857409","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"84000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"12083586","Value":"183691145","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3608","Value":"23335","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"84000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"16514960","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3512","Value":"22772","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"70","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1200616","Value":"8498723","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1200616","Value":"8498723","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5742","Value":"38487","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1152","Value":"7986","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"557838176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":117,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3849700,"Value":51246700,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5774,"Value":38908,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4566885100,"Value":32591577800,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":41238,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":95,"Value":638,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":557838176,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21290320,"Value":149054005,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":412874560,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25194724,"Value":178348757,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200793,"Value":8499922,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":857409,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":84000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":12083586,"Value":183691145,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":3849700,"Executor Run Time":5774,"Executor CPU Time":4566885100,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":95,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290320,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25194724,"Total Records Read":1200793,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":12083586,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":66,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830579151,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830584942,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"25169910","Value":"203518667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"1199408","Value":"9699330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"3072000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"979896","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"96000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"11573633","Value":"195264778","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"3623","Value":"26958","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"96000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"18874240","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"3518","Value":"26290","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"80","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"1199236","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"1199236","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"5739","Value":"44226","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"1090","Value":"9076","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"79691168","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":14,"Value":131,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5591500,"Value":56838200,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":5771,"Value":44679,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":4654469400,"Value":37246047200,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5885,"Value":47123,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":95,"Value":733,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Update":21291736,"Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":58982080,"Value":471856640,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":64,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25169910,"Value":203518667,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199408,"Value":9699330,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":979896,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":96000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":11573633,"Value":195264778,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":939066080,"JVMOffHeapMemory":182408824,"OnHeapExecutionMemory":203422528,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":331093,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":203753621,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":435,"MinorGCTime":1819,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1819},"Task Metrics":{"Executor Deserialize Time":14,"Executor Deserialize CPU Time":5591500,"Executor Run Time":5771,"Executor CPU Time":4654469400,"Peak Execution Memory":58982080,"Result Size":5885,"JVM GC Time":95,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21291736,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25169910,"Total Records Read":1199408,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":11573633,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":71,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830584423,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830585109,"Failed":false,"Killed":false,"Accumulables":[{"ID":1045,"Name":"local blocks read","Update":"8","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Update":"6302098","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Update":"300477","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Update":"384000","Value":"3456000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Update":"122487","Value":"1102383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Update":"12000","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Update":"10322512","Value":"205587290","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Update":"247","Value":"27205","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Update":"12000","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Update":"2359280","Value":"21233520","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Update":"230","Value":"26520","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Update":"10","Value":"90","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Update":"610","Value":"44836","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Update":"150","Value":"9226","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Update":"33554240","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Update":"0","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Update":18,"Value":149,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Update":10430100,"Value":67268300,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Update":660,"Value":45339,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Update":556292600,"Value":37802339800,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Update":5799,"Value":52922,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Update":6,"Value":739,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Update":35913520,"Value":507770160,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":6302098,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Update":300477,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":122487,"Value":1102383,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12000,"Value":108000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Update":10322512,"Value":205587290,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":18,"Executor Deserialize CPU Time":10430100,"Executor Run Time":660,"Executor CPU Time":556292600,"Peak Execution Memory":35913520,"Result Size":5799,"JVM GC Time":6,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":6302098,"Total Records Read":300477,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":122487,"Shuffle Write Time":10322512,"Shuffle Records Written":12000},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"116\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"115\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"110\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"119\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[17],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830579133,"Completion Time":1747830585111,"Accumulables":[{"ID":1045,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1048,"Name":"local bytes read","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1049,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1050,"Name":"records read","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1165,"Name":"data size","Value":"3456000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1184,"Name":"shuffle bytes written","Value":"1102383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1185,"Name":"shuffle records written","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1186,"Name":"shuffle write time","Value":"205587290","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1187,"Name":"duration","Value":"27205","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1188,"Name":"number of output rows","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1189,"Name":"peak memory","Value":"21233520","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1191,"Name":"time in aggregation build","Value":"26520","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1192,"Name":"avg hash probes per key","Value":"90","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1194,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1195,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1196,"Name":"duration","Value":"44836","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1197,"Name":"sort time","Value":"9226","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1198,"Name":"peak memory","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1199,"Name":"spill size","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1203,"Name":"internal.metrics.executorDeserializeTime","Value":149,"Internal":true,"Count Failed Values":true},{"ID":1204,"Name":"internal.metrics.executorDeserializeCpuTime","Value":67268300,"Internal":true,"Count Failed Values":true},{"ID":1205,"Name":"internal.metrics.executorRunTime","Value":45339,"Internal":true,"Count Failed Values":true},{"ID":1206,"Name":"internal.metrics.executorCpuTime","Value":37802339800,"Internal":true,"Count Failed Values":true},{"ID":1207,"Name":"internal.metrics.resultSize","Value":52922,"Internal":true,"Count Failed Values":true},{"ID":1208,"Name":"internal.metrics.jvmGCTime","Value":739,"Internal":true,"Count Failed Values":true},{"ID":1209,"Name":"internal.metrics.resultSerializationTime","Value":13,"Internal":true,"Count Failed Values":true},{"ID":1210,"Name":"internal.metrics.memoryBytesSpilled","Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":1211,"Name":"internal.metrics.diskBytesSpilled","Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":1212,"Name":"internal.metrics.peakExecutionMemory","Value":507770160,"Internal":true,"Count Failed Values":true},{"ID":1214,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1215,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":1216,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1217,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1218,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1219,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1220,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1221,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1222,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1223,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1224,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1225,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1226,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1227,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1228,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1229,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1230,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1231,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":1102383,"Internal":true,"Count Failed Values":true},{"ID":1232,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":108000,"Internal":true,"Count Failed Values":true},{"ID":1233,"Name":"internal.metrics.shuffle.write.writeTime","Value":205587290,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":9,"Completion Time":1747830585112,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (37)\n+- == Current Plan ==\n   TakeOrderedAndProject (21)\n   +- HashAggregate (20)\n      +- ShuffleQueryStage (19)\n         +- Exchange (18)\n            +- * HashAggregate (17)\n               +- * HashAggregate (16)\n                  +- AQEShuffleRead (15)\n                     +- ShuffleQueryStage (14), Statistics(sizeInBytes=3.3 MiB, rowCount=1.08E+5)\n                        +- Exchange (13)\n                           +- * HashAggregate (12)\n                              +- * Project (11)\n                                 +- * Filter (10)\n                                    +- SortAggregate (9)\n                                       +- * Sort (8)\n                                          +- AQEShuffleRead (7)\n                                             +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                +- Exchange (5)\n                                                   +- SortAggregate (4)\n                                                      +- * Sort (3)\n                                                         +- * Filter (2)\n                                                            +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (36)\n   +- HashAggregate (35)\n      +- Exchange (34)\n         +- HashAggregate (33)\n            +- HashAggregate (32)\n               +- Exchange (31)\n                  +- HashAggregate (30)\n                     +- Project (29)\n                        +- Filter (28)\n                           +- SortAggregate (27)\n                              +- Sort (26)\n                                 +- Exchange (25)\n                                    +- SortAggregate (24)\n                                       +- Sort (23)\n                                          +- Filter (22)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#216, user_id#17]\nArguments: 1\n\n(15) AQEShuffleRead\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: coalesced\n\n(16) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(17) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(18) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=579]\n\n(19) ShuffleQueryStage\nOutput [2]: [_groupingexpression#216, count#227L]\nArguments: 2\n\n(20) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(21) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(22) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(23) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(24) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(25) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]\n\n(26) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(27) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(28) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(29) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(30) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(31) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]\n\n(32) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(34) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]\n\n(35) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(36) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(37) AdaptiveSparkPlan\nOutput [2]: [toprettystring(month)#212, toprettystring(mau)#213]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[month#88 ASC NULLS FIRST], output=[toprettystring(month)#212,toprettystring(mau)#213])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[count(distinct user_id#17)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=579]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736)]"},"metrics":[{"name":"number of output rows","accumulatorId":945,"metricType":"sum"},{"name":"number of files read","accumulatorId":946,"metricType":"sum"},{"name":"metadata time","accumulatorId":947,"metricType":"timing"},{"name":"size of files read","accumulatorId":948,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1069,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1066,"metricType":"timing"},{"name":"peak memory","accumulatorId":1067,"metricType":"size"},{"name":"spill size","accumulatorId":1068,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1065,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1064,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1062,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1056,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1063,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1057,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1054,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1051,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1060,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1053,"metricType":"sum"},{"name":"records read","accumulatorId":1050,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1048,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1049,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1046,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1052,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1045,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1055,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1044,"metricType":"sum"},{"name":"data size","accumulatorId":1042,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1058,"metricType":"size"},{"name":"number of partitions","accumulatorId":1043,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1059,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1047,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1061,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1200,"metricType":"sum"},{"name":"partition data size","accumulatorId":1201,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1202,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1197,"metricType":"timing"},{"name":"peak memory","accumulatorId":1198,"metricType":"size"},{"name":"spill size","accumulatorId":1199,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1196,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1195,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1194,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1190,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1191,"metricType":"timing"},{"name":"peak memory","accumulatorId":1189,"metricType":"size"},{"name":"number of output rows","accumulatorId":1188,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1193,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1192,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1187,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1185,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1179,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1186,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1180,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1177,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1174,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1183,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1176,"metricType":"sum"},{"name":"records read","accumulatorId":1173,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1171,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1172,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1169,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1175,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1168,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1178,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1167,"metricType":"sum"},{"name":"data size","accumulatorId":1165,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1181,"metricType":"size"},{"name":"number of partitions","accumulatorId":1166,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1182,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1170,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1184,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1299,"metricType":"sum"},{"name":"partition data size","accumulatorId":1300,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1301,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1295,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1296,"metricType":"timing"},{"name":"peak memory","accumulatorId":1294,"metricType":"size"},{"name":"number of output rows","accumulatorId":1293,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1298,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1297,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1289,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1290,"metricType":"timing"},{"name":"peak memory","accumulatorId":1288,"metricType":"size"},{"name":"number of output rows","accumulatorId":1287,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1292,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1291,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1286,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1284,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1278,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1285,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1279,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1276,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1273,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1282,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1275,"metricType":"sum"},{"name":"records read","accumulatorId":1272,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1270,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1271,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1268,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1274,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1267,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1277,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1266,"metricType":"sum"},{"name":"data size","accumulatorId":1264,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1280,"metricType":"size"},{"name":"number of partitions","accumulatorId":1265,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1281,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1269,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1283,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1260,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1261,"metricType":"timing"},{"name":"peak memory","accumulatorId":1259,"metricType":"size"},{"name":"number of output rows","accumulatorId":1258,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1263,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1262,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1256,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1250,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1257,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1251,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1248,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1245,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1254,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1247,"metricType":"sum"},{"name":"records read","accumulatorId":1244,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1242,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1243,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1240,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1246,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1239,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1249,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1238,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1252,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1253,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1241,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1255,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1299,1],[1301,1],[1300,1157382]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1265,200]]}
{"Event":"SparkListenerJobStart","Job ID":10,"Submission Time":1747830585184,"Stage Infos":[{"Stage ID":19,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":20,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"116\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"115\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"110\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"119\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[19],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"125\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[52],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"121\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[19,20,21],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"125\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[52],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"121\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830585188,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":21,"Stage Attempt ID":0,"Task Info":{"Task ID":72,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830585207,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":21,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":72,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830585207,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830585433,"Failed":false,"Killed":false,"Accumulables":[{"ID":1168,"Name":"local blocks read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1171,"Name":"local bytes read","Update":"1102383","Value":"1102383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1172,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1173,"Name":"records read","Update":"108000","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1264,"Name":"data size","Update":"288","Value":"288","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1283,"Name":"shuffle bytes written","Update":"802","Value":"802","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1284,"Name":"shuffle records written","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1285,"Name":"shuffle write time","Update":"6111408","Value":"6111408","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1286,"Name":"duration","Update":"149","Value":"149","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1287,"Name":"number of output rows","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1288,"Name":"peak memory","Update":"262144","Value":"262144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1290,"Name":"time in aggregation build","Update":"105","Value":"105","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1293,"Name":"number of output rows","Update":"12000","Value":"12000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1294,"Name":"peak memory","Update":"2359280","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1296,"Name":"time in aggregation build","Update":"89","Value":"89","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1297,"Name":"avg hash probes per key","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1302,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":1303,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6945700,"Value":6945700,"Internal":true,"Count Failed Values":true},{"ID":1304,"Name":"internal.metrics.executorRunTime","Update":210,"Value":210,"Internal":true,"Count Failed Values":true},{"ID":1305,"Name":"internal.metrics.executorCpuTime","Update":202386000,"Value":202386000,"Internal":true,"Count Failed Values":true},{"ID":1306,"Name":"internal.metrics.resultSize","Update":7716,"Value":7716,"Internal":true,"Count Failed Values":true},{"ID":1311,"Name":"internal.metrics.peakExecutionMemory","Update":2621424,"Value":2621424,"Internal":true,"Count Failed Values":true},{"ID":1313,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1314,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":1315,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1316,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1317,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":1102383,"Value":1102383,"Internal":true,"Count Failed Values":true},{"ID":1318,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1319,"Name":"internal.metrics.shuffle.read.recordsRead","Update":108000,"Value":108000,"Internal":true,"Count Failed Values":true},{"ID":1320,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1321,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1322,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1323,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1324,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1325,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1326,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1327,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1328,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1329,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1330,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":802,"Value":802,"Internal":true,"Count Failed Values":true},{"ID":1331,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":12,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":1332,"Name":"internal.metrics.shuffle.write.writeTime","Update":6111408,"Value":6111408,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":6945700,"Executor Run Time":210,"Executor CPU Time":202386000,"Peak Execution Memory":2621424,"Result Size":7716,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":1102383,"Total Records Read":108000,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":802,"Shuffle Write Time":6111408,"Shuffle Records Written":12},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"125\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[52],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"121\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830585188,"Completion Time":1747830585435,"Accumulables":[{"ID":1168,"Name":"local blocks read","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1171,"Name":"local bytes read","Value":"1102383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1172,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1173,"Name":"records read","Value":"108000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1264,"Name":"data size","Value":"288","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1283,"Name":"shuffle bytes written","Value":"802","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1284,"Name":"shuffle records written","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1285,"Name":"shuffle write time","Value":"6111408","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1286,"Name":"duration","Value":"149","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1287,"Name":"number of output rows","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1288,"Name":"peak memory","Value":"262144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1290,"Name":"time in aggregation build","Value":"105","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1293,"Name":"number of output rows","Value":"12000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1294,"Name":"peak memory","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1296,"Name":"time in aggregation build","Value":"89","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1297,"Name":"avg hash probes per key","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1302,"Name":"internal.metrics.executorDeserializeTime","Value":7,"Internal":true,"Count Failed Values":true},{"ID":1303,"Name":"internal.metrics.executorDeserializeCpuTime","Value":6945700,"Internal":true,"Count Failed Values":true},{"ID":1304,"Name":"internal.metrics.executorRunTime","Value":210,"Internal":true,"Count Failed Values":true},{"ID":1305,"Name":"internal.metrics.executorCpuTime","Value":202386000,"Internal":true,"Count Failed Values":true},{"ID":1306,"Name":"internal.metrics.resultSize","Value":7716,"Internal":true,"Count Failed Values":true},{"ID":1311,"Name":"internal.metrics.peakExecutionMemory","Value":2621424,"Internal":true,"Count Failed Values":true},{"ID":1313,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1314,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":9,"Internal":true,"Count Failed Values":true},{"ID":1315,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1316,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1317,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":1102383,"Internal":true,"Count Failed Values":true},{"ID":1318,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1319,"Name":"internal.metrics.shuffle.read.recordsRead","Value":108000,"Internal":true,"Count Failed Values":true},{"ID":1320,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1321,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1322,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1323,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1324,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1325,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1326,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1327,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1328,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1329,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1330,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":802,"Internal":true,"Count Failed Values":true},{"ID":1331,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":12,"Internal":true,"Count Failed Values":true},{"ID":1332,"Name":"internal.metrics.shuffle.write.writeTime","Value":6111408,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":10,"Completion Time":1747830585437,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (38)\n+- == Final Plan ==\n   TakeOrderedAndProject (22)\n   +- * HashAggregate (21)\n      +- AQEShuffleRead (20)\n         +- ShuffleQueryStage (19), Statistics(sizeInBytes=288.0 B, rowCount=12)\n            +- Exchange (18)\n               +- * HashAggregate (17)\n                  +- * HashAggregate (16)\n                     +- AQEShuffleRead (15)\n                        +- ShuffleQueryStage (14), Statistics(sizeInBytes=3.3 MiB, rowCount=1.08E+5)\n                           +- Exchange (13)\n                              +- * HashAggregate (12)\n                                 +- * Project (11)\n                                    +- * Filter (10)\n                                       +- SortAggregate (9)\n                                          +- * Sort (8)\n                                             +- AQEShuffleRead (7)\n                                                +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                   +- Exchange (5)\n                                                      +- SortAggregate (4)\n                                                         +- * Sort (3)\n                                                            +- * Filter (2)\n                                                               +- Scan csv  (1)\n+- == Initial Plan ==\n   TakeOrderedAndProject (37)\n   +- HashAggregate (36)\n      +- Exchange (35)\n         +- HashAggregate (34)\n            +- HashAggregate (33)\n               +- Exchange (32)\n                  +- HashAggregate (31)\n                     +- Project (30)\n                        +- Filter (29)\n                           +- SortAggregate (28)\n                              +- Sort (27)\n                                 +- Exchange (26)\n                                    +- SortAggregate (25)\n                                       +- Sort (24)\n                                          +- Filter (23)\n                                             +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(12) HashAggregate [codegen id : 3]\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(13) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]\n\n(14) ShuffleQueryStage\nOutput [2]: [_groupingexpression#216, user_id#17]\nArguments: 1\n\n(15) AQEShuffleRead\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: coalesced\n\n(16) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(17) HashAggregate [codegen id : 4]\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(18) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=579]\n\n(19) ShuffleQueryStage\nOutput [2]: [_groupingexpression#216, count#227L]\nArguments: 2\n\n(20) AQEShuffleRead\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: coalesced\n\n(21) HashAggregate [codegen id : 5]\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(22) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(23) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))\n\n(24) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#229, valueSet#230, first#231, valueSet#232]\nResults [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\n\n(26) Exchange\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=410]\n\n(27) Sort\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(28) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#233, valueSet#234, first#235, valueSet#236]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#217, first(duration_ms#21)()#221]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#217 AS action_type#218, first(duration_ms#21)()#221 AS duration_ms#222]\n\n(29) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\nCondition : (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))\n\n(30) Project\nOutput [2]: [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]\nInput [4]: [user_id#17, timestamp#30, action_type#218, duration_ms#222]\n\n(31) HashAggregate\nInput [2]: [user_id#17, _groupingexpression#216]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(32) Exchange\nInput [2]: [_groupingexpression#216, user_id#17]\nArguments: hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=417]\n\n(33) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [2]: [_groupingexpression#216, user_id#17]\nFunctions: []\nAggregate Attributes: []\nResults [2]: [_groupingexpression#216, user_id#17]\n\n(34) HashAggregate\nInput [2]: [_groupingexpression#216, user_id#17]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [partial_count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216, count#227L]\n\n(35) Exchange\nInput [2]: [_groupingexpression#216, count#227L]\nArguments: hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=421]\n\n(36) HashAggregate\nInput [2]: [_groupingexpression#216, count#227L]\nKeys [1]: [_groupingexpression#216]\nFunctions [1]: [count(distinct user_id#17)]\nAggregate Attributes [1]: [count(user_id#17)#94L]\nResults [2]: [_groupingexpression#216 AS month#88, count(user_id#17)#94L AS mau#93L]\n\n(37) TakeOrderedAndProject\nInput [2]: [month#88, mau#93L]\nArguments: 21, [month#88 ASC NULLS FIRST], [toprettystring(month#88, Some(Asia/Hong_Kong)) AS toprettystring(month)#212, toprettystring(mau#93L, Some(Asia/Hong_Kong)) AS toprettystring(mau)#213]\n\n(38) AdaptiveSparkPlan\nOutput [2]: [toprettystring(month)#212, toprettystring(mau)#213]\nArguments: isFinalPlan=true\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[month#88 ASC NULLS FIRST], output=[toprettystring(month)#212,toprettystring(mau)#213])","children":[{"nodeName":"WholeStageCodegen (5)","simpleString":"WholeStageCodegen (5)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[count(distinct user_id#17)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, 200), ENSURE_REQUIREMENTS, [plan_id=579]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216], functions=[partial_count(distinct user_id#17)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(_groupingexpression#216, user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=538]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[_groupingexpression#216, user_id#17], functions=[])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, date_trunc(month, timestamp#30, Some(Asia/Hong_Kong)) AS _groupingexpression#216]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#222) AND ((action_type#218 IN (create,edit,share,page_view,delete) AND (duration_ms#222 >= -127618)) AND (duration_ms#222 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=456]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:26.73736)]"},"metrics":[{"name":"number of output rows","accumulatorId":945,"metricType":"sum"},{"name":"number of files read","accumulatorId":946,"metricType":"sum"},{"name":"metadata time","accumulatorId":947,"metricType":"timing"},{"name":"size of files read","accumulatorId":948,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1069,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1066,"metricType":"timing"},{"name":"peak memory","accumulatorId":1067,"metricType":"size"},{"name":"spill size","accumulatorId":1068,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1065,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1064,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1062,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1056,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1063,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1057,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1054,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1051,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1060,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1053,"metricType":"sum"},{"name":"records read","accumulatorId":1050,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1048,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1049,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1046,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1052,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1045,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1055,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1044,"metricType":"sum"},{"name":"data size","accumulatorId":1042,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1058,"metricType":"size"},{"name":"number of partitions","accumulatorId":1043,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1059,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1047,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1061,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1200,"metricType":"sum"},{"name":"partition data size","accumulatorId":1201,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1202,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1197,"metricType":"timing"},{"name":"peak memory","accumulatorId":1198,"metricType":"size"},{"name":"spill size","accumulatorId":1199,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1196,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1195,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1194,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1190,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1191,"metricType":"timing"},{"name":"peak memory","accumulatorId":1189,"metricType":"size"},{"name":"number of output rows","accumulatorId":1188,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1193,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1192,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1187,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1185,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1179,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1186,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1180,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1177,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1174,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1183,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1176,"metricType":"sum"},{"name":"records read","accumulatorId":1173,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1171,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1172,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1169,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1175,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1168,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1178,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1167,"metricType":"sum"},{"name":"data size","accumulatorId":1165,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1181,"metricType":"size"},{"name":"number of partitions","accumulatorId":1166,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1182,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1170,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1184,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1299,"metricType":"sum"},{"name":"partition data size","accumulatorId":1300,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1301,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1295,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1296,"metricType":"timing"},{"name":"peak memory","accumulatorId":1294,"metricType":"size"},{"name":"number of output rows","accumulatorId":1293,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1298,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1297,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1289,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1290,"metricType":"timing"},{"name":"peak memory","accumulatorId":1288,"metricType":"size"},{"name":"number of output rows","accumulatorId":1287,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1292,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1291,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1286,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1284,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1278,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1285,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1279,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1276,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1273,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1282,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1275,"metricType":"sum"},{"name":"records read","accumulatorId":1272,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1270,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1271,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1268,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1274,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1267,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1277,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1266,"metricType":"sum"},{"name":"data size","accumulatorId":1264,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1280,"metricType":"size"},{"name":"number of partitions","accumulatorId":1265,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1281,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1269,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1283,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1364,"metricType":"sum"},{"name":"partition data size","accumulatorId":1365,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1366,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1360,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1361,"metricType":"timing"},{"name":"peak memory","accumulatorId":1359,"metricType":"size"},{"name":"number of output rows","accumulatorId":1358,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1363,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1362,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1357,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1355,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1349,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1356,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1350,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1347,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1344,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1353,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1346,"metricType":"sum"},{"name":"records read","accumulatorId":1343,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1341,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1342,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1339,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1345,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1338,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1348,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1337,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1351,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1352,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1340,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1354,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[1364,1],[1366,1],[1365,858]]}
{"Event":"SparkListenerJobStart","Job ID":11,"Submission Time":1747830585588,"Stage Infos":[{"Stage ID":24,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"120\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"125\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[52],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"121\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[23],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":25,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"130\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[57],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[24],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":22,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"102\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"103\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[45],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"104\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"FileScanRDD","Scope":"{\"id\":\"108\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":23,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"109\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"116\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"115\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"110\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"119\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[22],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[24,25,22,23],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":25,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"130\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[57],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[24],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830585592,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"2","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"2","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":25,"Stage Attempt ID":0,"Task Info":{"Task ID":73,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830585625,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":25,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":73,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830585625,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830585693,"Failed":false,"Killed":false,"Accumulables":[{"ID":1267,"Name":"local blocks read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1270,"Name":"local bytes read","Update":"802","Value":"802","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1271,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1272,"Name":"records read","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1357,"Name":"duration","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1358,"Name":"number of output rows","Update":"12","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1359,"Name":"peak memory","Update":"2359280","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1361,"Name":"time in aggregation build","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1362,"Name":"avg hash probes per key","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1367,"Name":"internal.metrics.executorDeserializeTime","Update":26,"Value":26,"Internal":true,"Count Failed Values":true},{"ID":1368,"Name":"internal.metrics.executorDeserializeCpuTime","Update":25365900,"Value":25365900,"Internal":true,"Count Failed Values":true},{"ID":1369,"Name":"internal.metrics.executorRunTime","Update":31,"Value":31,"Internal":true,"Count Failed Values":true},{"ID":1370,"Name":"internal.metrics.executorCpuTime","Update":30050900,"Value":30050900,"Internal":true,"Count Failed Values":true},{"ID":1371,"Name":"internal.metrics.resultSize","Update":9438,"Value":9438,"Internal":true,"Count Failed Values":true},{"ID":1376,"Name":"internal.metrics.peakExecutionMemory","Update":2359280,"Value":2359280,"Internal":true,"Count Failed Values":true},{"ID":1378,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1379,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":1380,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1381,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1382,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":802,"Value":802,"Internal":true,"Count Failed Values":true},{"ID":1383,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1384,"Name":"internal.metrics.shuffle.read.recordsRead","Update":12,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":1385,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1386,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1387,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1388,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1389,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1390,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1391,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1392,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1393,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1394,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":26,"Executor Deserialize CPU Time":25365900,"Executor Run Time":31,"Executor CPU Time":30050900,"Peak Execution Memory":2359280,"Result Size":9438,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":1,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":802,"Total Records Read":12,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":25,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"130\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[57],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[24],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830585592,"Completion Time":1747830585694,"Accumulables":[{"ID":1267,"Name":"local blocks read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1270,"Name":"local bytes read","Value":"802","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1271,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1272,"Name":"records read","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1357,"Name":"duration","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1358,"Name":"number of output rows","Value":"12","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1359,"Name":"peak memory","Value":"2359280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1361,"Name":"time in aggregation build","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1362,"Name":"avg hash probes per key","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1367,"Name":"internal.metrics.executorDeserializeTime","Value":26,"Internal":true,"Count Failed Values":true},{"ID":1368,"Name":"internal.metrics.executorDeserializeCpuTime","Value":25365900,"Internal":true,"Count Failed Values":true},{"ID":1369,"Name":"internal.metrics.executorRunTime","Value":31,"Internal":true,"Count Failed Values":true},{"ID":1370,"Name":"internal.metrics.executorCpuTime","Value":30050900,"Internal":true,"Count Failed Values":true},{"ID":1371,"Name":"internal.metrics.resultSize","Value":9438,"Internal":true,"Count Failed Values":true},{"ID":1376,"Name":"internal.metrics.peakExecutionMemory","Value":2359280,"Internal":true,"Count Failed Values":true},{"ID":1378,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1379,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":1,"Internal":true,"Count Failed Values":true},{"ID":1380,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1381,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1382,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":802,"Internal":true,"Count Failed Values":true},{"ID":1383,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1384,"Name":"internal.metrics.shuffle.read.recordsRead","Value":12,"Internal":true,"Count Failed Values":true},{"ID":1385,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1386,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1387,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1388,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1389,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1390,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1391,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1392,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1393,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1394,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":11,"Completion Time":1747830585695,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":2,"time":1747830585724,"errorMessage":""}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":3,"rootExecutionId":3,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (19)\n+- CollectLimit (18)\n   +- HashAggregate (17)\n      +- HashAggregate (16)\n         +- Project (15)\n            +- Window (14)\n               +- Project (13)\n                  +- Window (12)\n                     +- Sort (11)\n                        +- Exchange (10)\n                           +- Project (9)\n                              +- Filter (8)\n                                 +- SortAggregate (7)\n                                    +- Sort (6)\n                                       +- Exchange (5)\n                                          +- SortAggregate (4)\n                                             +- Sort (3)\n                                                +- Filter (2)\n                                                   +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(3) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=672]\n\n(6) Sort\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(7) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(8) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(9) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(10) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=678]\n\n(11) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(12) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(13) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(14) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(15) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(16) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(17) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(18) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(19) AdaptiveSparkPlan\nOutput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"CollectLimit","simpleString":"CollectLimit 21","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#283), count(action_type#279)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#283), partial_count(action_type#279)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#283, action_type#279, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=678]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=672]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011)]"},"metrics":[{"name":"number of output rows","accumulatorId":1493,"metricType":"sum"},{"name":"number of files read","accumulatorId":1494,"metricType":"sum"},{"name":"metadata time","accumulatorId":1495,"metricType":"timing"},{"name":"size of files read","accumulatorId":1496,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1492,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1489,"metricType":"timing"},{"name":"peak memory","accumulatorId":1490,"metricType":"size"},{"name":"spill size","accumulatorId":1491,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1488,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1486,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1480,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1487,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1481,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1478,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1475,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1484,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1477,"metricType":"sum"},{"name":"records read","accumulatorId":1474,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1472,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1473,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1470,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1476,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1469,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1479,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1468,"metricType":"sum"},{"name":"data size","accumulatorId":1466,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1482,"metricType":"size"},{"name":"number of partitions","accumulatorId":1467,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1483,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1471,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1485,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1463,"metricType":"timing"},{"name":"peak memory","accumulatorId":1464,"metricType":"size"},{"name":"spill size","accumulatorId":1465,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1462,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1461,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1459,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1453,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1460,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1454,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1451,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1448,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1457,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1450,"metricType":"sum"},{"name":"records read","accumulatorId":1447,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1445,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1446,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1443,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1449,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1442,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1452,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1441,"metricType":"sum"},{"name":"data size","accumulatorId":1439,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1455,"metricType":"size"},{"name":"number of partitions","accumulatorId":1440,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1456,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1444,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1458,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1436,"metricType":"timing"},{"name":"peak memory","accumulatorId":1437,"metricType":"size"},{"name":"spill size","accumulatorId":1438,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1435,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1434,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1430,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1431,"metricType":"timing"},{"name":"peak memory","accumulatorId":1429,"metricType":"size"},{"name":"number of output rows","accumulatorId":1428,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1433,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1432,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1424,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1425,"metricType":"timing"},{"name":"peak memory","accumulatorId":1423,"metricType":"size"},{"name":"number of output rows","accumulatorId":1422,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1427,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1426,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1420,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1414,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1421,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1415,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1412,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1409,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1418,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1411,"metricType":"sum"},{"name":"records read","accumulatorId":1408,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1406,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1407,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1404,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1410,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1403,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1413,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1402,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1416,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1417,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1405,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1419,"metricType":"size"}]}],"metadata":{},"metrics":[]},"time":1747830586026,"modifiedConfigs":{"spark.sql.session.timeZone":"Asia/Hong_Kong"},"jobTags":[]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":3,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (37)\n+- == Current Plan ==\n   CollectLimit (19)\n   +- HashAggregate (18)\n      +- HashAggregate (17)\n         +- Project (16)\n            +- Window (15)\n               +- Project (14)\n                  +- Window (13)\n                     +- Sort (12)\n                        +- Exchange (11)\n                           +- Project (10)\n                              +- Filter (9)\n                                 +- SortAggregate (8)\n                                    +- Sort (7)\n                                       +- ShuffleQueryStage (6)\n                                          +- Exchange (5)\n                                             +- SortAggregate (4)\n                                                +- * Sort (3)\n                                                   +- * Filter (2)\n                                                      +- Scan csv  (1)\n+- == Initial Plan ==\n   CollectLimit (36)\n   +- HashAggregate (35)\n      +- HashAggregate (34)\n         +- Project (33)\n            +- Window (32)\n               +- Project (31)\n                  +- Window (30)\n                     +- Sort (29)\n                        +- Exchange (28)\n                           +- Project (27)\n                              +- Filter (26)\n                                 +- SortAggregate (25)\n                                    +- Sort (24)\n                                       +- Exchange (23)\n                                          +- SortAggregate (22)\n                                             +- Sort (21)\n                                                +- Filter (20)\n                                                   +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: 0\n\n(7) Sort\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(8) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(9) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(10) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(11) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=727]\n\n(12) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(13) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(14) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(15) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(16) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(17) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(18) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(19) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(20) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(21) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(22) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(23) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=672]\n\n(24) Sort\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(26) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(27) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(28) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=678]\n\n(29) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(30) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(31) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(32) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(33) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(34) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(35) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(36) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(37) AdaptiveSparkPlan\nOutput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"CollectLimit","simpleString":"CollectLimit 21","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#283), count(action_type#279)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#283), partial_count(action_type#279)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#283, action_type#279, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=727]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011)]"},"metrics":[{"name":"number of output rows","accumulatorId":1493,"metricType":"sum"},{"name":"number of files read","accumulatorId":1494,"metricType":"sum"},{"name":"metadata time","accumulatorId":1495,"metricType":"timing"},{"name":"size of files read","accumulatorId":1496,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1588,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1585,"metricType":"timing"},{"name":"peak memory","accumulatorId":1586,"metricType":"size"},{"name":"spill size","accumulatorId":1587,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1584,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1583,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1581,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1575,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1582,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1576,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1573,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1570,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1579,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1572,"metricType":"sum"},{"name":"records read","accumulatorId":1569,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1567,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1568,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1565,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1571,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1564,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1574,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1563,"metricType":"sum"},{"name":"data size","accumulatorId":1561,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1577,"metricType":"size"},{"name":"number of partitions","accumulatorId":1562,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1578,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1566,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1580,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1558,"metricType":"timing"},{"name":"peak memory","accumulatorId":1559,"metricType":"size"},{"name":"spill size","accumulatorId":1560,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1557,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1556,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1554,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1548,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1555,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1549,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1546,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1543,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1552,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1545,"metricType":"sum"},{"name":"records read","accumulatorId":1542,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1540,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1541,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1538,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1544,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1537,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1547,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1536,"metricType":"sum"},{"name":"data size","accumulatorId":1534,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1550,"metricType":"size"},{"name":"number of partitions","accumulatorId":1535,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1551,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1539,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1553,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1531,"metricType":"timing"},{"name":"peak memory","accumulatorId":1532,"metricType":"size"},{"name":"spill size","accumulatorId":1533,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1530,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1529,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1525,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1526,"metricType":"timing"},{"name":"peak memory","accumulatorId":1524,"metricType":"size"},{"name":"number of output rows","accumulatorId":1523,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1528,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1527,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1519,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1520,"metricType":"timing"},{"name":"peak memory","accumulatorId":1518,"metricType":"size"},{"name":"number of output rows","accumulatorId":1517,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1522,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1521,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1515,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1509,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1516,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1510,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1507,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1504,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1513,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1506,"metricType":"sum"},{"name":"records read","accumulatorId":1503,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1501,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1502,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1499,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1505,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1498,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1508,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1497,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1511,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1512,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1500,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1514,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[1494,1],[1495,0],[1496,566316442]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[1562,200]]}
{"Event":"SparkListenerJobStart","Job ID":12,"Submission Time":1747830586098,"Stage Infos":[{"Stage ID":26,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"149\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"FileScanRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"150\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[61],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[26],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":26,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"149\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"FileScanRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"150\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[61],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830586101,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":74,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830586110,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":75,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830586111,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":76,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":77,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":78,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":79,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":80,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830586113,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":26,"Stage Attempt ID":0,"Task Info":{"Task ID":81,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830586113,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":75,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830586111,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830600142,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259294","Value":"1259294","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92679936","Value":"92679936","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26424562","Value":"26424562","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259268","Value":"1259268","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"201328019","Value":"201328019","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259268","Value":"1259268","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"14873","Value":"14873","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"3890","Value":"3890","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259294","Value":"1259294","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2512300,"Value":2512300,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15017,"Value":15017,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":10884851700,"Value":10884851700,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":2716,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":320,"Value":320,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":39845584,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11669024,"Value":11669024,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26424562,"Value":26424562,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259268,"Value":1259268,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":201328019,"Value":201328019,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":71434240,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":1259294,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2512300,"Executor Run Time":15017,"Executor CPU Time":10884851700,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":320,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669024,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26424562,"Shuffle Write Time":201328019,"Shuffle Records Written":1259268},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":81,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830586113,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830600339,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1185193","Value":"2444487","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"87233432","Value":"179913368","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"24894639","Value":"51319201","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1185174","Value":"2444442","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"443860820","Value":"645188839","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1185174","Value":"2444442","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15131","Value":"30004","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"3650","Value":"7540","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1185193","Value":"2444487","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5523200,"Value":8035500,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15215,"Value":30232,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":10651496200,"Value":21536347900,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":5432,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":324,"Value":644,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11670212,"Value":23339236,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":24894639,"Value":51319201,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1185174,"Value":2444442,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":443860820,"Value":645188839,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":138553781,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":2444487,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":5523200,"Executor Run Time":15215,"Executor CPU Time":10651496200,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":324,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670212,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":24894639,"Shuffle Write Time":443860820,"Shuffle Records Written":1185174},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":79,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830600415,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259240","Value":"3703727","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92678720","Value":"272592088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26416951","Value":"77736152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259209","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"257081430","Value":"902270269","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259209","Value":"3703651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15207","Value":"45211","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"3832","Value":"11372","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259240","Value":"3703727","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":3,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2958000,"Value":10993500,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15293,"Value":45525,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":11128755100,"Value":32665103000,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":8148,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":324,"Value":968,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":119536752,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11674538,"Value":35013774,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26416951,"Value":77736152,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":3703651,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":257081430,"Value":902270269,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":3703727,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":3,"Executor Deserialize CPU Time":2958000,"Executor Run Time":15293,"Executor CPU Time":11128755100,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":324,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11674538,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26416951,"Shuffle Write Time":257081430,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":76,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830600698,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259254","Value":"4962981","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92682784","Value":"365274872","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26420936","Value":"104157088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259233","Value":"4962884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"200610578","Value":"1102880847","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259233","Value":"4962884","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15493","Value":"60704","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"3986","Value":"15358","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259254","Value":"4962981","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":13,"Value":25,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5831700,"Value":16825200,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15564,"Value":61089,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":10790304000,"Value":43455407000,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2759,"Value":10907,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":332,"Value":1300,"Internal":true,"Count Failed Values":true},{"ID":1595,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11670787,"Value":46684561,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26420936,"Value":104157088,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259233,"Value":4962884,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":200610578,"Value":1102880847,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":4962981,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":13,"Executor Deserialize CPU Time":5831700,"Executor Run Time":15564,"Executor CPU Time":10790304000,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":332,"Result Serialization Time":3,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670787,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26420936,"Shuffle Write Time":200610578,"Shuffle Records Written":1259233},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":78,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830600836,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259249","Value":"6222230","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92684000","Value":"457958872","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26415198","Value":"130572286","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259223","Value":"6222107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"331911228","Value":"1434792075","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259223","Value":"6222107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15596","Value":"76300","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"4283","Value":"19641","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259249","Value":"6222230","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5757200,"Value":22582400,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15710,"Value":76799,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":10753814900,"Value":54209221900,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":13623,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":332,"Value":1632,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":199227920,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11669904,"Value":58354465,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415198,"Value":130572286,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259223,"Value":6222107,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":331911228,"Value":1434792075,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":6222230,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":5757200,"Executor Run Time":15710,"Executor CPU Time":10753814900,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":332,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669904,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415198,"Shuffle Write Time":331911228,"Shuffle Records Written":1259223},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":74,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830586110,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830601062,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259231","Value":"7481461","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92680320","Value":"550639192","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26415883","Value":"156988169","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259209","Value":"7481316","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"171979183","Value":"1606771258","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259209","Value":"7481316","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15866","Value":"92166","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"4191","Value":"23832","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259231","Value":"7481461","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":6,"Value":38,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4222800,"Value":26805200,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":15939,"Value":92738,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":11120130200,"Value":65329352100,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":16339,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":335,"Value":1967,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11670288,"Value":70024753,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415883,"Value":156988169,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":7481316,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":171979183,"Value":1606771258,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259231,"Value":7481461,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":6,"Executor Deserialize CPU Time":4222800,"Executor Run Time":15939,"Executor CPU Time":11120130200,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":335,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670288,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415883,"Shuffle Write Time":171979183,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259231},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":80,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830586113,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830601161,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259260","Value":"8740721","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92680248","Value":"643319440","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26417633","Value":"183405802","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259237","Value":"8740553","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"167924808","Value":"1774696066","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259237","Value":"8740553","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15977","Value":"108143","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"4511","Value":"28343","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259260","Value":"8740721","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":10,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3646100,"Value":30451300,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":16034,"Value":108772,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":11052426300,"Value":76381778400,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":19055,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":338,"Value":2305,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":278919088,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11669508,"Value":81694261,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26417633,"Value":183405802,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259237,"Value":8740553,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":167924808,"Value":1774696066,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":8740721,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":10,"Executor Deserialize CPU Time":3646100,"Executor Run Time":16034,"Executor CPU Time":11052426300,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":338,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669508,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26417633,"Shuffle Write Time":167924808,"Shuffle Records Written":1259237},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":26,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":77,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830586112,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830601170,"Failed":false,"Killed":false,"Accumulables":[{"ID":1493,"Name":"number of output rows","Update":"1259279","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Update":"92680632","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Update":"26414963","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Update":"1259254","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Update":"222934264","Value":"1997630330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Update":"1259254","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Update":"15986","Value":"124129","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Update":"4580","Value":"32923","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Update":"1259279","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":55,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6895800,"Value":37347100,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Update":16047,"Value":124819,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Update":10968948900,"Value":87350727300,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Update":2716,"Value":21771,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Update":338,"Value":2643,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Update":11667727,"Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26414963,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259254,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Update":222934264,"Value":1997630330,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":10000000,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":804892864,"JVMOffHeapMemory":186164856,"OnHeapExecutionMemory":215791477,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293547,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":216085024,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":468,"MinorGCTime":1941,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":1941},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":6895800,"Executor Run Time":16047,"Executor CPU Time":10968948900,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":338,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11667727,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26414963,"Shuffle Write Time":222934264,"Shuffle Records Written":1259254},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":26,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"149\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"FileScanRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"150\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[61],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830586101,"Completion Time":1747830601171,"Accumulables":[{"ID":1493,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1561,"Name":"data size","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1580,"Name":"shuffle bytes written","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1581,"Name":"shuffle records written","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1582,"Name":"shuffle write time","Value":"1997630330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1583,"Name":"number of output rows","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1584,"Name":"duration","Value":"124129","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1585,"Name":"sort time","Value":"32923","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1586,"Name":"peak memory","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1587,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1588,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1589,"Name":"internal.metrics.executorDeserializeTime","Value":55,"Internal":true,"Count Failed Values":true},{"ID":1590,"Name":"internal.metrics.executorDeserializeCpuTime","Value":37347100,"Internal":true,"Count Failed Values":true},{"ID":1591,"Name":"internal.metrics.executorRunTime","Value":124819,"Internal":true,"Count Failed Values":true},{"ID":1592,"Name":"internal.metrics.executorCpuTime","Value":87350727300,"Internal":true,"Count Failed Values":true},{"ID":1593,"Name":"internal.metrics.resultSize","Value":21771,"Internal":true,"Count Failed Values":true},{"ID":1594,"Name":"internal.metrics.jvmGCTime","Value":2643,"Internal":true,"Count Failed Values":true},{"ID":1595,"Name":"internal.metrics.resultSerializationTime","Value":3,"Internal":true,"Count Failed Values":true},{"ID":1596,"Name":"internal.metrics.memoryBytesSpilled","Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1597,"Name":"internal.metrics.diskBytesSpilled","Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":1598,"Name":"internal.metrics.peakExecutionMemory","Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":1617,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1618,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1619,"Name":"internal.metrics.shuffle.write.writeTime","Value":1997630330,"Internal":true,"Count Failed Values":true},{"ID":1620,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":1621,"Name":"internal.metrics.input.recordsRead","Value":10000000,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":12,"Completion Time":1747830601173,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":3,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (39)\n+- == Current Plan ==\n   CollectLimit (21)\n   +- HashAggregate (20)\n      +- HashAggregate (19)\n         +- Project (18)\n            +- Window (17)\n               +- Project (16)\n                  +- Window (15)\n                     +- Sort (14)\n                        +- ShuffleQueryStage (13)\n                           +- Exchange (12)\n                              +- * Project (11)\n                                 +- * Filter (10)\n                                    +- SortAggregate (9)\n                                       +- * Sort (8)\n                                          +- AQEShuffleRead (7)\n                                             +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                +- Exchange (5)\n                                                   +- SortAggregate (4)\n                                                      +- * Sort (3)\n                                                         +- * Filter (2)\n                                                            +- Scan csv  (1)\n+- == Initial Plan ==\n   CollectLimit (38)\n   +- HashAggregate (37)\n      +- HashAggregate (36)\n         +- Project (35)\n            +- Window (34)\n               +- Project (33)\n                  +- Window (32)\n                     +- Sort (31)\n                        +- Exchange (30)\n                           +- Project (29)\n                              +- Filter (28)\n                                 +- SortAggregate (27)\n                                    +- Sort (26)\n                                       +- Exchange (25)\n                                          +- SortAggregate (24)\n                                             +- Sort (23)\n                                                +- Filter (22)\n                                                   +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(12) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=795]\n\n(13) ShuffleQueryStage\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: 1\n\n(14) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(15) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(16) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(17) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(18) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(19) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(20) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(21) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(22) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(23) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(24) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(25) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=672]\n\n(26) Sort\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(27) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(28) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(29) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(30) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=678]\n\n(31) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(32) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(33) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(34) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(35) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(36) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(37) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(38) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(39) AdaptiveSparkPlan\nOutput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"CollectLimit","simpleString":"CollectLimit 21","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#283), count(action_type#279)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#283), partial_count(action_type#279)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#283, action_type#279, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=795]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011)]"},"metrics":[{"name":"number of output rows","accumulatorId":1493,"metricType":"sum"},{"name":"number of files read","accumulatorId":1494,"metricType":"sum"},{"name":"metadata time","accumulatorId":1495,"metricType":"timing"},{"name":"size of files read","accumulatorId":1496,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1588,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1585,"metricType":"timing"},{"name":"peak memory","accumulatorId":1586,"metricType":"size"},{"name":"spill size","accumulatorId":1587,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1584,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1583,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1581,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1575,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1582,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1576,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1573,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1570,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1579,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1572,"metricType":"sum"},{"name":"records read","accumulatorId":1569,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1567,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1568,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1565,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1571,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1564,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1574,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1563,"metricType":"sum"},{"name":"data size","accumulatorId":1561,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1577,"metricType":"size"},{"name":"number of partitions","accumulatorId":1562,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1578,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1566,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1580,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1690,"metricType":"sum"},{"name":"partition data size","accumulatorId":1691,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1692,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1687,"metricType":"timing"},{"name":"peak memory","accumulatorId":1688,"metricType":"size"},{"name":"spill size","accumulatorId":1689,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1686,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1685,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1684,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1683,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1681,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1675,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1682,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1676,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1673,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1670,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1679,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1672,"metricType":"sum"},{"name":"records read","accumulatorId":1669,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1667,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1668,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1665,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1671,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1664,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1674,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1663,"metricType":"sum"},{"name":"data size","accumulatorId":1661,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1677,"metricType":"size"},{"name":"number of partitions","accumulatorId":1662,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1678,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1666,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1680,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1658,"metricType":"timing"},{"name":"peak memory","accumulatorId":1659,"metricType":"size"},{"name":"spill size","accumulatorId":1660,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1657,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1656,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1652,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1653,"metricType":"timing"},{"name":"peak memory","accumulatorId":1651,"metricType":"size"},{"name":"number of output rows","accumulatorId":1650,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1655,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1654,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1646,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1647,"metricType":"timing"},{"name":"peak memory","accumulatorId":1645,"metricType":"size"},{"name":"number of output rows","accumulatorId":1644,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1649,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1648,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1642,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1636,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1643,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1637,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1634,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1631,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1640,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1633,"metricType":"sum"},{"name":"records read","accumulatorId":1630,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1628,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1629,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1626,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1632,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1625,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1635,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1624,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1638,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1639,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1627,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1641,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[1690,9],[1692,9],[1691,26025333],[1691,27063086],[1691,26026566],[1691,26016692],[1691,26040139],[1691,27063086],[1691,26040139],[1691,26026566],[1691,6491833]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[1662,200]]}
{"Event":"SparkListenerJobStart","Job ID":13,"Submission Time":1747830601262,"Stage Infos":[{"Stage ID":27,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"149\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"FileScanRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"150\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[61],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":28,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"164\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[67],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"161\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"160\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[27],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[27,28],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":28,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"164\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[67],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"161\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"160\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[27],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830601265,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":82,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830601272,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":83,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830601272,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":84,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":85,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":86,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":87,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":88,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":89,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830601274,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":28,"Stage Attempt ID":0,"Task Info":{"Task ID":90,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830606487,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":85,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830606489,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25169910","Value":"25169910","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1199408","Value":"1199408","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69078040","Value":"69078040","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21429162","Value":"21429162","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1199236","Value":"1199236","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"111098239","Value":"111098239","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"2725","Value":"2725","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1199236","Value":"1199236","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1199236","Value":"1199236","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5133","Value":"5133","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1413","Value":"1413","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":13,"Value":13,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":4289100,"Value":4289100,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5196,"Value":5196,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4502767500,"Value":4502767500,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":5455,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":146,"Value":146,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21291736,"Value":21291736,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25169910,"Value":25169910,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199408,"Value":1199408,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21429162,"Value":21429162,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199236,"Value":1199236,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":111098239,"Value":111098239,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":13,"Executor Deserialize CPU Time":4289100,"Executor Run Time":5196,"Executor CPU Time":4502767500,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":146,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21291736,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25169910,"Total Records Read":1199408,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21429162,"Shuffle Write Time":111098239,"Shuffle Records Written":1199236},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":89,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830601274,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830606542,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25194724","Value":"50364634","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1200793","Value":"2400201","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69158184","Value":"138236224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21451054","Value":"42880216","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1200616","Value":"2399852","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"113350210","Value":"224448449","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"2861","Value":"5586","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1200616","Value":"2399852","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1200616","Value":"2399852","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5166","Value":"10299","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1055","Value":"2468","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":21,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7004700,"Value":11293800,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5252,"Value":10448,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4192782500,"Value":8695550000,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":10910,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":146,"Value":292,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21290320,"Value":42582056,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25194724,"Value":50364634,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200793,"Value":2400201,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21451054,"Value":42880216,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200616,"Value":2399852,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":113350210,"Value":224448449,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":7004700,"Executor Run Time":5252,"Executor CPU Time":4192782500,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":146,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290320,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25194724,"Total Records Read":1200793,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21451054,"Shuffle Write Time":113350210,"Shuffle Records Written":1200616},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":82,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830601272,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830606715,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25164830","Value":"75529464","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1199495","Value":"3599696","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69079136","Value":"207315360","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21427323","Value":"64307539","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1199339","Value":"3599191","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"136209347","Value":"360657796","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"3127","Value":"8713","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1199339","Value":"3599191","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1199339","Value":"3599191","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5353","Value":"15652","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1271","Value":"3739","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":9,"Value":30,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7377400,"Value":18671200,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5427,"Value":15875,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4590364100,"Value":13285914100,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":16365,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":146,"Value":438,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21293776,"Value":63875832,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25164830,"Value":75529464,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199495,"Value":3599696,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21427323,"Value":64307539,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199339,"Value":3599191,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":136209347,"Value":360657796,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":9,"Executor Deserialize CPU Time":7377400,"Executor Run Time":5427,"Executor CPU Time":4590364100,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":146,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21293776,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25164830,"Total Records Read":1199495,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21427323,"Shuffle Write Time":136209347,"Shuffle Records Written":1199339},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":88,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830606832,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25190770","Value":"100720234","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1200749","Value":"4800445","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69155624","Value":"276470984","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21452969","Value":"85760508","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1200576","Value":"4799767","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"148581350","Value":"509239146","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"2921","Value":"11634","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1200576","Value":"4799767","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1200576","Value":"4799767","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5442","Value":"21094","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1428","Value":"5167","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":3,"Value":33,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3380300,"Value":22051500,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5543,"Value":21418,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4579853200,"Value":17865767300,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":21820,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":146,"Value":584,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21290127,"Value":85165959,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25190770,"Value":100720234,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200749,"Value":4800445,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21452969,"Value":85760508,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200576,"Value":4799767,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":148581350,"Value":509239146,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":3,"Executor Deserialize CPU Time":3380300,"Executor Run Time":5543,"Executor CPU Time":4579853200,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":146,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290127,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25190770,"Total Records Read":1200749,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21452969,"Shuffle Write Time":148581350,"Shuffle Records Written":1200576},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":87,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830607022,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"26222736","Value":"126942970","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1249666","Value":"6050111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"71972336","Value":"348443320","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"22317182","Value":"108077690","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1249467","Value":"6049234","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"231311691","Value":"740550837","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"2956","Value":"14590","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1249467","Value":"6049234","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1249467","Value":"6049234","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5530","Value":"26624","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1453","Value":"6620","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"398455840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":11,"Value":44,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5506500,"Value":27558000,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5729,"Value":27147,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4822149100,"Value":22687916400,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":27275,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":153,"Value":737,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":398455840,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21297671,"Value":106463630,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26222736,"Value":126942970,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249666,"Value":6050111,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":22317182,"Value":108077690,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1249467,"Value":6049234,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":231311691,"Value":740550837,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":11,"Executor Deserialize CPU Time":5506500,"Executor Run Time":5729,"Executor CPU Time":4822149100,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":153,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21297671,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26222736,"Total Records Read":1249666,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":22317182,"Shuffle Write Time":231311691,"Shuffle Records Written":1249467},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":83,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830601272,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830607062,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"26207403","Value":"153150373","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1249052","Value":"7299163","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"71938504","Value":"420381824","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"22311121","Value":"130388811","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1248877","Value":"7298111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"204036636","Value":"944587473","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"3391","Value":"17981","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1248877","Value":"7298111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1248877","Value":"7298111","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5613","Value":"32237","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1287","Value":"7907","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"478147008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":51,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6164700,"Value":33722700,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5777,"Value":32924,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4726288200,"Value":27414204600,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":32730,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":160,"Value":897,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":478147008,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21298509,"Value":127762139,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26207403,"Value":153150373,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249052,"Value":7299163,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":22311121,"Value":130388811,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1248877,"Value":7298111,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":204036636,"Value":944587473,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":6164700,"Executor Run Time":5777,"Executor CPU Time":4726288200,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":160,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21298509,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26207403,"Total Records Read":1249052,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":22311121,"Shuffle Write Time":204036636,"Shuffle Records Written":1248877},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":86,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830607063,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"56","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25161841","Value":"178312214","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1199182","Value":"8498345","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69064864","Value":"489446688","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21425800","Value":"151814611","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1199024","Value":"8497135","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"236374166","Value":"1180961639","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"3190","Value":"21171","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1199024","Value":"8497135","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1199024","Value":"8497135","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5596","Value":"37833","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1372","Value":"9279","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"557838176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":8,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7607800,"Value":41330500,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":5776,"Value":38700,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4876815900,"Value":32291020500,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":38185,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":160,"Value":1057,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":557838176,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21288229,"Value":149050368,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25161841,"Value":178312214,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199182,"Value":8498345,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21425800,"Value":151814611,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199024,"Value":8497135,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":236374166,"Value":1180961639,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":8,"Executor Deserialize CPU Time":7607800,"Executor Run Time":5776,"Executor CPU Time":4876815900,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":160,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21288229,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25161841,"Total Records Read":1199182,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21425800,"Shuffle Write Time":236374166,"Shuffle Records Written":1199024},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":84,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830601273,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830607386,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"25206453","Value":"203518667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"1200985","Value":"9699330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"69172424","Value":"558619112","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"21459294","Value":"173273905","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"1200824","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"338868819","Value":"1519830458","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"3499","Value":"24670","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"1200824","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"1200824","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"5823","Value":"43656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"1261","Value":"10540","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"79691168","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":71,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":8678700,"Value":50009200,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":6094,"Value":44794,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":4621282500,"Value":36912303000,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5455,"Value":43640,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":160,"Value":1217,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Update":21295373,"Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":64,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25206453,"Value":203518667,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200985,"Value":9699330,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21459294,"Value":173273905,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200824,"Value":9697959,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":338868819,"Value":1519830458,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":966477824,"JVMOffHeapMemory":186869080,"OnHeapExecutionMemory":455136400,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":365010,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":455501410,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":521,"MinorGCTime":2172,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2172},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":8678700,"Executor Run Time":6094,"Executor CPU Time":4621282500,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":160,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21295373,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25206453,"Total Records Read":1200985,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21459294,"Shuffle Write Time":338868819,"Shuffle Records Written":1200824},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":28,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":90,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830606487,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830607422,"Failed":false,"Killed":false,"Accumulables":[{"ID":1564,"Name":"local blocks read","Update":"8","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Update":"6302098","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Update":"300477","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Update":"17302512","Value":"575921624","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Update":"5447040","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Update":"43540585","Value":"1563371043","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Update":"417","Value":"25087","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Update":"876","Value":"44532","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Update":"244","Value":"10784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Update":"33554240","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Update":"0","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Update":9,"Value":80,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Update":6624300,"Value":56633500,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Update":921,"Value":45715,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Update":831652000,"Value":37743955000,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Update":5369,"Value":49009,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Update":14,"Value":1231,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Update":33554240,"Value":486536640,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":6302098,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Update":300477,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":5447040,"Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":300433,"Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Update":43540585,"Value":1563371043,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":9,"Executor Deserialize CPU Time":6624300,"Executor Run Time":921,"Executor CPU Time":831652000,"Peak Execution Memory":33554240,"Result Size":5369,"JVM GC Time":14,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":6302098,"Total Records Read":300477,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":5447040,"Shuffle Write Time":43540585,"Shuffle Records Written":300433},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":28,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"164\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[67],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"161\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"160\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[27],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830601265,"Completion Time":1747830607426,"Accumulables":[{"ID":1564,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1567,"Name":"local bytes read","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1568,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1569,"Name":"records read","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1661,"Name":"data size","Value":"575921624","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1680,"Name":"shuffle bytes written","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1681,"Name":"shuffle records written","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1682,"Name":"shuffle write time","Value":"1563371043","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1683,"Name":"duration","Value":"25087","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1684,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1685,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1686,"Name":"duration","Value":"44532","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1687,"Name":"sort time","Value":"10784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1688,"Name":"peak memory","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1689,"Name":"spill size","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1693,"Name":"internal.metrics.executorDeserializeTime","Value":80,"Internal":true,"Count Failed Values":true},{"ID":1694,"Name":"internal.metrics.executorDeserializeCpuTime","Value":56633500,"Internal":true,"Count Failed Values":true},{"ID":1695,"Name":"internal.metrics.executorRunTime","Value":45715,"Internal":true,"Count Failed Values":true},{"ID":1696,"Name":"internal.metrics.executorCpuTime","Value":37743955000,"Internal":true,"Count Failed Values":true},{"ID":1697,"Name":"internal.metrics.resultSize","Value":49009,"Internal":true,"Count Failed Values":true},{"ID":1698,"Name":"internal.metrics.jvmGCTime","Value":1231,"Internal":true,"Count Failed Values":true},{"ID":1700,"Name":"internal.metrics.memoryBytesSpilled","Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":1701,"Name":"internal.metrics.diskBytesSpilled","Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":1702,"Name":"internal.metrics.peakExecutionMemory","Value":486536640,"Internal":true,"Count Failed Values":true},{"ID":1704,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1705,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":1706,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1707,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1708,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":1709,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1710,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":1711,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1712,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1713,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1714,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1715,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1716,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1717,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1718,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1719,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1720,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1721,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":1722,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":1723,"Name":"internal.metrics.shuffle.write.writeTime","Value":1563371043,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":13,"Completion Time":1747830607429,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":3,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (40)\n+- == Final Plan ==\n   CollectLimit (22)\n   +- * HashAggregate (21)\n      +- * HashAggregate (20)\n         +- * Project (19)\n            +- Window (18)\n               +- * Project (17)\n                  +- Window (16)\n                     +- * Sort (15)\n                        +- AQEShuffleRead (14)\n                           +- ShuffleQueryStage (13), Statistics(sizeInBytes=549.2 MiB, rowCount=1.00E+7)\n                              +- Exchange (12)\n                                 +- * Project (11)\n                                    +- * Filter (10)\n                                       +- SortAggregate (9)\n                                          +- * Sort (8)\n                                             +- AQEShuffleRead (7)\n                                                +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                   +- Exchange (5)\n                                                      +- SortAggregate (4)\n                                                         +- * Sort (3)\n                                                            +- * Filter (2)\n                                                               +- Scan csv  (1)\n+- == Initial Plan ==\n   CollectLimit (39)\n   +- HashAggregate (38)\n      +- HashAggregate (37)\n         +- Project (36)\n            +- Window (35)\n               +- Project (34)\n                  +- Window (33)\n                     +- Sort (32)\n                        +- Exchange (31)\n                           +- Project (30)\n                              +- Filter (29)\n                                 +- SortAggregate (28)\n                                    +- Sort (27)\n                                       +- Exchange (26)\n                                          +- SortAggregate (25)\n                                             +- Sort (24)\n                                                +- Filter (23)\n                                                   +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(12) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=795]\n\n(13) ShuffleQueryStage\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: 1\n\n(14) AQEShuffleRead\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: coalesced\n\n(15) Sort [codegen id : 4]\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(16) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(17) Project [codegen id : 5]\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(18) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(19) Project [codegen id : 6]\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(20) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(21) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(22) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(23) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))\n\n(24) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(25) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#290, valueSet#291, first#292, valueSet#293]\nResults [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\n\n(26) Exchange\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=672]\n\n(27) Sort\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(28) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#294, valueSet#295, first#296, valueSet#297]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#278, first(duration_ms#21)()#282]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#278 AS action_type#279, first(duration_ms#21)()#282 AS duration_ms#283]\n\n(29) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\nCondition : (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))\n\n(30) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nInput [4]: [user_id#17, timestamp#30, action_type#279, duration_ms#283]\n\n(31) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=678]\n\n(32) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(33) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#283, action_type#279]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(34) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, prev_timestamp#97]\n\n(35) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(36) Project\nOutput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#283, action_type#279, is_new_session#110, session_id#119L]\n\n(37) HashAggregate\nInput [4]: [user_id#17, duration_ms#283, action_type#279, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#283), partial_count(action_type#279)]\nAggregate Attributes [2]: [sum#286L, count#287L]\nResults [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\n\n(38) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#288L, count#289L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#283), count(action_type#279)]\nAggregate Attributes [2]: [sum(duration_ms#283)#136L, count(action_type#279)#138L]\nResults [4]: [toprettystring(user_id#17, Some(Asia/Hong_Kong)) AS toprettystring(user_id)#270, toprettystring(session_id#119L, Some(Asia/Hong_Kong)) AS toprettystring(session_id)#271, toprettystring(sum(duration_ms#283)#136L, Some(Asia/Hong_Kong)) AS toprettystring(session_duration_ms)#272, toprettystring(count(action_type#279)#138L, Some(Asia/Hong_Kong)) AS toprettystring(action_count)#273]\n\n(39) CollectLimit\nInput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: 21\n\n(40) AdaptiveSparkPlan\nOutput [4]: [toprettystring(user_id)#270, toprettystring(session_id)#271, toprettystring(session_duration_ms)#272, toprettystring(action_count)#273]\nArguments: isFinalPlan=true\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"CollectLimit","simpleString":"CollectLimit 21","children":[{"nodeName":"WholeStageCodegen (6)","simpleString":"WholeStageCodegen (6)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#283), count(action_type#279)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#283), partial_count(action_type#279)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#283, action_type#279, session_id#119L]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (5)","simpleString":"WholeStageCodegen (5)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=795]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#283, action_type#279]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#283) AND ((action_type#279 IN (create,edit,share,page_view,delete) AND (duration_ms#283 >= -127618)) AND (duration_ms#283 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=711]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:29:45.796011)]"},"metrics":[{"name":"number of output rows","accumulatorId":1493,"metricType":"sum"},{"name":"number of files read","accumulatorId":1494,"metricType":"sum"},{"name":"metadata time","accumulatorId":1495,"metricType":"timing"},{"name":"size of files read","accumulatorId":1496,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1588,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1585,"metricType":"timing"},{"name":"peak memory","accumulatorId":1586,"metricType":"size"},{"name":"spill size","accumulatorId":1587,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1584,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1583,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1581,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1575,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1582,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1576,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1573,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1570,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1579,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1572,"metricType":"sum"},{"name":"records read","accumulatorId":1569,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1567,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1568,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1565,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1571,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1564,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1574,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1563,"metricType":"sum"},{"name":"data size","accumulatorId":1561,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1577,"metricType":"size"},{"name":"number of partitions","accumulatorId":1562,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1578,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1566,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1580,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1690,"metricType":"sum"},{"name":"partition data size","accumulatorId":1691,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1692,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1687,"metricType":"timing"},{"name":"peak memory","accumulatorId":1688,"metricType":"size"},{"name":"spill size","accumulatorId":1689,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1686,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1685,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1684,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1683,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1681,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1675,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1682,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1676,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1673,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1670,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1679,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1672,"metricType":"sum"},{"name":"records read","accumulatorId":1669,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1667,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1668,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1665,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1671,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1664,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1674,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1663,"metricType":"sum"},{"name":"data size","accumulatorId":1661,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1677,"metricType":"size"},{"name":"number of partitions","accumulatorId":1662,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1678,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1666,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1680,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":1768,"metricType":"sum"},{"name":"partition data size","accumulatorId":1769,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":1770,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1765,"metricType":"timing"},{"name":"peak memory","accumulatorId":1766,"metricType":"size"},{"name":"spill size","accumulatorId":1767,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1764,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1763,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1762,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1761,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1757,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1758,"metricType":"timing"},{"name":"peak memory","accumulatorId":1756,"metricType":"size"},{"name":"number of output rows","accumulatorId":1755,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1760,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1759,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1751,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1752,"metricType":"timing"},{"name":"peak memory","accumulatorId":1750,"metricType":"size"},{"name":"number of output rows","accumulatorId":1749,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1754,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1753,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":1748,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1746,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1740,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1747,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1741,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1738,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1735,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1744,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1737,"metricType":"sum"},{"name":"records read","accumulatorId":1734,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1732,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1733,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1730,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1736,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1729,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1739,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1728,"metricType":"sum"},{"name":"local merged bytes read","accumulatorId":1742,"metricType":"size"},{"name":"remote reqs duration","accumulatorId":1743,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1731,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1745,"metricType":"size"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[1768,9],[1770,9],[1769,22904968],[1769,23233144],[1769,22821911],[1769,23357100],[1769,22812722],[1769,22324493],[1769,22802657],[1769,22505248],[1769,4702698]]}
{"Event":"SparkListenerJobStart","Job ID":14,"Submission Time":1747830608000,"Stage Infos":[{"Stage ID":30,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"155\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"164\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[67],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"161\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"160\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[29],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":31,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[71],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"178\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"175\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"170\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"171\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[30],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":29,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"148\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"149\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"FileScanRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"154\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"150\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[61],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[30,31,29],"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.sql.execution.id":"3","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":31,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[71],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"178\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"175\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"170\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"171\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[30],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830608002,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.master":"local[*]","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.compress":"True","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.app.submitTime":"1747830505830","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.sql.execution.id":"3","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"3","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.serializer.objectStreamReset":"100","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false"}}
{"Event":"SparkListenerTaskStart","Stage ID":31,"Stage Attempt ID":0,"Task Info":{"Task ID":91,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830608017,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":31,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":91,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830608017,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830610316,"Failed":false,"Killed":false,"Accumulables":[{"ID":1664,"Name":"local blocks read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1667,"Name":"local bytes read","Update":"21801546","Value":"21801546","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1668,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1669,"Name":"records read","Update":"1219784","Value":"1219784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1749,"Name":"number of output rows","Update":"21","Value":"21","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1750,"Name":"peak memory","Update":"83885696","Value":"83885696","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1752,"Name":"time in aggregation build","Update":"1513","Value":"1513","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1753,"Name":"avg hash probes per key","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1755,"Name":"number of output rows","Update":"687557","Value":"687557","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1756,"Name":"peak memory","Update":"81788560","Value":"81788560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1758,"Name":"time in aggregation build","Update":"1295","Value":"1295","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1759,"Name":"avg hash probes per key","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1761,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1762,"Name":"duration","Update":"1379","Value":"1379","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1763,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1764,"Name":"duration","Update":"1961","Value":"1961","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1765,"Name":"sort time","Update":"218","Value":"218","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1766,"Name":"peak memory","Update":"109051328","Value":"109051328","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1767,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1771,"Name":"internal.metrics.executorDeserializeTime","Update":82,"Value":82,"Internal":true,"Count Failed Values":true},{"ID":1772,"Name":"internal.metrics.executorDeserializeCpuTime","Update":80273100,"Value":80273100,"Internal":true,"Count Failed Values":true},{"ID":1773,"Name":"internal.metrics.executorRunTime","Update":2208,"Value":2208,"Internal":true,"Count Failed Values":true},{"ID":1774,"Name":"internal.metrics.executorCpuTime","Update":2117743400,"Value":2117743400,"Internal":true,"Count Failed Values":true},{"ID":1775,"Name":"internal.metrics.resultSize","Update":7851,"Value":7851,"Internal":true,"Count Failed Values":true},{"ID":1776,"Name":"internal.metrics.jvmGCTime","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":1780,"Name":"internal.metrics.peakExecutionMemory","Update":274725584,"Value":274725584,"Internal":true,"Count Failed Values":true},{"ID":1782,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1783,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":1784,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1785,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1786,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21801546,"Value":21801546,"Internal":true,"Count Failed Values":true},{"ID":1787,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1788,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1219784,"Value":1219784,"Internal":true,"Count Failed Values":true},{"ID":1789,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1790,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1791,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1792,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1793,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1794,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1795,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1796,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1797,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":1798,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":82,"Executor Deserialize CPU Time":80273100,"Executor Run Time":2208,"Executor CPU Time":2117743400,"Peak Execution Memory":274725584,"Result Size":7851,"JVM GC Time":9,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21801546,"Total Records Read":1219784,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":31,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[71],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"178\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"175\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"170\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"171\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[30],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830608002,"Completion Time":1747830610318,"Accumulables":[{"ID":1664,"Name":"local blocks read","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1667,"Name":"local bytes read","Value":"21801546","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1668,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1669,"Name":"records read","Value":"1219784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1749,"Name":"number of output rows","Value":"21","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1750,"Name":"peak memory","Value":"83885696","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1752,"Name":"time in aggregation build","Value":"1513","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1753,"Name":"avg hash probes per key","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1755,"Name":"number of output rows","Value":"687557","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1756,"Name":"peak memory","Value":"81788560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1758,"Name":"time in aggregation build","Value":"1295","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1759,"Name":"avg hash probes per key","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1761,"Name":"spill size","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1762,"Name":"duration","Value":"1379","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1763,"Name":"spill size","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1764,"Name":"duration","Value":"1961","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1765,"Name":"sort time","Value":"218","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1766,"Name":"peak memory","Value":"109051328","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1767,"Name":"spill size","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1771,"Name":"internal.metrics.executorDeserializeTime","Value":82,"Internal":true,"Count Failed Values":true},{"ID":1772,"Name":"internal.metrics.executorDeserializeCpuTime","Value":80273100,"Internal":true,"Count Failed Values":true},{"ID":1773,"Name":"internal.metrics.executorRunTime","Value":2208,"Internal":true,"Count Failed Values":true},{"ID":1774,"Name":"internal.metrics.executorCpuTime","Value":2117743400,"Internal":true,"Count Failed Values":true},{"ID":1775,"Name":"internal.metrics.resultSize","Value":7851,"Internal":true,"Count Failed Values":true},{"ID":1776,"Name":"internal.metrics.jvmGCTime","Value":9,"Internal":true,"Count Failed Values":true},{"ID":1780,"Name":"internal.metrics.peakExecutionMemory","Value":274725584,"Internal":true,"Count Failed Values":true},{"ID":1782,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1783,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":9,"Internal":true,"Count Failed Values":true},{"ID":1784,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1785,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1786,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":21801546,"Internal":true,"Count Failed Values":true},{"ID":1787,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1788,"Name":"internal.metrics.shuffle.read.recordsRead","Value":1219784,"Internal":true,"Count Failed Values":true},{"ID":1789,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1790,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1791,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1792,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1793,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1794,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1795,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1796,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1797,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":1798,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":14,"Completion Time":1747830610318,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":3,"time":1747830610339,"errorMessage":""}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":4,"rootExecutionId":4,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (21)\n+- HashAggregate (20)\n   +- Exchange (19)\n      +- HashAggregate (18)\n         +- HashAggregate (17)\n            +- HashAggregate (16)\n               +- Project (15)\n                  +- Window (14)\n                     +- Project (13)\n                        +- Window (12)\n                           +- Sort (11)\n                              +- Exchange (10)\n                                 +- Project (9)\n                                    +- Filter (8)\n                                       +- SortAggregate (7)\n                                          +- Sort (6)\n                                             +- Exchange (5)\n                                                +- SortAggregate (4)\n                                                   +- Sort (3)\n                                                      +- Filter (2)\n                                                         +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(3) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]\n\n(6) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(7) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(8) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(9) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(10) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]\n\n(11) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(12) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(13) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(14) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(15) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(16) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(17) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(18) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(19) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]\n\n(20) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(21) AdaptiveSparkPlan\nOutput [2]: [toprettystring(avg_session_duration_ms)#326, toprettystring(avg_actions_per_session)#327]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[avg(session_duration_ms#137L), avg(action_count#139L)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#335), count(action_type#331)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#335), partial_count(action_type#331)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#335, action_type#331, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203)]"},"metrics":[{"name":"number of output rows","accumulatorId":1911,"metricType":"sum"},{"name":"number of files read","accumulatorId":1912,"metricType":"sum"},{"name":"metadata time","accumulatorId":1913,"metricType":"timing"},{"name":"size of files read","accumulatorId":1914,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1910,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1907,"metricType":"timing"},{"name":"peak memory","accumulatorId":1908,"metricType":"size"},{"name":"spill size","accumulatorId":1909,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1906,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1904,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1898,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1905,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1899,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1896,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1893,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1902,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1895,"metricType":"sum"},{"name":"records read","accumulatorId":1892,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1890,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1891,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1888,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1894,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1887,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1897,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1886,"metricType":"sum"},{"name":"data size","accumulatorId":1884,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1900,"metricType":"size"},{"name":"number of partitions","accumulatorId":1885,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1901,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1889,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1903,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1881,"metricType":"timing"},{"name":"peak memory","accumulatorId":1882,"metricType":"size"},{"name":"spill size","accumulatorId":1883,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1880,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1879,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1877,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1871,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1878,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1872,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1869,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1866,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1875,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1868,"metricType":"sum"},{"name":"records read","accumulatorId":1865,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1863,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1864,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1861,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1867,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1860,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1870,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1859,"metricType":"sum"},{"name":"data size","accumulatorId":1857,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1873,"metricType":"size"},{"name":"number of partitions","accumulatorId":1858,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1874,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1862,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1876,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1854,"metricType":"timing"},{"name":"peak memory","accumulatorId":1855,"metricType":"size"},{"name":"spill size","accumulatorId":1856,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1853,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1852,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1848,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1849,"metricType":"timing"},{"name":"peak memory","accumulatorId":1847,"metricType":"size"},{"name":"number of output rows","accumulatorId":1846,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1851,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1850,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1842,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1843,"metricType":"timing"},{"name":"peak memory","accumulatorId":1841,"metricType":"size"},{"name":"number of output rows","accumulatorId":1840,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1845,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1844,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1836,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1837,"metricType":"timing"},{"name":"peak memory","accumulatorId":1835,"metricType":"size"},{"name":"number of output rows","accumulatorId":1834,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1839,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1838,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1832,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1826,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1833,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1827,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1824,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1821,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1830,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1823,"metricType":"sum"},{"name":"records read","accumulatorId":1820,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1818,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1819,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1816,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1822,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1815,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1825,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1814,"metricType":"sum"},{"name":"data size","accumulatorId":1812,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1828,"metricType":"size"},{"name":"number of partitions","accumulatorId":1813,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1829,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1817,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1831,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1808,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1809,"metricType":"timing"},{"name":"peak memory","accumulatorId":1807,"metricType":"size"},{"name":"number of output rows","accumulatorId":1806,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1811,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1810,"metricType":"average"}]}],"metadata":{},"metrics":[]},"time":1747830610755,"modifiedConfigs":{"spark.sql.session.timeZone":"Asia/Hong_Kong"},"jobTags":[]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":4,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (41)\n+- == Current Plan ==\n   HashAggregate (21)\n   +- Exchange (20)\n      +- HashAggregate (19)\n         +- HashAggregate (18)\n            +- HashAggregate (17)\n               +- Project (16)\n                  +- Window (15)\n                     +- Project (14)\n                        +- Window (13)\n                           +- Sort (12)\n                              +- Exchange (11)\n                                 +- Project (10)\n                                    +- Filter (9)\n                                       +- SortAggregate (8)\n                                          +- Sort (7)\n                                             +- ShuffleQueryStage (6)\n                                                +- Exchange (5)\n                                                   +- SortAggregate (4)\n                                                      +- * Sort (3)\n                                                         +- * Filter (2)\n                                                            +- Scan csv  (1)\n+- == Initial Plan ==\n   HashAggregate (40)\n   +- Exchange (39)\n      +- HashAggregate (38)\n         +- HashAggregate (37)\n            +- HashAggregate (36)\n               +- Project (35)\n                  +- Window (34)\n                     +- Project (33)\n                        +- Window (32)\n                           +- Sort (31)\n                              +- Exchange (30)\n                                 +- Project (29)\n                                    +- Filter (28)\n                                       +- SortAggregate (27)\n                                          +- Sort (26)\n                                             +- Exchange (25)\n                                                +- SortAggregate (24)\n                                                   +- Sort (23)\n                                                      +- Filter (22)\n                                                         +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: 0\n\n(7) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(8) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(9) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(10) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(11) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1014]\n\n(12) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(13) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(14) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(15) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(16) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(17) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(18) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(19) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(20) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1023]\n\n(21) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(22) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(23) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(24) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(25) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]\n\n(26) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(27) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(28) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(29) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(30) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]\n\n(31) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(32) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(33) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(34) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(35) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(36) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(37) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(38) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(39) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]\n\n(40) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(41) AdaptiveSparkPlan\nOutput [2]: [toprettystring(avg_session_duration_ms)#326, toprettystring(avg_actions_per_session)#327]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[avg(session_duration_ms#137L), avg(action_count#139L)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1023]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#335), count(action_type#331)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#335), partial_count(action_type#331)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#335, action_type#331, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1014]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203)]"},"metrics":[{"name":"number of output rows","accumulatorId":1911,"metricType":"sum"},{"name":"number of files read","accumulatorId":1912,"metricType":"sum"},{"name":"metadata time","accumulatorId":1913,"metricType":"timing"},{"name":"size of files read","accumulatorId":1914,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2020,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2017,"metricType":"timing"},{"name":"peak memory","accumulatorId":2018,"metricType":"size"},{"name":"spill size","accumulatorId":2019,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2016,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2015,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2013,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2007,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2014,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2008,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2005,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2002,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2011,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2004,"metricType":"sum"},{"name":"records read","accumulatorId":2001,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1999,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2000,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1997,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2003,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1996,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2006,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1995,"metricType":"sum"},{"name":"data size","accumulatorId":1993,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2009,"metricType":"size"},{"name":"number of partitions","accumulatorId":1994,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2010,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1998,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2012,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1990,"metricType":"timing"},{"name":"peak memory","accumulatorId":1991,"metricType":"size"},{"name":"spill size","accumulatorId":1992,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1989,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":1988,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1986,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1980,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1987,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1981,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1978,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1975,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1984,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1977,"metricType":"sum"},{"name":"records read","accumulatorId":1974,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1972,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1973,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1970,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1976,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1969,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1979,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1968,"metricType":"sum"},{"name":"data size","accumulatorId":1966,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1982,"metricType":"size"},{"name":"number of partitions","accumulatorId":1967,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1983,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1971,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1985,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":1963,"metricType":"timing"},{"name":"peak memory","accumulatorId":1964,"metricType":"size"},{"name":"spill size","accumulatorId":1965,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1962,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1961,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1957,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1958,"metricType":"timing"},{"name":"peak memory","accumulatorId":1956,"metricType":"size"},{"name":"number of output rows","accumulatorId":1955,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1960,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1959,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1951,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1952,"metricType":"timing"},{"name":"peak memory","accumulatorId":1950,"metricType":"size"},{"name":"number of output rows","accumulatorId":1949,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1954,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1953,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1945,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1946,"metricType":"timing"},{"name":"peak memory","accumulatorId":1944,"metricType":"size"},{"name":"number of output rows","accumulatorId":1943,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1948,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1947,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":1941,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":1935,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":1942,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":1936,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":1933,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":1930,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":1939,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":1932,"metricType":"sum"},{"name":"records read","accumulatorId":1929,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1927,"metricType":"size"},{"name":"fetch wait time","accumulatorId":1928,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1925,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":1931,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1924,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":1934,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1923,"metricType":"sum"},{"name":"data size","accumulatorId":1921,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":1937,"metricType":"size"},{"name":"number of partitions","accumulatorId":1922,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":1938,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1926,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":1940,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":1917,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":1918,"metricType":"timing"},{"name":"peak memory","accumulatorId":1916,"metricType":"size"},{"name":"number of output rows","accumulatorId":1915,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":1920,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":1919,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[1912,1],[1913,4],[1914,566316442]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[1994,200]]}
{"Event":"SparkListenerJobStart","Job ID":15,"Submission Time":1747830610946,"Stage Infos":[{"Stage ID":32,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[32],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":32,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830610949,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":92,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830610970,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":93,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830610971,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":94,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830610972,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":95,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":96,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":97,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":98,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830610974,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":32,"Stage Attempt ID":0,"Task Info":{"Task ID":99,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830610974,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":92,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830610970,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830629820,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259231","Value":"1259231","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92680320","Value":"92680320","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26415883","Value":"26415883","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259209","Value":"1259209","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"835373641","Value":"835373641","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259209","Value":"1259209","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"19734","Value":"19734","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"5168","Value":"5168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259231","Value":"1259231","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2592700,"Value":2592700,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":19856,"Value":19856,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":14216843200,"Value":14216843200,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":2759,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":523,"Value":523,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":4,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":39845584,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11670288,"Value":11670288,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415883,"Value":26415883,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":1259209,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":835373641,"Value":835373641,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":71434240,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259231,"Value":1259231,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2592700,"Executor Run Time":19856,"Executor CPU Time":14216843200,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":523,"Result Serialization Time":4,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670288,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415883,"Shuffle Write Time":835373641,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259231},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":99,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830610974,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830629838,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1185193","Value":"2444424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"87233432","Value":"179913752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"24894639","Value":"51310522","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1185174","Value":"2444383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"758154792","Value":"1593528433","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1185174","Value":"2444383","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"19710","Value":"39444","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"4386","Value":"9554","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1185193","Value":"2444424","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":3,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3642400,"Value":6235100,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":19856,"Value":39712,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":12011978800,"Value":26228822000,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":5518,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":523,"Value":1046,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":26,"Value":30,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11670212,"Value":23340500,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":24894639,"Value":51310522,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1185174,"Value":2444383,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":758154792,"Value":1593528433,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":67119541,"Value":138553781,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1185193,"Value":2444424,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":3,"Executor Deserialize CPU Time":3642400,"Executor Run Time":19856,"Executor CPU Time":12011978800,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":523,"Result Serialization Time":26,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670212,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":24894639,"Shuffle Write Time":758154792,"Shuffle Records Written":1185174},"Input Metrics":{"Bytes Read":67119541,"Records Read":1185193},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":96,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830630116,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259249","Value":"3703673","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92684000","Value":"272597752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26415198","Value":"77725720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259223","Value":"3703606","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"797386022","Value":"2390914455","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259223","Value":"3703606","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"19969","Value":"59413","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"5019","Value":"14573","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259249","Value":"3703673","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":9,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":3402000,"Value":9637100,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":20155,"Value":59867,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":13546104600,"Value":39774926600,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":8277,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":525,"Value":1571,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":15,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":119536752,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11669904,"Value":35010404,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26415198,"Value":77725720,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259223,"Value":3703606,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":797386022,"Value":2390914455,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":209988021,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259249,"Value":3703673,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":9,"Executor Deserialize CPU Time":3402000,"Executor Run Time":20155,"Executor CPU Time":13546104600,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":525,"Result Serialization Time":15,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669904,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26415198,"Shuffle Write Time":797386022,"Shuffle Records Written":1259223},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259249},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":94,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830610972,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830630359,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259254","Value":"4962927","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92682784","Value":"365280536","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26420936","Value":"104146656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259233","Value":"4962839","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"784985186","Value":"3175899641","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259233","Value":"4962839","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"20331","Value":"79744","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"5393","Value":"19966","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259254","Value":"4962927","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":20,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2823600,"Value":12460700,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":20424,"Value":80291,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":12872303100,"Value":52647229700,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2716,"Value":10993,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":527,"Value":2098,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11670787,"Value":46681191,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26420936,"Value":104146656,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259233,"Value":4962839,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":784985186,"Value":3175899641,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":281422261,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259254,"Value":4962927,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2823600,"Executor Run Time":20424,"Executor CPU Time":12872303100,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":527,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11670787,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26420936,"Shuffle Write Time":784985186,"Shuffle Records Written":1259233},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259254},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":93,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830610971,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830630531,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259294","Value":"6222221","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92679936","Value":"457960472","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26424562","Value":"130571218","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259268","Value":"6222107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"522875070","Value":"3698774711","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259268","Value":"6222107","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"20464","Value":"100208","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"4684","Value":"24650","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259294","Value":"6222221","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2659300,"Value":15120000,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":20581,"Value":100872,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":12144309300,"Value":64791539000,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":13752,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":536,"Value":2634,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":8,"Value":53,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":199227920,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11669024,"Value":58350215,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26424562,"Value":130571218,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259268,"Value":6222107,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":522875070,"Value":3698774711,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":352856501,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259294,"Value":6222221,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2659300,"Executor Run Time":20581,"Executor CPU Time":12144309300,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":536,"Result Serialization Time":8,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669024,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26424562,"Shuffle Write Time":522875070,"Shuffle Records Written":1259268},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259294},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":98,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830610974,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830631012,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259260","Value":"7481481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92680248","Value":"550640720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26417633","Value":"156988851","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259237","Value":"7481344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"503366605","Value":"4202141316","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259237","Value":"7481344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"21002","Value":"121210","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"5551","Value":"30201","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259260","Value":"7481481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":4,"Value":28,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2903000,"Value":18023000,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":21073,"Value":121945,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":12923919000,"Value":77715458000,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2716,"Value":16468,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":542,"Value":3176,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11669508,"Value":70019723,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26417633,"Value":156988851,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259237,"Value":7481344,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":503366605,"Value":4202141316,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":424290741,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259260,"Value":7481481,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":4,"Executor Deserialize CPU Time":2903000,"Executor Run Time":21073,"Executor CPU Time":12923919000,"Peak Execution Memory":56622800,"Result Size":2716,"JVM GC Time":542,"Result Serialization Time":0,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11669508,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26417633,"Shuffle Write Time":503366605,"Shuffle Records Written":1259237},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259260},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":95,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830631107,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259279","Value":"8740760","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92680632","Value":"643321352","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26414963","Value":"183403814","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259254","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"466418935","Value":"4668560251","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259254","Value":"8740598","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"21097","Value":"142307","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"4648","Value":"34849","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259279","Value":"8740760","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":12,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7883100,"Value":25906100,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":21157,"Value":143102,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":12300830600,"Value":90016288600,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":19227,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":542,"Value":3718,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":5,"Value":58,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":278919088,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11667727,"Value":81687450,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26414963,"Value":183403814,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259254,"Value":8740598,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":466418935,"Value":4668560251,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":495724981,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259279,"Value":8740760,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":12,"Executor Deserialize CPU Time":7883100,"Executor Run Time":21157,"Executor CPU Time":12300830600,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":542,"Result Serialization Time":5,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11667727,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26414963,"Shuffle Write Time":466418935,"Shuffle Records Written":1259254},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259279},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":32,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":97,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830610973,"Executor ID":"driver","Host":"172.27.136.101","Locality":"PROCESS_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830631180,"Failed":false,"Killed":false,"Accumulables":[{"ID":1911,"Name":"number of output rows","Update":"1259240","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Update":"92678720","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Update":"26416951","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Update":"376639016","Value":"5045199267","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Update":"1259209","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Update":"21170","Value":"163477","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Update":"4802","Value":"39651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Update":"1259240","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Update":2,"Value":42,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Update":2235800,"Value":28141900,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Update":21244,"Value":164346,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Update":11804590100,"Value":101820878700,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Update":2759,"Value":21986,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Update":542,"Value":4260,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Update":39845584,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Update":11674538,"Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":26416951,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1259209,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Update":376639016,"Value":5045199267,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Update":71434240,"Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Update":1259240,"Value":10000000,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":936777112,"JVMOffHeapMemory":188799872,"OnHeapExecutionMemory":227391301,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":293548,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":227684849,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":575,"MinorGCTime":2585,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2585},"Task Metrics":{"Executor Deserialize Time":2,"Executor Deserialize CPU Time":2235800,"Executor Run Time":21244,"Executor CPU Time":11804590100,"Peak Execution Memory":56622800,"Result Size":2759,"JVM GC Time":542,"Result Serialization Time":1,"Memory Bytes Spilled":39845584,"Disk Bytes Spilled":11674538,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":26416951,"Shuffle Write Time":376639016,"Shuffle Records Written":1259209},"Input Metrics":{"Bytes Read":71434240,"Records Read":1259240},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":32,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830610949,"Completion Time":1747830631184,"Accumulables":[{"ID":1911,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1993,"Name":"data size","Value":"736000072","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2012,"Name":"shuffle bytes written","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2013,"Name":"shuffle records written","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2014,"Name":"shuffle write time","Value":"5045199267","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2015,"Name":"number of output rows","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2016,"Name":"duration","Value":"163477","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2017,"Name":"sort time","Value":"39651","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2018,"Name":"peak memory","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2019,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2020,"Name":"number of output rows","Value":"10000000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2021,"Name":"internal.metrics.executorDeserializeTime","Value":42,"Internal":true,"Count Failed Values":true},{"ID":2022,"Name":"internal.metrics.executorDeserializeCpuTime","Value":28141900,"Internal":true,"Count Failed Values":true},{"ID":2023,"Name":"internal.metrics.executorRunTime","Value":164346,"Internal":true,"Count Failed Values":true},{"ID":2024,"Name":"internal.metrics.executorCpuTime","Value":101820878700,"Internal":true,"Count Failed Values":true},{"ID":2025,"Name":"internal.metrics.resultSize","Value":21986,"Internal":true,"Count Failed Values":true},{"ID":2026,"Name":"internal.metrics.jvmGCTime","Value":4260,"Internal":true,"Count Failed Values":true},{"ID":2027,"Name":"internal.metrics.resultSerializationTime","Value":59,"Internal":true,"Count Failed Values":true},{"ID":2028,"Name":"internal.metrics.memoryBytesSpilled","Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":2029,"Name":"internal.metrics.diskBytesSpilled","Value":93361988,"Internal":true,"Count Failed Values":true},{"ID":2030,"Name":"internal.metrics.peakExecutionMemory","Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":2049,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":2050,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":2051,"Name":"internal.metrics.shuffle.write.writeTime","Value":5045199267,"Internal":true,"Count Failed Values":true},{"ID":2052,"Name":"internal.metrics.input.bytesRead","Value":567159221,"Internal":true,"Count Failed Values":true},{"ID":2053,"Name":"internal.metrics.input.recordsRead","Value":10000000,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":15,"Completion Time":1747830631192,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":4,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (43)\n+- == Current Plan ==\n   HashAggregate (23)\n   +- Exchange (22)\n      +- HashAggregate (21)\n         +- HashAggregate (20)\n            +- HashAggregate (19)\n               +- Project (18)\n                  +- Window (17)\n                     +- Project (16)\n                        +- Window (15)\n                           +- Sort (14)\n                              +- ShuffleQueryStage (13)\n                                 +- Exchange (12)\n                                    +- * Project (11)\n                                       +- * Filter (10)\n                                          +- SortAggregate (9)\n                                             +- * Sort (8)\n                                                +- AQEShuffleRead (7)\n                                                   +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                      +- Exchange (5)\n                                                         +- SortAggregate (4)\n                                                            +- * Sort (3)\n                                                               +- * Filter (2)\n                                                                  +- Scan csv  (1)\n+- == Initial Plan ==\n   HashAggregate (42)\n   +- Exchange (41)\n      +- HashAggregate (40)\n         +- HashAggregate (39)\n            +- HashAggregate (38)\n               +- Project (37)\n                  +- Window (36)\n                     +- Project (35)\n                        +- Window (34)\n                           +- Sort (33)\n                              +- Exchange (32)\n                                 +- Project (31)\n                                    +- Filter (30)\n                                       +- SortAggregate (29)\n                                          +- Sort (28)\n                                             +- Exchange (27)\n                                                +- SortAggregate (26)\n                                                   +- Sort (25)\n                                                      +- Filter (24)\n                                                         +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(12) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]\n\n(13) ShuffleQueryStage\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: 1\n\n(14) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(15) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(16) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(17) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(18) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(19) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(20) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(21) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(22) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1132]\n\n(23) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(24) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(25) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(26) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(27) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]\n\n(28) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(29) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(30) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(31) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(32) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]\n\n(33) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(34) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(35) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(36) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(37) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(38) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(39) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(40) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(41) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]\n\n(42) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(43) AdaptiveSparkPlan\nOutput [2]: [toprettystring(avg_session_duration_ms)#326, toprettystring(avg_actions_per_session)#327]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[avg(session_duration_ms#137L), avg(action_count#139L)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1132]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#335), count(action_type#331)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#335), partial_count(action_type#331)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#335, action_type#331, session_id#119L]","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203)]"},"metrics":[{"name":"number of output rows","accumulatorId":1911,"metricType":"sum"},{"name":"number of files read","accumulatorId":1912,"metricType":"sum"},{"name":"metadata time","accumulatorId":1913,"metricType":"timing"},{"name":"size of files read","accumulatorId":1914,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2020,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2017,"metricType":"timing"},{"name":"peak memory","accumulatorId":2018,"metricType":"size"},{"name":"spill size","accumulatorId":2019,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2016,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2015,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2013,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2007,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2014,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2008,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2005,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2002,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2011,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2004,"metricType":"sum"},{"name":"records read","accumulatorId":2001,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1999,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2000,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1997,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2003,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1996,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2006,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1995,"metricType":"sum"},{"name":"data size","accumulatorId":1993,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2009,"metricType":"size"},{"name":"number of partitions","accumulatorId":1994,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2010,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1998,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2012,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":2136,"metricType":"sum"},{"name":"partition data size","accumulatorId":2137,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":2138,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2133,"metricType":"timing"},{"name":"peak memory","accumulatorId":2134,"metricType":"size"},{"name":"spill size","accumulatorId":2135,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2132,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2131,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2130,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2129,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2127,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2121,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2128,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2122,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2119,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2116,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2125,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2118,"metricType":"sum"},{"name":"records read","accumulatorId":2115,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2113,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2114,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2111,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2117,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2110,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2120,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2109,"metricType":"sum"},{"name":"data size","accumulatorId":2107,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2123,"metricType":"size"},{"name":"number of partitions","accumulatorId":2108,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2124,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2112,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2126,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2104,"metricType":"timing"},{"name":"peak memory","accumulatorId":2105,"metricType":"size"},{"name":"spill size","accumulatorId":2106,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2103,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2102,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2098,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2099,"metricType":"timing"},{"name":"peak memory","accumulatorId":2097,"metricType":"size"},{"name":"number of output rows","accumulatorId":2096,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2101,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2100,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2092,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2093,"metricType":"timing"},{"name":"peak memory","accumulatorId":2091,"metricType":"size"},{"name":"number of output rows","accumulatorId":2090,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2095,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2094,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2086,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2087,"metricType":"timing"},{"name":"peak memory","accumulatorId":2085,"metricType":"size"},{"name":"number of output rows","accumulatorId":2084,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2089,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2088,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2082,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2076,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2083,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2077,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2074,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2071,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2080,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2073,"metricType":"sum"},{"name":"records read","accumulatorId":2070,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2068,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2069,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2066,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2072,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2065,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2075,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2064,"metricType":"sum"},{"name":"data size","accumulatorId":2062,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2078,"metricType":"size"},{"name":"number of partitions","accumulatorId":2063,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2079,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2067,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2081,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2058,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2059,"metricType":"timing"},{"name":"peak memory","accumulatorId":2057,"metricType":"size"},{"name":"number of output rows","accumulatorId":2056,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2061,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2060,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[2136,9],[2138,9],[2137,26025333],[2137,27063086],[2137,26026566],[2137,26016692],[2137,26040139],[2137,27063086],[2137,26040139],[2137,26026566],[2137,6491833]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[2108,200]]}
{"Event":"SparkListenerJobStart","Job ID":16,"Submission Time":1747830631419,"Stage Infos":[{"Stage ID":33,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":34,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":86,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[85],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"210\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":84,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"209\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[83],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"213\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":85,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"205\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[84],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[33],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[33,34],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":34,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":86,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[85],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"210\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":84,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"209\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[83],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"213\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":85,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"205\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[84],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[33],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830631425,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":100,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830631493,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":101,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830631494,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":102,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830631494,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":103,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830631499,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":104,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":105,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":106,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":107,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":34,"Stage Attempt ID":0,"Task Info":{"Task ID":108,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830636609,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":107,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830636610,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25194724","Value":"25194724","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"5","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1200793","Value":"1200793","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69158184","Value":"69158184","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21451054","Value":"21451054","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1200616","Value":"1200616","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"348684161","Value":"348684161","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2992","Value":"2992","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1200616","Value":"1200616","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1200616","Value":"1200616","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"4832","Value":"4832","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"879","Value":"879","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":122,"Value":122,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":71210700,"Value":71210700,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":4964,"Value":4964,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4173151400,"Value":4173151400,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5498,"Value":5498,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":270,"Internal":true,"Count Failed Values":true},{"ID":2145,"Name":"internal.metrics.resultSerializationTime","Update":6,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":79691168,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21290320,"Value":21290320,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":56622800,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25194724,"Value":25194724,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":5,"Value":5,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200793,"Value":1200793,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21451054,"Value":21451054,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200616,"Value":1200616,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":348684161,"Value":348684161,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":122,"Executor Deserialize CPU Time":71210700,"Executor Run Time":4964,"Executor CPU Time":4173151400,"Peak Execution Memory":56622800,"Result Size":5498,"JVM GC Time":270,"Result Serialization Time":6,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290320,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":5,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25194724,"Total Records Read":1200793,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21451054,"Shuffle Write Time":348684161,"Shuffle Records Written":1200616},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":102,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830631494,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830636647,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25206453","Value":"50401177","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"4","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1200985","Value":"2401778","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69172424","Value":"138330608","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21459294","Value":"42910348","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1200824","Value":"2401440","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"326615049","Value":"675299210","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2936","Value":"5928","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1200824","Value":"2401440","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1200824","Value":"2401440","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"4878","Value":"9710","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"898","Value":"1777","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":123,"Value":245,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":78341000,"Value":149551700,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5012,"Value":9976,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4145060200,"Value":8318211600,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5498,"Value":10996,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":540,"Internal":true,"Count Failed Values":true},{"ID":2145,"Name":"internal.metrics.resultSerializationTime","Update":4,"Value":10,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":159382336,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21295373,"Value":42585693,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":113245600,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":16,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25206453,"Value":50401177,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":4,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200985,"Value":2401778,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21459294,"Value":42910348,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200824,"Value":2401440,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":326615049,"Value":675299210,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":123,"Executor Deserialize CPU Time":78341000,"Executor Run Time":5012,"Executor CPU Time":4145060200,"Peak Execution Memory":56622800,"Result Size":5498,"JVM GC Time":270,"Result Serialization Time":4,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21295373,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":4,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25206453,"Total Records Read":1200985,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21459294,"Shuffle Write Time":326615049,"Shuffle Records Written":1200824},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":100,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830631493,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830636756,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25164830","Value":"75566007","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"5","Value":"14","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1199495","Value":"3601273","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69079136","Value":"207409744","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21427323","Value":"64337671","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1199339","Value":"3600779","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"346772048","Value":"1022071258","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"3143","Value":"9071","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1199339","Value":"3600779","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1199339","Value":"3600779","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"4997","Value":"14707","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"872","Value":"2649","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":121,"Value":366,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":92201300,"Value":241753000,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5129,"Value":15105,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4233720200,"Value":12551931800,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":16451,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":810,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":239073504,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21293776,"Value":63879469,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":169868400,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25164830,"Value":75566007,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":5,"Value":14,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199495,"Value":3601273,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21427323,"Value":64337671,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199339,"Value":3600779,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":346772048,"Value":1022071258,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":121,"Executor Deserialize CPU Time":92201300,"Executor Run Time":5129,"Executor CPU Time":4233720200,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":270,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21293776,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":5,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25164830,"Total Records Read":1199495,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21427323,"Shuffle Write Time":346772048,"Shuffle Records Written":1199339},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":101,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830631494,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830636836,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"26207403","Value":"101773410","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"5","Value":"19","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1249052","Value":"4850325","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"71938504","Value":"279348248","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"22311121","Value":"86648792","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1248877","Value":"4849656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"288696209","Value":"1310767467","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2880","Value":"11951","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1248877","Value":"4849656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1248877","Value":"4849656","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"5082","Value":"19789","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"1040","Value":"3689","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":121,"Value":487,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":89406800,"Value":331159800,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5204,"Value":20309,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4206340400,"Value":16758272200,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":21906,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":1080,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":318764672,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21298509,"Value":85177978,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":226491200,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":32,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26207403,"Value":101773410,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":5,"Value":19,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249052,"Value":4850325,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":22311121,"Value":86648792,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1248877,"Value":4849656,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":288696209,"Value":1310767467,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":121,"Executor Deserialize CPU Time":89406800,"Executor Run Time":5204,"Executor CPU Time":4206340400,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":270,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21298509,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":5,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26207403,"Total Records Read":1249052,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":22311121,"Shuffle Write Time":288696209,"Shuffle Records Written":1248877},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":106,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830636984,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25190770","Value":"126964180","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"5","Value":"24","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1200749","Value":"6051074","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69155624","Value":"348503872","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21452969","Value":"108101761","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1200576","Value":"6050232","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"383796702","Value":"1694564169","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"3220","Value":"15171","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1200576","Value":"6050232","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1200576","Value":"6050232","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"5173","Value":"24962","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"925","Value":"4614","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"398455840","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":116,"Value":603,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":107374800,"Value":438534600,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5355,"Value":25664,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4228742000,"Value":20987014200,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":27361,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":270,"Value":1350,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":398455840,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21290127,"Value":106468105,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":283114000,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":40,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25190770,"Value":126964180,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":5,"Value":24,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1200749,"Value":6051074,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21452969,"Value":108101761,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1200576,"Value":6050232,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":383796702,"Value":1694564169,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":116,"Executor Deserialize CPU Time":107374800,"Executor Run Time":5355,"Executor CPU Time":4228742000,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":270,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21290127,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":5,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25190770,"Total Records Read":1200749,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21452969,"Shuffle Write Time":383796702,"Shuffle Records Written":1200576},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":103,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830631499,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830637051,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25169910","Value":"152134090","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"3","Value":"27","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1199408","Value":"7250482","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69078040","Value":"417581912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21429162","Value":"129530923","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1199236","Value":"7249468","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"413604856","Value":"2108169025","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2846","Value":"18017","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1199236","Value":"7249468","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1199236","Value":"7249468","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"5188","Value":"30150","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"843","Value":"5457","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"478147008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":121,"Value":724,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":94579800,"Value":533114400,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5423,"Value":31087,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4236853900,"Value":25223868100,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":32816,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":282,"Value":1632,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":478147008,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21291736,"Value":127759841,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":339736800,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25169910,"Value":152134090,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":3,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199408,"Value":7250482,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21429162,"Value":129530923,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199236,"Value":7249468,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":413604856,"Value":2108169025,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":121,"Executor Deserialize CPU Time":94579800,"Executor Run Time":5423,"Executor CPU Time":4236853900,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":282,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21291736,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":3,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25169910,"Total Records Read":1199408,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21429162,"Shuffle Write Time":413604856,"Shuffle Records Written":1199236},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":104,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830637112,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"56","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"25161841","Value":"177295931","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"0","Value":"27","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1199182","Value":"8449664","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"69064864","Value":"486646776","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"21425800","Value":"150956723","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1199024","Value":"8448492","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"299435456","Value":"2407604481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2772","Value":"20789","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1199024","Value":"8448492","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1199024","Value":"8448492","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"5363","Value":"35513","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"892","Value":"6349","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"557838176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":144,"Value":868,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":87308200,"Value":620422600,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5463,"Value":36550,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4255279800,"Value":29479147900,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":38271,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":282,"Value":1914,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":557838176,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21288229,"Value":149048070,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":396359600,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":56,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":25161841,"Value":177295931,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1199182,"Value":8449664,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":21425800,"Value":150956723,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1199024,"Value":8448492,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":299435456,"Value":2407604481,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":144,"Executor Deserialize CPU Time":87308200,"Executor Run Time":5463,"Executor CPU Time":4255279800,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":282,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21288229,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":25161841,"Total Records Read":1199182,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":21425800,"Shuffle Write Time":299435456,"Shuffle Records Written":1199024},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":105,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830631500,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830637179,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"26222736","Value":"203518667","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"16","Value":"43","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"1249666","Value":"9699330","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"71972336","Value":"558619112","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"22317182","Value":"173273905","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"1249467","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"337837456","Value":"2745441937","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"2915","Value":"23704","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"1249467","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"1249467","Value":"9697959","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"5402","Value":"40915","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"975","Value":"7324","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"79691168","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":123,"Value":991,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":101355400,"Value":721778000,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":5548,"Value":42098,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":4548076700,"Value":34027224600,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5455,"Value":43726,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":282,"Value":2196,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Update":79691168,"Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Update":21297671,"Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":56622800,"Value":452982400,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":64,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":26222736,"Value":203518667,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":16,"Value":43,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1249666,"Value":9699330,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":22317182,"Value":173273905,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1249467,"Value":9697959,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":337837456,"Value":2745441937,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":941177520,"JVMOffHeapMemory":189284328,"OnHeapExecutionMemory":444381491,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":364987,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":444746478,"OffHeapUnifiedMemory":0,"DirectPoolMemory":32841,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":624,"MinorGCTime":2883,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":2883},"Task Metrics":{"Executor Deserialize Time":123,"Executor Deserialize CPU Time":101355400,"Executor Run Time":5548,"Executor CPU Time":4548076700,"Peak Execution Memory":56622800,"Result Size":5455,"JVM GC Time":282,"Result Serialization Time":0,"Memory Bytes Spilled":79691168,"Disk Bytes Spilled":21297671,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":16,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":26222736,"Total Records Read":1249666,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":22317182,"Shuffle Write Time":337837456,"Shuffle Records Written":1249467},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":34,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":108,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830636609,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830638925,"Failed":false,"Killed":false,"Accumulables":[{"ID":1996,"Name":"local blocks read","Update":"8","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Update":"6302098","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Update":"0","Value":"43","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Update":"300477","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Update":"17302512","Value":"575921624","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Update":"5447040","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Update":"1628652536","Value":"4374094473","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Update":"304","Value":"24008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Update":"300433","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Update":"621","Value":"41536","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Update":"133","Value":"7457","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Update":"33554240","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Update":"0","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Update":5,"Value":996,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Update":5368200,"Value":727146200,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Update":2300,"Value":44398,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Update":2165946300,"Value":36193170900,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Update":5369,"Value":49095,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Update":12,"Value":2208,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Update":33554240,"Value":486536640,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":8,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":6302098,"Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":43,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Update":300477,"Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":5447040,"Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":300433,"Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Update":1628652536,"Value":4374094473,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":5,"Executor Deserialize CPU Time":5368200,"Executor Run Time":2300,"Executor CPU Time":2165946300,"Peak Execution Memory":33554240,"Result Size":5369,"JVM GC Time":12,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":8,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":6302098,"Total Records Read":300477,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":5447040,"Shuffle Write Time":1628652536,"Shuffle Records Written":300433},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":34,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":86,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[85],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"210\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":84,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"209\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[83],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"213\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":85,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"205\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[84],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[33],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830631425,"Completion Time":1747830638925,"Accumulables":[{"ID":1996,"Name":"local blocks read","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":1999,"Name":"local bytes read","Value":"209820765","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2000,"Name":"fetch wait time","Value":"43","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2001,"Name":"records read","Value":"9999807","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2107,"Name":"data size","Value":"575921624","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2126,"Name":"shuffle bytes written","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2127,"Name":"shuffle records written","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2128,"Name":"shuffle write time","Value":"4374094473","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2129,"Name":"duration","Value":"24008","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2130,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2131,"Name":"number of output rows","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2132,"Name":"duration","Value":"41536","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2133,"Name":"sort time","Value":"7457","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2134,"Name":"peak memory","Value":"486536640","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2135,"Name":"spill size","Value":"637529344","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2139,"Name":"internal.metrics.executorDeserializeTime","Value":996,"Internal":true,"Count Failed Values":true},{"ID":2140,"Name":"internal.metrics.executorDeserializeCpuTime","Value":727146200,"Internal":true,"Count Failed Values":true},{"ID":2141,"Name":"internal.metrics.executorRunTime","Value":44398,"Internal":true,"Count Failed Values":true},{"ID":2142,"Name":"internal.metrics.executorCpuTime","Value":36193170900,"Internal":true,"Count Failed Values":true},{"ID":2143,"Name":"internal.metrics.resultSize","Value":49095,"Internal":true,"Count Failed Values":true},{"ID":2144,"Name":"internal.metrics.jvmGCTime","Value":2208,"Internal":true,"Count Failed Values":true},{"ID":2145,"Name":"internal.metrics.resultSerializationTime","Value":10,"Internal":true,"Count Failed Values":true},{"ID":2146,"Name":"internal.metrics.memoryBytesSpilled","Value":637529344,"Internal":true,"Count Failed Values":true},{"ID":2147,"Name":"internal.metrics.diskBytesSpilled","Value":170345741,"Internal":true,"Count Failed Values":true},{"ID":2148,"Name":"internal.metrics.peakExecutionMemory","Value":486536640,"Internal":true,"Count Failed Values":true},{"ID":2150,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2151,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":72,"Internal":true,"Count Failed Values":true},{"ID":2152,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2153,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2154,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":209820765,"Internal":true,"Count Failed Values":true},{"ID":2155,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":43,"Internal":true,"Count Failed Values":true},{"ID":2156,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9999807,"Internal":true,"Count Failed Values":true},{"ID":2157,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2158,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2159,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2160,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2161,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2162,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2163,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2164,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2165,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2166,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2167,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":2168,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":2169,"Name":"internal.metrics.shuffle.write.writeTime","Value":4374094473,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":16,"Completion Time":1747830638926,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":4,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (45)\n+- == Current Plan ==\n   HashAggregate (25)\n   +- ShuffleQueryStage (24)\n      +- Exchange (23)\n         +- * HashAggregate (22)\n            +- * HashAggregate (21)\n               +- * HashAggregate (20)\n                  +- * Project (19)\n                     +- Window (18)\n                        +- * Project (17)\n                           +- Window (16)\n                              +- * Sort (15)\n                                 +- AQEShuffleRead (14)\n                                    +- ShuffleQueryStage (13), Statistics(sizeInBytes=549.2 MiB, rowCount=1.00E+7)\n                                       +- Exchange (12)\n                                          +- * Project (11)\n                                             +- * Filter (10)\n                                                +- SortAggregate (9)\n                                                   +- * Sort (8)\n                                                      +- AQEShuffleRead (7)\n                                                         +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                            +- Exchange (5)\n                                                               +- SortAggregate (4)\n                                                                  +- * Sort (3)\n                                                                     +- * Filter (2)\n                                                                        +- Scan csv  (1)\n+- == Initial Plan ==\n   HashAggregate (44)\n   +- Exchange (43)\n      +- HashAggregate (42)\n         +- HashAggregate (41)\n            +- HashAggregate (40)\n               +- Project (39)\n                  +- Window (38)\n                     +- Project (37)\n                        +- Window (36)\n                           +- Sort (35)\n                              +- Exchange (34)\n                                 +- Project (33)\n                                    +- Filter (32)\n                                       +- SortAggregate (31)\n                                          +- Sort (30)\n                                             +- Exchange (29)\n                                                +- SortAggregate (28)\n                                                   +- Sort (27)\n                                                      +- Filter (26)\n                                                         +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(12) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]\n\n(13) ShuffleQueryStage\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: 1\n\n(14) AQEShuffleRead\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: coalesced\n\n(15) Sort [codegen id : 4]\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(16) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(17) Project [codegen id : 5]\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(18) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(19) Project [codegen id : 6]\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(20) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(21) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(22) HashAggregate [codegen id : 6]\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(23) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1209]\n\n(24) ShuffleQueryStage\nOutput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: 2\n\n(25) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(26) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(27) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(28) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(29) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]\n\n(30) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(31) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(32) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(33) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(34) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]\n\n(35) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(36) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(37) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(38) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(39) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(40) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(41) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(42) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(43) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]\n\n(44) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(45) AdaptiveSparkPlan\nOutput [2]: [toprettystring(avg_session_duration_ms)#326, toprettystring(avg_actions_per_session)#327]\nArguments: isFinalPlan=false\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[avg(session_duration_ms#137L), avg(action_count#139L)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1209]","children":[{"nodeName":"WholeStageCodegen (6)","simpleString":"WholeStageCodegen (6)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#335), count(action_type#331)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#335), partial_count(action_type#331)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#335, action_type#331, session_id#119L]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (5)","simpleString":"WholeStageCodegen (5)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203)]"},"metrics":[{"name":"number of output rows","accumulatorId":1911,"metricType":"sum"},{"name":"number of files read","accumulatorId":1912,"metricType":"sum"},{"name":"metadata time","accumulatorId":1913,"metricType":"timing"},{"name":"size of files read","accumulatorId":1914,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2020,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2017,"metricType":"timing"},{"name":"peak memory","accumulatorId":2018,"metricType":"size"},{"name":"spill size","accumulatorId":2019,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2016,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2015,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2013,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2007,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2014,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2008,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2005,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2002,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2011,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2004,"metricType":"sum"},{"name":"records read","accumulatorId":2001,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1999,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2000,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1997,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2003,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1996,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2006,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1995,"metricType":"sum"},{"name":"data size","accumulatorId":1993,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2009,"metricType":"size"},{"name":"number of partitions","accumulatorId":1994,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2010,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1998,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2012,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":2136,"metricType":"sum"},{"name":"partition data size","accumulatorId":2137,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":2138,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2133,"metricType":"timing"},{"name":"peak memory","accumulatorId":2134,"metricType":"size"},{"name":"spill size","accumulatorId":2135,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2132,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2131,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2130,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2129,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2127,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2121,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2128,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2122,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2119,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2116,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2125,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2118,"metricType":"sum"},{"name":"records read","accumulatorId":2115,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2113,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2114,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2111,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2117,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2110,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2120,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2109,"metricType":"sum"},{"name":"data size","accumulatorId":2107,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2123,"metricType":"size"},{"name":"number of partitions","accumulatorId":2108,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2124,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2112,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2126,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":2228,"metricType":"sum"},{"name":"partition data size","accumulatorId":2229,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":2230,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2225,"metricType":"timing"},{"name":"peak memory","accumulatorId":2226,"metricType":"size"},{"name":"spill size","accumulatorId":2227,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2224,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2223,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2222,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2221,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2217,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2218,"metricType":"timing"},{"name":"peak memory","accumulatorId":2216,"metricType":"size"},{"name":"number of output rows","accumulatorId":2215,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2220,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2219,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2211,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2212,"metricType":"timing"},{"name":"peak memory","accumulatorId":2210,"metricType":"size"},{"name":"number of output rows","accumulatorId":2209,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2214,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2213,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2205,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2206,"metricType":"timing"},{"name":"peak memory","accumulatorId":2204,"metricType":"size"},{"name":"number of output rows","accumulatorId":2203,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2208,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2207,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2202,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2200,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2194,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2201,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2195,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2192,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2189,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2198,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2191,"metricType":"sum"},{"name":"records read","accumulatorId":2188,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2186,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2187,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2184,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2190,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2183,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2193,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2182,"metricType":"sum"},{"name":"data size","accumulatorId":2180,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2196,"metricType":"size"},{"name":"number of partitions","accumulatorId":2181,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2197,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2185,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2199,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2176,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2177,"metricType":"timing"},{"name":"peak memory","accumulatorId":2175,"metricType":"size"},{"name":"number of output rows","accumulatorId":2174,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2179,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2178,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[2228,9],[2230,9],[2229,22904968],[2229,23233144],[2229,22821911],[2229,23357100],[2229,22812722],[2229,22324493],[2229,22802657],[2229,22505248],[2229,4702698]]}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":4,"accumUpdates":[[2181,1]]}
{"Event":"SparkListenerJobStart","Job ID":17,"Submission Time":1747830639795,"Stage Infos":[{"Stage ID":37,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":93,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[92],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":91,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"221\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[90],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":92,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"215\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[91],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":90,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"222\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[89],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":88,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"226\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[87],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":87,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"229\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[86],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":89,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"225\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[88],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[36],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":35,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":36,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":86,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[85],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"210\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":84,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"209\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[83],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"213\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":85,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"205\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[84],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[35],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[37,35,36],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":37,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":93,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[92],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":91,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"221\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[90],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":92,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"215\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[91],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":90,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"222\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[89],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":88,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"226\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[87],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":87,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"229\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[86],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":89,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"225\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[88],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[36],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830639798,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":109,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830639809,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":110,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830639810,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":111,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":112,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":113,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":114,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":115,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830639812,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":116,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830639812,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskStart","Stage ID":37,"Stage Attempt ID":0,"Task Info":{"Task ID":117,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830659049,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":109,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830639809,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659069,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21801546","Value":"21801546","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1219784","Value":"1219784","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"40","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"77","Value":"77","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"2630124","Value":"2630124","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"17788","Value":"17788","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"17786","Value":"17786","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"687557","Value":"687557","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"77594224","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16095","Value":"16095","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"687557","Value":"687557","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"49943054","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"73011614","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"12045","Value":"12045","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"8388544","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"12799","Value":"12799","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14035","Value":"14035","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"412","Value":"412","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"56622800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"39845584","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":21,"Value":21,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12863500,"Value":12863500,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19170,"Value":19170,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":10298222800,"Value":10298222800,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8078,"Value":8078,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":858,"Value":858,"Internal":true,"Count Failed Values":true},{"ID":2237,"Name":"internal.metrics.resultSerializationTime","Update":12,"Value":12,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":249171358,"Value":249171358,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":43012898,"Value":43012898,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":163188654,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21801546,"Value":21801546,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1219784,"Value":1219784,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":77,"Value":77,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":2630124,"Value":2630124,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":21,"Executor Deserialize CPU Time":12863500,"Executor Run Time":19170,"Executor CPU Time":10298222800,"Peak Execution Memory":163188654,"Result Size":8078,"JVM GC Time":858,"Result Serialization Time":12,"Memory Bytes Spilled":249171358,"Disk Bytes Spilled":43012898,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21801546,"Total Records Read":1219784,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":77,"Shuffle Write Time":2630124,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":111,"Index":2,"Attempt":0,"Partition ID":2,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659095,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21635941","Value":"43437487","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1210181","Value":"2429965","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"80","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"152","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"5644446","Value":"8274570","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"17826","Value":"35614","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"17825","Value":"35611","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"683070","Value":"1370627","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"155188448","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16417","Value":"32512","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"683070","Value":"1370627","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"99886108","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"146023228","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"12044","Value":"24089","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"32","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"16777088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"13091","Value":"25890","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14392","Value":"28427","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"517","Value":"929","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"113245600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"79691168","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":43,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":10249500,"Value":23113000,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19192,"Value":38362,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":9975196300,"Value":20273419100,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8035,"Value":16113,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":858,"Value":1716,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":249171358,"Value":498342716,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":42696373,"Value":85709271,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":326377308,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":18,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21635941,"Value":43437487,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1210181,"Value":2429965,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":152,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":2,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":5644446,"Value":8274570,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":10249500,"Executor Run Time":19192,"Executor CPU Time":9975196300,"Peak Execution Memory":163188654,"Result Size":8035,"JVM GC Time":858,"Result Serialization Time":0,"Memory Bytes Spilled":249171358,"Disk Bytes Spilled":42696373,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21635941,"Total Records Read":1210181,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":5644446,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":110,"Index":1,"Attempt":0,"Partition ID":1,"Launch Time":1747830639810,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659095,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"27","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"22181525","Value":"65619012","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1240838","Value":"3670803","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"120","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"227","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"3","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"3347753","Value":"11622323","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"16192","Value":"51806","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"3","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"16186","Value":"51797","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"699863","Value":"2070490","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"79691360","Value":"234879808","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"14400","Value":"46912","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"3","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"699863","Value":"2070490","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"149829162","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"75108750","Value":"221131978","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"11735","Value":"35824","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"48","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"3","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"25165632","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"12747","Value":"38637","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"13986","Value":"42413","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"460","Value":"1389","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"169868400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"119536752","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":65,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":14135900,"Value":37248900,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19227,"Value":57589,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":10669314800,"Value":30942733900,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8078,"Value":24191,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":858,"Value":2574,"Internal":true,"Count Failed Values":true},{"ID":2237,"Name":"internal.metrics.resultSerializationTime","Update":10,"Value":22,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":255462766,"Value":753805482,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":43824002,"Value":129533273,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":489565962,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":22181525,"Value":65619012,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1240838,"Value":3670803,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":227,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":3347753,"Value":11622323,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":14135900,"Executor Run Time":19227,"Executor CPU Time":10669314800,"Peak Execution Memory":163188654,"Result Size":8078,"JVM GC Time":858,"Result Serialization Time":10,"Memory Bytes Spilled":255462766,"Disk Bytes Spilled":43824002,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":22181525,"Total Records Read":1240838,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":3347753,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":114,"Index":5,"Attempt":0,"Partition ID":5,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659123,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"36","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21276255","Value":"86895267","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1190293","Value":"4861096","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"160","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"302","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"4","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"1226438","Value":"12848761","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"17927","Value":"69733","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"4","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"17923","Value":"69720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"671587","Value":"2742077","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"312474032","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16226","Value":"63138","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"4","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"671587","Value":"2742077","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"199772216","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"294143592","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"13420","Value":"49244","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"64","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"4","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"33554176","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"13035","Value":"51672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14214","Value":"56627","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"533","Value":"1922","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"226491200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"159382336","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":21,"Value":86,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":9219100,"Value":46468000,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19269,"Value":76858,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":11959630500,"Value":42902364400,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8035,"Value":32226,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":860,"Value":3434,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":247074222,"Value":1000879704,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":41982047,"Value":171515320,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":652754616,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":36,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21276255,"Value":86895267,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1190293,"Value":4861096,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":302,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":1226438,"Value":12848761,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":21,"Executor Deserialize CPU Time":9219100,"Executor Run Time":19269,"Executor CPU Time":11959630500,"Peak Execution Memory":163188654,"Result Size":8035,"JVM GC Time":860,"Result Serialization Time":0,"Memory Bytes Spilled":247074222,"Disk Bytes Spilled":41982047,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21276255,"Total Records Read":1190293,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":1226438,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":116,"Index":7,"Attempt":0,"Partition ID":7,"Launch Time":1747830639812,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659190,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"45","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21419698","Value":"108314965","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1198263","Value":"6059359","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"200","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"377","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"492842","Value":"13341603","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"17995","Value":"87728","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"17993","Value":"87713","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"676509","Value":"3418586","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"390068256","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16393","Value":"79531","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"80","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"676509","Value":"3418586","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"249715270","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"367155206","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"12045","Value":"61289","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"80","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"5","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"41942720","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"12982","Value":"64654","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14238","Value":"70865","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"425","Value":"2347","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"283114000","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"199227920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":25,"Value":111,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":16280200,"Value":62748200,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19342,"Value":96200,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":9745290100,"Value":52647654500,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8078,"Value":40304,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":867,"Value":4301,"Internal":true,"Count Failed Values":true},{"ID":2237,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":23,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":249171358,"Value":1250051062,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":42263666,"Value":213778986,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":815943270,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":45,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21419698,"Value":108314965,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1198263,"Value":6059359,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":377,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":5,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":492842,"Value":13341603,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":25,"Executor Deserialize CPU Time":16280200,"Executor Run Time":19342,"Executor CPU Time":9745290100,"Peak Execution Memory":163188654,"Result Size":8078,"JVM GC Time":867,"Result Serialization Time":1,"Memory Bytes Spilled":249171358,"Disk Bytes Spilled":42263666,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21419698,"Total Records Read":1198263,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":492842,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":113,"Index":4,"Attempt":0,"Partition ID":4,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659190,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"54","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21843624","Value":"130158589","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1222214","Value":"7281573","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"240","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"77","Value":"454","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"6","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"4053285","Value":"17394888","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"17994","Value":"105722","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"6","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"17989","Value":"105702","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"688742","Value":"4107328","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"467662480","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16286","Value":"95817","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"96","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"6","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"688742","Value":"4107328","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"299658324","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"440166820","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"12038","Value":"73327","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"96","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"6","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"50331264","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"13236","Value":"77890","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14486","Value":"85351","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"378","Value":"2725","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"339736800","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"239073504","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":21,"Value":132,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12231400,"Value":74979600,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19334,"Value":115534,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":10429896500,"Value":63077551000,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8035,"Value":48339,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":867,"Value":5168,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":249171358,"Value":1499222420,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":43109278,"Value":256888264,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":979131924,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":54,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21843624,"Value":130158589,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1222214,"Value":7281573,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":77,"Value":454,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":4053285,"Value":17394888,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":21,"Executor Deserialize CPU Time":12231400,"Executor Run Time":19334,"Executor CPU Time":10429896500,"Peak Execution Memory":163188654,"Result Size":8035,"JVM GC Time":867,"Result Serialization Time":0,"Memory Bytes Spilled":249171358,"Disk Bytes Spilled":43109278,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21843624,"Total Records Read":1222214,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":77,"Shuffle Write Time":4053285,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":115,"Index":6,"Attempt":0,"Partition ID":6,"Launch Time":1747830639812,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659227,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"63","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"21780807","Value":"151939396","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1218528","Value":"8500101","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"529","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"7","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"6123103","Value":"23517991","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"18042","Value":"123764","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"7","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"18035","Value":"123737","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"687901","Value":"4795229","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"77594224","Value":"545256704","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"16491","Value":"112308","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"112","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"7","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"687901","Value":"4795229","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"349601378","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"73011614","Value":"513178434","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"12020","Value":"85347","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"112","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"7","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"58719808","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"12704","Value":"90594","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"13892","Value":"99243","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"446","Value":"3171","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"396359600","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"278919088","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":154,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":12804900,"Value":87784500,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19384,"Value":134918,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":10605057500,"Value":73682608500,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8035,"Value":56374,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":867,"Value":6035,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":249171358,"Value":1748393778,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":43005880,"Value":299894144,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":1142320578,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":63,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":21780807,"Value":151939396,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1218528,"Value":8500101,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":529,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":6123103,"Value":23517991,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":12804900,"Executor Run Time":19384,"Executor CPU Time":10605057500,"Peak Execution Memory":163188654,"Result Size":8035,"JVM GC Time":867,"Result Serialization Time":0,"Memory Bytes Spilled":249171358,"Disk Bytes Spilled":43005880,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":21780807,"Total Records Read":1218528,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":6123103,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":112,"Index":3,"Attempt":0,"Partition ID":3,"Launch Time":1747830639811,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830659269,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"72","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"22317123","Value":"174256519","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"1248598","Value":"9748699","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"320","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"77","Value":"606","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"678929","Value":"24196920","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"16126","Value":"139890","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"16125","Value":"139862","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"704614","Value":"5499843","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Update":"79691360","Value":"624948064","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"15266","Value":"127574","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"128","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Update":"1","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"704614","Value":"5499843","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"49943054","Value":"399544432","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Update":"75108750","Value":"588287184","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"11474","Value":"96821","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"128","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Update":"1","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"8388544","Value":"67108352","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"12928","Value":"103522","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"14238","Value":"113481","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"516","Value":"3687","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"56622800","Value":"452982400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"39845584","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":22,"Value":176,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":13878000,"Value":101662500,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":19423,"Value":154341,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":10252228800,"Value":83934837300,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":8035,"Value":64409,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":867,"Value":6902,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Update":255462766,"Value":2003856544,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Update":44086072,"Value":343980216,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":163188654,"Value":1305509232,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":72,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":22317123,"Value":174256519,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1248598,"Value":9748699,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":77,"Value":606,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":678929,"Value":24196920,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":917913824,"JVMOffHeapMemory":191585208,"OnHeapExecutionMemory":250365656,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":382835,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":250748491,"OffHeapUnifiedMemory":0,"DirectPoolMemory":16810057,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":677,"MinorGCTime":3536,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":3536},"Task Metrics":{"Executor Deserialize Time":22,"Executor Deserialize CPU Time":13878000,"Executor Run Time":19423,"Executor CPU Time":10252228800,"Peak Execution Memory":163188654,"Result Size":8035,"JVM GC Time":867,"Result Serialization Time":0,"Memory Bytes Spilled":255462766,"Disk Bytes Spilled":44086072,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":22317123,"Total Records Read":1248598,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":77,"Shuffle Write Time":678929,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":37,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":117,"Index":8,"Attempt":0,"Partition ID":8,"Launch Time":1747830659049,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830660994,"Failed":false,"Killed":false,"Accumulables":[{"ID":2110,"Name":"local blocks read","Update":"9","Value":"81","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Update":"4464426","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Update":"249693","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Update":"40","Value":"360","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Update":"75","Value":"681","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Update":"1","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Update":"430674175","Value":"454871095","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Update":"725","Value":"140615","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Update":"1","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Update":"708","Value":"140570","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Update":"140988","Value":"5640831","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Update":"18874288","Value":"471856688","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Update":"695","Value":"128269","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Update":"16","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Update":"140988","Value":"5640831","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Update":"12582848","Value":"412127280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Update":"557","Value":"97378","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Update":"16","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Update":"0","Value":"67108352","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Update":"619","Value":"104141","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Update":"1197","Value":"114678","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Update":"171","Value":"3858","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Update":"25165696","Value":"478148096","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Update":"0","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Update":76,"Value":252,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Update":42411100,"Value":144073600,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Update":1840,"Value":156181,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Update":1507147400,"Value":85441984700,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Update":7949,"Value":72358,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Update":34,"Value":6936,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Update":56622832,"Value":1362132064,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":81,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":4464426,"Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Update":249693,"Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":75,"Value":681,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Update":430674175,"Value":454871095,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":76,"Executor Deserialize CPU Time":42411100,"Executor Run Time":1840,"Executor CPU Time":1507147400,"Peak Execution Memory":56622832,"Result Size":7949,"JVM GC Time":34,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":4464426,"Total Records Read":249693,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":75,"Shuffle Write Time":430674175,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":37,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":93,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[92],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":91,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"221\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[90],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":92,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"215\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[91],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":90,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"222\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[89],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":88,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"226\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[87],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":87,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"229\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[86],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":89,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"225\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[88],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[36],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830639798,"Completion Time":1747830661174,"Accumulables":[{"ID":2110,"Name":"local blocks read","Value":"81","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2113,"Name":"local bytes read","Value":"178720945","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2114,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2115,"Name":"records read","Value":"9998392","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2180,"Name":"data size","Value":"360","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2199,"Name":"shuffle bytes written","Value":"681","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2200,"Name":"shuffle records written","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2201,"Name":"shuffle write time","Value":"454871095","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2202,"Name":"duration","Value":"140615","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2203,"Name":"number of output rows","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2206,"Name":"time in aggregation build","Value":"140570","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2209,"Name":"number of output rows","Value":"5640831","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2210,"Name":"peak memory","Value":"471856688","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2211,"Name":"spill size","Value":"624948064","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2212,"Name":"time in aggregation build","Value":"128269","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2213,"Name":"avg hash probes per key","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2214,"Name":"number of sort fallback tasks","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2215,"Name":"number of output rows","Value":"5640831","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2216,"Name":"peak memory","Value":"412127280","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2217,"Name":"spill size","Value":"588287184","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2218,"Name":"time in aggregation build","Value":"97378","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2219,"Name":"avg hash probes per key","Value":"144","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2220,"Name":"number of sort fallback tasks","Value":"8","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2221,"Name":"spill size","Value":"67108352","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2222,"Name":"duration","Value":"104141","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2223,"Name":"spill size","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2224,"Name":"duration","Value":"114678","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2225,"Name":"sort time","Value":"3858","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2226,"Name":"peak memory","Value":"478148096","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2227,"Name":"spill size","Value":"318764672","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2231,"Name":"internal.metrics.executorDeserializeTime","Value":252,"Internal":true,"Count Failed Values":true},{"ID":2232,"Name":"internal.metrics.executorDeserializeCpuTime","Value":144073600,"Internal":true,"Count Failed Values":true},{"ID":2233,"Name":"internal.metrics.executorRunTime","Value":156181,"Internal":true,"Count Failed Values":true},{"ID":2234,"Name":"internal.metrics.executorCpuTime","Value":85441984700,"Internal":true,"Count Failed Values":true},{"ID":2235,"Name":"internal.metrics.resultSize","Value":72358,"Internal":true,"Count Failed Values":true},{"ID":2236,"Name":"internal.metrics.jvmGCTime","Value":6936,"Internal":true,"Count Failed Values":true},{"ID":2237,"Name":"internal.metrics.resultSerializationTime","Value":23,"Internal":true,"Count Failed Values":true},{"ID":2238,"Name":"internal.metrics.memoryBytesSpilled","Value":2003856544,"Internal":true,"Count Failed Values":true},{"ID":2239,"Name":"internal.metrics.diskBytesSpilled","Value":343980216,"Internal":true,"Count Failed Values":true},{"ID":2240,"Name":"internal.metrics.peakExecutionMemory","Value":1362132064,"Internal":true,"Count Failed Values":true},{"ID":2242,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2243,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":81,"Internal":true,"Count Failed Values":true},{"ID":2244,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2245,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2246,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":178720945,"Internal":true,"Count Failed Values":true},{"ID":2247,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2248,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9998392,"Internal":true,"Count Failed Values":true},{"ID":2249,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2250,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2251,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2252,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2253,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2254,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2255,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2256,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2257,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2258,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2259,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":681,"Internal":true,"Count Failed Values":true},{"ID":2260,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":9,"Internal":true,"Count Failed Values":true},{"ID":2261,"Name":"internal.metrics.shuffle.write.writeTime","Value":454871095,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":17,"Completion Time":1747830661201,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":4,"physicalPlanDescription":"== Physical Plan ==\nAdaptiveSparkPlan (45)\n+- == Final Plan ==\n   * HashAggregate (25)\n   +- ShuffleQueryStage (24), Statistics(sizeInBytes=360.0 B, rowCount=9)\n      +- Exchange (23)\n         +- * HashAggregate (22)\n            +- * HashAggregate (21)\n               +- * HashAggregate (20)\n                  +- * Project (19)\n                     +- Window (18)\n                        +- * Project (17)\n                           +- Window (16)\n                              +- * Sort (15)\n                                 +- AQEShuffleRead (14)\n                                    +- ShuffleQueryStage (13), Statistics(sizeInBytes=549.2 MiB, rowCount=1.00E+7)\n                                       +- Exchange (12)\n                                          +- * Project (11)\n                                             +- * Filter (10)\n                                                +- SortAggregate (9)\n                                                   +- * Sort (8)\n                                                      +- AQEShuffleRead (7)\n                                                         +- ShuffleQueryStage (6), Statistics(sizeInBytes=701.9 MiB, rowCount=1.00E+7)\n                                                            +- Exchange (5)\n                                                               +- SortAggregate (4)\n                                                                  +- * Sort (3)\n                                                                     +- * Filter (2)\n                                                                        +- Scan csv  (1)\n+- == Initial Plan ==\n   HashAggregate (44)\n   +- Exchange (43)\n      +- HashAggregate (42)\n         +- HashAggregate (41)\n            +- HashAggregate (40)\n               +- Project (39)\n                  +- Window (38)\n                     +- Project (37)\n                        +- Window (36)\n                           +- Sort (35)\n                              +- Exchange (34)\n                                 +- Project (33)\n                                    +- Filter (32)\n                                       +- SortAggregate (31)\n                                          +- Sort (30)\n                                             +- Exchange (29)\n                                                +- SortAggregate (28)\n                                                   +- Sort (27)\n                                                      +- Filter (26)\n                                                         +- Scan csv  (1)\n\n\n(1) Scan csv \nOutput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nBatched: false\nLocation: InMemoryFileIndex [file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]\nPushedFilters: [IsNotNull(user_id)]\nReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>\n\n(2) Filter [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(3) Sort [codegen id : 1]\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(4) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(5) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]\n\n(6) ShuffleQueryStage\nOutput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: 0\n\n(7) AQEShuffleRead\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: coalesced\n\n(8) Sort [codegen id : 2]\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(9) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(10) Filter [codegen id : 3]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(11) Project [codegen id : 3]\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(12) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]\n\n(13) ShuffleQueryStage\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: 1\n\n(14) AQEShuffleRead\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: coalesced\n\n(15) Sort [codegen id : 4]\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(16) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(17) Project [codegen id : 5]\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(18) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(19) Project [codegen id : 6]\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(20) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(21) HashAggregate [codegen id : 6]\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(22) HashAggregate [codegen id : 6]\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(23) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1209]\n\n(24) ShuffleQueryStage\nOutput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: 2\n\n(25) HashAggregate [codegen id : 7]\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(26) Filter\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nCondition : ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))\n\n(27) Sort\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(28) SortAggregate\nInput [4]: [user_id#17, timestamp#18, action_type#19, duration_ms#21]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [partial_first(action_type#19, false), partial_first(duration_ms#21, false)]\nAggregate Attributes [4]: [first#350, valueSet#351, first#352, valueSet#353]\nResults [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\n\n(29) Exchange\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=939]\n\n(30) Sort\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0\n\n(31) SortAggregate\nInput [6]: [user_id#17, timestamp#18, first#354, valueSet#355, first#356, valueSet#357]\nKeys [2]: [user_id#17, timestamp#18]\nFunctions [2]: [first(action_type#19, false), first(duration_ms#21, false)]\nAggregate Attributes [2]: [first(action_type#19)()#330, first(duration_ms#21)()#334]\nResults [4]: [user_id#17, gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) AS timestamp#30, first(action_type#19)()#330 AS action_type#331, first(duration_ms#21)()#334 AS duration_ms#335]\n\n(32) Filter\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\nCondition : (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))\n\n(33) Project\nOutput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nInput [4]: [user_id#17, timestamp#30, action_type#331, duration_ms#335]\n\n(34) Exchange\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=945]\n\n(35) Sort\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0\n\n(36) Window\nInput [4]: [user_id#17, timestamp#30, duration_ms#335, action_type#331]\nArguments: [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(37) Project\nOutput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, prev_timestamp#97]\n\n(38) Window\nInput [5]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110]\nArguments: [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]\n\n(39) Project\nOutput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nInput [6]: [user_id#17, timestamp#30, duration_ms#335, action_type#331, is_new_session#110, session_id#119L]\n\n(40) HashAggregate\nInput [4]: [user_id#17, duration_ms#335, action_type#331, session_id#119L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [partial_sum(duration_ms#335), partial_count(action_type#331)]\nAggregate Attributes [2]: [sum#346L, count#347L]\nResults [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\n\n(41) HashAggregate\nInput [4]: [user_id#17, session_id#119L, sum#348L, count#349L]\nKeys [2]: [user_id#17, session_id#119L]\nFunctions [2]: [sum(duration_ms#335), count(action_type#331)]\nAggregate Attributes [2]: [sum(duration_ms#335)#136L, count(action_type#331)#138L]\nResults [2]: [sum(duration_ms#335)#136L AS session_duration_ms#137L, count(action_type#331)#138L AS action_count#139L]\n\n(42) HashAggregate\nInput [2]: [session_duration_ms#137L, action_count#139L]\nKeys: []\nFunctions [2]: [partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)]\nAggregate Attributes [4]: [sum#338, count#339L, sum#340, count#341L]\nResults [4]: [sum#342, count#343L, sum#344, count#345L]\n\n(43) Exchange\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nArguments: SinglePartition, ENSURE_REQUIREMENTS, [plan_id=955]\n\n(44) HashAggregate\nInput [4]: [sum#342, count#343L, sum#344, count#345L]\nKeys: []\nFunctions [2]: [avg(session_duration_ms#137L), avg(action_count#139L)]\nAggregate Attributes [2]: [avg(session_duration_ms#137L)#144, avg(action_count#139L)#146]\nResults [2]: [toprettystring(avg(session_duration_ms#137L)#144, Some(Asia/Hong_Kong)) AS toprettystring(avg_session_duration_ms)#326, toprettystring(avg(action_count#139L)#146, Some(Asia/Hong_Kong)) AS toprettystring(avg_actions_per_session)#327]\n\n(45) AdaptiveSparkPlan\nOutput [2]: [toprettystring(avg_session_duration_ms)#326, toprettystring(avg_actions_per_session)#327]\nArguments: isFinalPlan=true\n\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"WholeStageCodegen (7)","simpleString":"WholeStageCodegen (7)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[avg(session_duration_ms#137L), avg(action_count#139L)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 2","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1209]","children":[{"nodeName":"WholeStageCodegen (6)","simpleString":"WholeStageCodegen (6)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_avg(session_duration_ms#137L), partial_avg(action_count#139L)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[sum(duration_ms#335), count(action_type#331)])","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[user_id#17, session_id#119L], functions=[partial_sum(duration_ms#335), partial_count(action_type#331)])","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, duration_ms#335, action_type#331, session_id#119L]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [sum(is_new_session#110) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, unboundedpreceding$(), currentrow$())) AS session_id#119L], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (5)","simpleString":"WholeStageCodegen (5)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331, CASE WHEN CASE WHEN isnotnull(prev_timestamp#97) THEN ((unix_timestamp(timestamp#30, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false) - unix_timestamp(prev_timestamp#97, yyyy-MM-dd HH:mm:ss, Some(Asia/Hong_Kong), false)) > 1800) ELSE false END THEN 1 ELSE 0 END AS is_new_session#110]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Window","simpleString":"Window [lag(timestamp#30, -1, null) windowspecdefinition(user_id#17, timestamp#30 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)) AS prev_timestamp#97], [user_id#17], [timestamp#30 ASC NULLS FIRST]","children":[{"nodeName":"WholeStageCodegen (4)","simpleString":"WholeStageCodegen (4)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#30 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 1","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, 200), ENSURE_REQUIREMENTS, [plan_id=1107]","children":[{"nodeName":"WholeStageCodegen (3)","simpleString":"WholeStageCodegen (3)","children":[{"nodeName":"Project","simpleString":"Project [user_id#17, timestamp#30, duration_ms#335, action_type#331]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(duration_ms#335) AND ((action_type#331 IN (create,edit,share,page_view,delete) AND (duration_ms#335 >= -127618)) AND (duration_ms#335 <= 420681)))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[first(action_type#19, false), first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"AQEShuffleRead","simpleString":"AQEShuffleRead coalesced","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange hashpartitioning(user_id#17, timestamp#18, 200), ENSURE_REQUIREMENTS, [plan_id=998]","children":[{"nodeName":"SortAggregate","simpleString":"SortAggregate(key=[user_id#17, timestamp#18], functions=[partial_first(action_type#19, false), partial_first(duration_ms#21, false)])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Sort","simpleString":"Sort [user_id#17 ASC NULLS FIRST, timestamp#18 ASC NULLS FIRST], false, 0","children":[{"nodeName":"Filter","simpleString":"Filter ((isnotnull(user_id#17) AND isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false))) AND (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [user_id#17,timestamp#18,action_type#19,duration_ms#21] Batched: false, DataFilters: [isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, ..., Format: CSV, Location: InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/sr..., PartitionFilters: [], PushedFilters: [IsNotNull(user_id)], ReadSchema: struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","children":[],"metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/user_interactions_sample.csv]","ReadSchema":"struct<user_id:string,timestamp:timestamp,action_type:string,duration_ms:int>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(user_id)]","DataFilters":"[isnotnull(user_id#17), isnotnull(gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false)), (gettimestamp(timestamp#18, yyyy-MM-dd HH:mm:ss, TimestampType, Some(Asia/Hong_Kong), false) <= 2025-05-21 20:30:10.511203)]"},"metrics":[{"name":"number of output rows","accumulatorId":1911,"metricType":"sum"},{"name":"number of files read","accumulatorId":1912,"metricType":"sum"},{"name":"metadata time","accumulatorId":1913,"metricType":"timing"},{"name":"size of files read","accumulatorId":1914,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2020,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2017,"metricType":"timing"},{"name":"peak memory","accumulatorId":2018,"metricType":"size"},{"name":"spill size","accumulatorId":2019,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2016,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2015,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2013,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2007,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2014,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2008,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2005,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2002,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2011,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2004,"metricType":"sum"},{"name":"records read","accumulatorId":2001,"metricType":"sum"},{"name":"local bytes read","accumulatorId":1999,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2000,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":1997,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2003,"metricType":"sum"},{"name":"local blocks read","accumulatorId":1996,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2006,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1995,"metricType":"sum"},{"name":"data size","accumulatorId":1993,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2009,"metricType":"size"},{"name":"number of partitions","accumulatorId":1994,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2010,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":1998,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2012,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":2136,"metricType":"sum"},{"name":"partition data size","accumulatorId":2137,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":2138,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2133,"metricType":"timing"},{"name":"peak memory","accumulatorId":2134,"metricType":"size"},{"name":"spill size","accumulatorId":2135,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2132,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2131,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":2130,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2129,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2127,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2121,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2128,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2122,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2119,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2116,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2125,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2118,"metricType":"sum"},{"name":"records read","accumulatorId":2115,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2113,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2114,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2111,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2117,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2110,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2120,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2109,"metricType":"sum"},{"name":"data size","accumulatorId":2107,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2123,"metricType":"size"},{"name":"number of partitions","accumulatorId":2108,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2124,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2112,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2126,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of partitions","accumulatorId":2228,"metricType":"sum"},{"name":"partition data size","accumulatorId":2229,"metricType":"size"},{"name":"number of coalesced partitions","accumulatorId":2230,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":2225,"metricType":"timing"},{"name":"peak memory","accumulatorId":2226,"metricType":"size"},{"name":"spill size","accumulatorId":2227,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2224,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2223,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2222,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2221,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2217,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2218,"metricType":"timing"},{"name":"peak memory","accumulatorId":2216,"metricType":"size"},{"name":"number of output rows","accumulatorId":2215,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2220,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2219,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2211,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2212,"metricType":"timing"},{"name":"peak memory","accumulatorId":2210,"metricType":"size"},{"name":"number of output rows","accumulatorId":2209,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2214,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2213,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2205,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2206,"metricType":"timing"},{"name":"peak memory","accumulatorId":2204,"metricType":"size"},{"name":"number of output rows","accumulatorId":2203,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2208,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2207,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2202,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":2200,"metricType":"sum"},{"name":"local merged chunks fetched","accumulatorId":2194,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":2201,"metricType":"nsTiming"},{"name":"remote merged bytes read","accumulatorId":2195,"metricType":"size"},{"name":"local merged blocks fetched","accumulatorId":2192,"metricType":"sum"},{"name":"corrupt merged block chunks","accumulatorId":2189,"metricType":"sum"},{"name":"remote merged reqs duration","accumulatorId":2198,"metricType":"timing"},{"name":"remote merged blocks fetched","accumulatorId":2191,"metricType":"sum"},{"name":"records read","accumulatorId":2188,"metricType":"sum"},{"name":"local bytes read","accumulatorId":2186,"metricType":"size"},{"name":"fetch wait time","accumulatorId":2187,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":2184,"metricType":"size"},{"name":"merged fetch fallback count","accumulatorId":2190,"metricType":"sum"},{"name":"local blocks read","accumulatorId":2183,"metricType":"sum"},{"name":"remote merged chunks fetched","accumulatorId":2193,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":2182,"metricType":"sum"},{"name":"data size","accumulatorId":2180,"metricType":"size"},{"name":"local merged bytes read","accumulatorId":2196,"metricType":"size"},{"name":"number of partitions","accumulatorId":2181,"metricType":"sum"},{"name":"remote reqs duration","accumulatorId":2197,"metricType":"timing"},{"name":"remote bytes read to disk","accumulatorId":2185,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":2199,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":2269,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":2270,"metricType":"timing"},{"name":"peak memory","accumulatorId":2268,"metricType":"size"},{"name":"number of output rows","accumulatorId":2267,"metricType":"sum"},{"name":"number of sort fallback tasks","accumulatorId":2272,"metricType":"sum"},{"name":"avg hash probes per key","accumulatorId":2271,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":2266,"metricType":"timing"}]}],"metadata":{},"metrics":[]}}
{"Event":"SparkListenerJobStart","Job ID":18,"Submission Time":1747830660618,"Stage Infos":[{"Stage ID":38,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":8,"RDD Info":[{"RDD ID":81,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"197\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"198\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"199\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"203\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"DETERMINATE","Number of Partitions":8,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":39,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":86,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"204\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[85],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"210\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":84,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"209\",\"name\":\"SortAggregate\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[83],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"213\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":85,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"205\",\"name\":\"WholeStageCodegen (3)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[84],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[38],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":40,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":9,"RDD Info":[{"RDD ID":93,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"214\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[92],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":91,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"221\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[90],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":92,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"215\",\"name\":\"WholeStageCodegen (6)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[91],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":90,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"222\",\"name\":\"WholeStageCodegen (5)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[89],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":88,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"226\",\"name\":\"WholeStageCodegen (4)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[87],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":87,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"229\",\"name\":\"AQEShuffleRead\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[86],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":89,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"225\",\"name\":\"Window\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[88],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":9,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[39],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},{"Stage ID":41,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":96,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"235\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[95],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":94,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"234\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[93],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":95,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"230\",\"name\":\"WholeStageCodegen (7)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[94],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[40],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}],"Stage IDs":[38,39,40,41],"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"236\",\"name\":\"collect\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":41,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":96,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"235\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[95],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":94,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"234\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[93],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":95,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"230\",\"name\":\"WholeStageCodegen (7)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[94],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[40],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830660620,"Accumulables":[],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0},"Properties":{"spark.driver.port":"36709","spark.submit.pyFiles":"","spark.app.startTime":"1747830506050","spark.rdd.scope":"{\"id\":\"236\",\"name\":\"collect\"}","spark.rdd.compress":"True","spark.app.submitTime":"1747830505830","spark.eventLog.dir":"file:///mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/spark-events","spark.sql.execution.id":"4","spark.sql.warehouse.dir":"file:/mnt/c/Users/adrie/OneDrive/Bureau/IT/projects/spark_challenge/src/spark-warehouse","spark.rdd.scope.noOverride":"true","spark.master":"local[*]","spark.executor.id":"driver","spark.app.name":"appMetrics","spark.submit.deployMode":"client","spark.driver.host":"172.27.136.101","spark.app.id":"local-1747830507045","spark.sql.session.timeZone":"Asia/Hong_Kong","spark.eventLog.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.executor.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.ui.showConsoleProgress":"true","spark.sql.execution.root.id":"4","spark.driver.extraJavaOptions":"-Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false","spark.serializer.objectStreamReset":"100"}}
{"Event":"SparkListenerTaskStart","Stage ID":41,"Stage Attempt ID":0,"Task Info":{"Task ID":118,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830660652,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":41,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":118,"Index":0,"Attempt":0,"Partition ID":0,"Launch Time":1747830660652,"Executor ID":"driver","Host":"172.27.136.101","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1747830660758,"Failed":false,"Killed":false,"Accumulables":[{"ID":2183,"Name":"local blocks read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2186,"Name":"local bytes read","Update":"681","Value":"681","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2187,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2188,"Name":"records read","Update":"9","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2266,"Name":"duration","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2267,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2270,"Name":"time in aggregation build","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2273,"Name":"internal.metrics.executorDeserializeTime","Update":7,"Value":7,"Internal":true,"Count Failed Values":true},{"ID":2274,"Name":"internal.metrics.executorDeserializeCpuTime","Update":7379200,"Value":7379200,"Internal":true,"Count Failed Values":true},{"ID":2275,"Name":"internal.metrics.executorRunTime","Update":81,"Value":81,"Internal":true,"Count Failed Values":true},{"ID":2276,"Name":"internal.metrics.executorCpuTime","Update":78662900,"Value":78662900,"Internal":true,"Count Failed Values":true},{"ID":2277,"Name":"internal.metrics.resultSize","Update":4088,"Value":4088,"Internal":true,"Count Failed Values":true},{"ID":2279,"Name":"internal.metrics.resultSerializationTime","Update":4,"Value":4,"Internal":true,"Count Failed Values":true},{"ID":2284,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2285,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":2286,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2287,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2288,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":681,"Value":681,"Internal":true,"Count Failed Values":true},{"ID":2289,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2290,"Name":"internal.metrics.shuffle.read.recordsRead","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":2291,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2292,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2293,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2294,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2295,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2296,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2297,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2298,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2299,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":2300,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Update":0,"Value":0,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0,"TotalGCTime":0},"Task Metrics":{"Executor Deserialize Time":7,"Executor Deserialize CPU Time":7379200,"Executor Run Time":81,"Executor CPU Time":78662900,"Peak Execution Memory":0,"Result Size":4088,"JVM GC Time":0,"Result Serialization Time":4,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":9,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":681,"Total Records Read":9,"Remote Requests Duration":0,"Push Based Shuffle":{"Corrupt Merged Block Chunks":0,"Merged Fetch Fallback Count":0,"Merged Remote Blocks Fetched":0,"Merged Local Blocks Fetched":0,"Merged Remote Chunks Fetched":0,"Merged Local Chunks Fetched":0,"Merged Remote Bytes Read":0,"Merged Local Bytes Read":0,"Merged Remote Requests Duration":0}},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":41,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":96,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"235\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[95],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":94,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"234\",\"name\":\"Exchange\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[93],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":95,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"230\",\"name\":\"WholeStageCodegen (7)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[94],"Storage Level":{"Use Disk":false,"Use Memory":false,"Use Off Heap":false,"Deserialized":false,"Replication":1},"Barrier":false,"DeterministicLevel":"UNORDERED","Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[40],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:315)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\njava.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\njava.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.base/java.lang.reflect.Method.invoke(Method.java:569)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:840)","Submission Time":1747830660620,"Completion Time":1747830660759,"Accumulables":[{"ID":2183,"Name":"local blocks read","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2186,"Name":"local bytes read","Value":"681","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2187,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2188,"Name":"records read","Value":"9","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2266,"Name":"duration","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2267,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2270,"Name":"time in aggregation build","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":2273,"Name":"internal.metrics.executorDeserializeTime","Value":7,"Internal":true,"Count Failed Values":true},{"ID":2274,"Name":"internal.metrics.executorDeserializeCpuTime","Value":7379200,"Internal":true,"Count Failed Values":true},{"ID":2275,"Name":"internal.metrics.executorRunTime","Value":81,"Internal":true,"Count Failed Values":true},{"ID":2276,"Name":"internal.metrics.executorCpuTime","Value":78662900,"Internal":true,"Count Failed Values":true},{"ID":2277,"Name":"internal.metrics.resultSize","Value":4088,"Internal":true,"Count Failed Values":true},{"ID":2279,"Name":"internal.metrics.resultSerializationTime","Value":4,"Internal":true,"Count Failed Values":true},{"ID":2284,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2285,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":9,"Internal":true,"Count Failed Values":true},{"ID":2286,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2287,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2288,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":681,"Internal":true,"Count Failed Values":true},{"ID":2289,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2290,"Name":"internal.metrics.shuffle.read.recordsRead","Value":9,"Internal":true,"Count Failed Values":true},{"ID":2291,"Name":"internal.metrics.shuffle.push.read.corruptMergedBlockChunks","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2292,"Name":"internal.metrics.shuffle.push.read.mergedFetchFallbackCount","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2293,"Name":"internal.metrics.shuffle.push.read.remoteMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2294,"Name":"internal.metrics.shuffle.push.read.localMergedBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2295,"Name":"internal.metrics.shuffle.push.read.remoteMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2296,"Name":"internal.metrics.shuffle.push.read.localMergedChunksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2297,"Name":"internal.metrics.shuffle.push.read.remoteMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2298,"Name":"internal.metrics.shuffle.push.read.localMergedBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2299,"Name":"internal.metrics.shuffle.read.remoteReqsDuration","Value":0,"Internal":true,"Count Failed Values":true},{"ID":2300,"Name":"internal.metrics.shuffle.push.read.remoteMergedReqsDuration","Value":0,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0,"Shuffle Push Enabled":false,"Shuffle Push Mergers Count":0}}
{"Event":"SparkListenerJobEnd","Job ID":18,"Completion Time":1747830660759,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":4,"time":1747830660779,"errorMessage":""}
{"Event":"SparkListenerApplicationEnd","Timestamp":1747830662730}
